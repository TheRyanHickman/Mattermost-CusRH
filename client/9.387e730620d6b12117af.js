(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1548:function(e,t,n){"use strict";n.d(t,"a",function(){return f});n(88),n(43);var a=n(30),r=n.n(a),o=n(7),i=n.n(o),s=n(56);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,m(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e="fa fa-1x fa-angle-right"+(this.props.additionalClassName?" "+this.props.additionalClassName:"");return i.a.createElement(s.c,{id:"generic_icons.next",defaultMessage:"Next Icon"},function(t){return i.a.createElement("i",{className:e,title:t})})}}])&&l(n.prototype,a),r&&l(n,r),t}();d(f,"propTypes",{additionalClassName:r.a.string}),d(f,"defaultProps",{additionalClassName:null})},1584:function(e,t,n){"use strict";n.d(t,"a",function(){return f});n(88),n(43);var a=n(7),r=n.n(a),o=n(56),i=n(30),s=n.n(i);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,m(t).apply(this,arguments))}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,r.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e="fa fa-1x fa-angle-left"+(this.props.additionalClassName?" "+this.props.additionalClassName:"");return r.a.createElement(o.c,{id:"generic_icons.previous",defaultMessage:"Previous Icon"},function(t){return r.a.createElement("i",{className:e,title:t})})}}])&&l(n.prototype,a),i&&l(n,i),t}();d(f,"propTypes",{additionalClassName:s.a.string}),d(f,"defaultProps",{additionalClassName:null})},1585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIncomingHooks=function(e){return e.entities.integrations.incomingHooks},t.getOutgoingHooks=s,t.getCommands=c,t.getOAuthApps=function(e){return e.entities.integrations.oauthApps},t.getSystemCommands=l,t.getAutocompleteCommandsList=t.getAllCommands=t.getOutgoingHooksInCurrentTeam=void 0,n(21),n(15),n(10),n(11),n(91);var a=n(98),r=n(31);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return e.entities.integrations.outgoingHooks}function c(e){return e.entities.integrations.commands}function l(e){return e.entities.integrations.systemCommands}var u=(0,a.createSelector)(r.getCurrentTeamId,s,function(e,t){return Object.values(t).filter(function(t){return t.teamId===e})});t.getOutgoingHooksInCurrentTeam=u;var m=(0,a.createSelector)(c,l,function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{},t)});t.getAllCommands=m;var p=(0,a.createSelector)(m,r.getCurrentTeamId,function(e,t){return Object.values(e).filter(function(e){return e&&(!e.team_id||e.team_id===t)&&e.auto_complete}).sort(function(e,t){return e.display_name.localeCompare(t.display_name)})});t.getAutocompleteCommandsList=p},1606:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBotAccounts=function(e){return e.entities.bots.accounts}},1650:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createBot=function(e){return(0,o.bindClientFunc)({clientFunc:a.Client4.createBot,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNT,params:[e]})},t.patchBot=function(e,t){return(0,o.bindClientFunc)({clientFunc:a.Client4.patchBot,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNT,params:[e,t]})},t.loadBot=function(e){return(0,o.bindClientFunc)({clientFunc:a.Client4.getBot,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNT,params:[e]})},t.loadBots=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return(0,o.bindClientFunc)({clientFunc:a.Client4.getBotsIncludeDeleted,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNTS,params:[e,t]})},t.disableBot=function(e){return(0,o.bindClientFunc)({clientFunc:a.Client4.disableBot,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNT,params:[e]})},t.enableBot=function(e){return(0,o.bindClientFunc)({clientFunc:a.Client4.enableBot,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNT,params:[e]})},t.assignBot=function(e,t){return(0,o.bindClientFunc)({clientFunc:a.Client4.assignBot,onSuccess:r.BotTypes.RECEIVED_BOT_ACCOUNT,params:[e,t]})};var a=n(36),r=n(6),o=n(122),i=20},1831:function(e,t,n){e.exports=n.p+"files/2e4b89be6e3f829a49fe798824517979.png"},2262:function(e,t,n){e.exports=n.p+"files/fd69f7891f867c2aa14011da92b728ac.jpg"},2263:function(e,t,n){e.exports=n.p+"files/55f1b85ca97f0bb30110d6767de90932.png"},2264:function(e,t,n){e.exports=n.p+"files/2aa264fb1956b8be41f2047d428a1a1e.jpg"},2265:function(e,t,n){e.exports=n.p+"files/d184fcdb23c1e24bfd7132950ceb4f68.jpg"},2355:function(e,t,n){"use strict";n.r(t);n(88),n(43),n(33);var a=n(418),r=n(435),o=n(12),i=n(31),s=n(24),c=n(96),l=n(14),u=(n(34),n(25),n(44),n(247),n(245),n(7)),m=n.n(u),p=n(30),d=n.n(p),f=(n(945),n(20)),h=n(1606),b=n(1650),g=n(40),y=(n(74),n(116),n(118),n(56)),v=n(23),_=(n(304),n(1482)),E=n(1494);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),w(this,j(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){return m.a.createElement(y.c,{id:"generic_icons.search",defaultMessage:"Search Icon"},function(e){return m.a.createElement("i",{className:"fa fa-search",title:e})})}}])&&O(n.prototype,a),r&&O(n,r),t}();function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function M(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=T(t).call(this,e))||"object"!==N(r)&&"function"!=typeof r?R(a):r).updateFilter=n.updateFilter.bind(R(n)),n.state={filter:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,m.a.Component),n=t,(a=[{key:"updateFilter",value:function(e){this.setState({filter:e.target.value})}},{key:"render",value:function(){var e,t=this.state.filter.toLowerCase();if(this.props.loading)e=m.a.createElement(E.a,null);else{var n=!0;if("function"==typeof(e=this.props.children)){var a=P(e(t),2);e=a[0],n=a[1]}0!==(e=m.a.Children.map(e,function(e){return m.a.cloneElement(e,{filter:t})})).length&&n||(t?this.props.emptyTextSearch&&(e=m.a.createElement("span",{className:"backstage-list__item backstage-list__empty",id:"emptySearchResultsMessage"},m.a.cloneElement(this.props.emptyTextSearch,{values:{searchTerm:t}}))):this.props.emptyText&&(e=m.a.createElement("span",{className:"backstage-list__item backstage-list__empty"},this.props.emptyText)))}var r=null;return this.props.addLink&&this.props.addText&&(r=m.a.createElement(_.a,{className:"add-link",to:this.props.addLink},m.a.createElement("button",{type:"button",className:"btn btn-primary",id:this.props.addButtonId},m.a.createElement("span",null,this.props.addText)))),m.a.createElement("div",{className:"backstage-content"},m.a.createElement("div",{className:"backstage-header"},m.a.createElement("h1",null,this.props.header),r),m.a.createElement("div",{className:"backstage-filters"},m.a.createElement("div",{className:"backstage-filter__search"},m.a.createElement(C,null),m.a.createElement("input",{type:"search",className:"form-control",placeholder:this.props.searchPlaceholder,value:this.state.filter,onChange:this.updateFilter,style:q.search,id:"searchInput"}))),m.a.createElement("span",{className:"backstage-list__help"},this.props.helpText),m.a.createElement("div",{className:"backstage-list"},e))}}])&&M(n.prototype,a),r&&M(n,r),t}();x(I,"propTypes",{children:d.a.oneOfType([d.a.node,d.a.func]),header:d.a.node.isRequired,addLink:d.a.string,addText:d.a.node,addButtonId:d.a.string,emptyText:d.a.node,emptyTextSearch:d.a.node,helpText:d.a.node,loading:d.a.bool.isRequired,searchPlaceholder:d.a.string}),x(I,"defaultProps",{searchPlaceholder:v.ab("backstage_list.search","Search")});var q={search:{flexGrow:0,flexShrink:0}},U=n(0),D=n(1491),L=(n(117),n(1498)),H=n(1532),W=n(1521),B=n(1542);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t,n){if(!t)return!0;var a=e.username||"",r=e.description||"",o=e.display_name||"",i="plugin";return n&&n.username&&(i=n.username),!(-1===a.toLowerCase().indexOf(t)&&-1===o.toLowerCase().indexOf(t)&&-1===r.toLowerCase().indexOf(t)&&-1===i.toLowerCase().indexOf(t))}var X=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=z(t).call(this,e),n=!r||"object"!==F(r)&&"function"!=typeof r?K(a):r,Q(K(n),"enableBot",function(){n.props.actions.enableBot(n.props.bot.user_id)}),Q(K(n),"disableBot",function(){n.props.actions.disableBot(n.props.bot.user_id)}),Q(K(n),"enableUserAccessToken",function(e){n.props.actions.enableUserAccessToken(e)}),Q(K(n),"disableUserAccessToken",function(e){n.props.actions.disableUserAccessToken(e)}),Q(K(n),"confirmRevokeToken",function(e){n.setState({confirmingId:e})}),Q(K(n),"revokeTokenConfirmed",function(){n.props.actions.revokeUserAccessToken(n.state.confirmingId),n.closeConfirm()}),Q(K(n),"closeConfirm",function(){n.setState({confirmingId:""})}),Q(K(n),"openCreateToken",function(){n.setState({creatingTokenState:"OPEN",token:{description:""}})}),Q(K(n),"closeCreateToken",function(){n.setState({creatingTokenState:"CLOSED",token:{description:""}})}),Q(K(n),"handleUpdateDescription",function(e){n.setState({token:Object.assign({},n.state.token,{description:e.target.value})})}),Q(K(n),"handleCreateToken",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==n.state.token.description){e.next=4;break}return n.setState({error:m.a.createElement(y.c,{id:"bot.token.error.description",defaultMessage:"Please enter a description."})}),e.abrupt("return");case 4:return e.next=6,n.props.actions.createUserAccessToken(n.props.bot.user_id,n.state.token.description);case 6:a=e.sent,r=a.data,o=a.error,r?n.setState({creatingTokenState:"CREATED",token:r}):o&&n.setState({error:o.message});case 10:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){G(o,a,r,i,s,"next",e)}function s(e){G(o,a,r,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),n.state={confirmingId:"",creatingTokenState:"CLOSED",token:{},error:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e=this,t=this.props.bot.username||"",n=this.props.bot.description||"",a=this.props.bot.display_name||"",r="plugin";this.props.owner&&this.props.owner.username&&(r=this.props.owner.username);var o=this.props.filter?this.props.filter.toLowerCase():"";if(!V(this.props.bot,o,this.props.owner))return null;var i,s=[];Object.values(this.props.accessTokens).forEach(function(t){var n,a,r="";t.is_active?n=m.a.createElement("a",{name:t.id+"_deactivate",href:"#",onClick:function(n){n.preventDefault(),e.disableUserAccessToken(t.id)}},m.a.createElement(y.c,{id:"user.settings.tokens.deactivate",defaultMessage:"Disable"})):(r="light",a=m.a.createElement("span",{className:"margin-right light"},m.a.createElement(y.c,{id:"user.settings.tokens.deactivatedWarning",defaultMessage:"(Disabled)"})),n=m.a.createElement("a",{name:t.id+"_activate",href:"#",onClick:function(n){n.preventDefault(),e.enableUserAccessToken(t.id)}},m.a.createElement(y.c,{id:"user.settings.tokens.activate",defaultMessage:"Enable"}))),s.push(m.a.createElement("div",{key:t.id,className:"bot-list__item"},m.a.createElement("div",{className:"item-details__row d-flex justify-content-between"},m.a.createElement("div",{className:r},m.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},m.a.createElement("b",null,m.a.createElement(y.c,{id:"user.settings.tokens.tokenDesc",defaultMessage:"Token Description: "})),t.description),m.a.createElement("div",{className:"setting-box__token-id whitespace--nowrap overflow--ellipsis"},m.a.createElement("b",null,m.a.createElement(y.c,{id:"user.settings.tokens.tokenId",defaultMessage:"Token ID: "})),t.id)),m.a.createElement("div",null,a,n," - ",m.a.createElement("a",{name:t.id+"_delete",href:"#",onClick:function(n){n.preventDefault(),e.confirmRevokeToken(t.id)}},m.a.createElement(y.c,{id:"user.settings.tokens.delete",defaultMessage:"Delete"}))))))}),"plugin"!==r&&(i=m.a.createElement("div",{className:"item-actions"},m.a.createElement("button",{id:"createToken",className:"style--none color--link",onClick:this.openCreateToken},m.a.createElement(y.c,{id:"bot.manage.create_token",defaultMessage:"Create New Token"}))," - ",m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/bots/edit?id=").concat(this.props.bot.user_id)},m.a.createElement(y.c,{id:"bots.manage.edit",defaultMessage:"Edit"}))," - ",m.a.createElement("button",{className:"style--none color--link",onClick:this.disableBot},m.a.createElement(y.c,{id:"bot.manage.disable",defaultMessage:"Disable"})))),0!==this.props.bot.delete_at&&(i=m.a.createElement("div",{className:"item-actions"},m.a.createElement("button",{className:"style--none color--link",onClick:this.enableBot},m.a.createElement(y.c,{id:"bot.manage.enable",defaultMessage:"Enable"})))),"OPEN"===this.state.creatingTokenState?s.push(m.a.createElement("div",{key:"create",className:"bot-list__item"},m.a.createElement("div",{key:"create"},m.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleCreateToken},m.a.createElement("div",{className:"row"},m.a.createElement("label",{className:"col-sm-auto control-label"},m.a.createElement(y.c,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "})),m.a.createElement("div",{className:"col-sm-4"},m.a.createElement("input",{autoFocus:!0,className:"form-control form-sm",type:"text",maxLength:64,value:this.state.token.description,onChange:this.handleUpdateDescription}))),m.a.createElement("div",null,m.a.createElement("div",{className:"padding-top padding-bottom"},m.a.createElement(y.c,{id:"user.settings.tokens.nameHelp",defaultMessage:"Enter a description for your token to remember what it does."})),m.a.createElement("label",{id:"clientError",className:"has-error is-empty"},this.state.error),m.a.createElement("div",{className:"margin-top"},m.a.createElement(W.a,{btnClass:"btn-sm btn-primary",savingMessage:m.a.createElement(y.c,{id:"user.settings.tokens.save",defaultMessage:"Save"}),saving:!1}),m.a.createElement("button",{className:"btn btn-sm btn-link",onClick:this.closeCreateToken},m.a.createElement(y.c,{id:"user.settings.tokens.cancel",defaultMessage:"Cancel"})))))))):"CREATED"===this.state.creatingTokenState&&s.push(m.a.createElement("div",{key:"created",className:"bot-list__item alert alert-warning"},m.a.createElement("div",{className:"margin-bottom"},m.a.createElement(B.a,{additionalClassName:"margin-right"}),m.a.createElement(y.c,{id:"user.settings.tokens.copy",defaultMessage:"Please copy the access token below. You won't be able to see it again!"})),m.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},m.a.createElement(y.c,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "}),this.state.token.description),m.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},m.a.createElement(y.c,{id:"user.settings.tokens.id",defaultMessage:"Token ID: "}),this.state.token.id),m.a.createElement("strong",{className:"word-break--all"},m.a.createElement(y.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),this.state.token.token),m.a.createElement("div",{className:"margin-top"},m.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.closeCreateToken},m.a.createElement(y.c,{id:"bot.create_token.close",defaultMessage:"Close"})))));var c=v.J(this.props.bot.user_id);return m.a.createElement("div",{className:"backstage-list__item"},m.a.createElement("div",{className:"bot-list-img-container"},m.a.createElement("img",{className:"bot-list-img",alt:"bot image",src:c})),m.a.createElement("div",{className:"item-details"},m.a.createElement("div",{className:"item-details__row d-flex justify-content-between"},m.a.createElement("strong",{className:"item-details__name"},a+" (@"+t+")"),i),m.a.createElement("div",{className:"bot-details__description"},m.a.createElement(H.a,{message:n})),m.a.createElement("div",{className:"light small"},m.a.createElement(y.c,{id:"bots.managed_by",defaultMessage:"Managed by "}),r),m.a.createElement("div",{className:"bot-list is-empty"},s)),m.a.createElement(L.a,{title:m.a.createElement(y.c,{id:"bots.token.delete",defaultMessage:"Delete Token"}),message:m.a.createElement(y.c,{id:"bots.token.confirm_text",defaultMessage:"Are you sure you want to delete the token?"}),confirmButtonText:m.a.createElement(y.c,{id:"bots.token.confirm",defaultMessage:"Delete"}),show:""!==this.state.confirmingId,onConfirm:this.revokeTokenConfirmed,onCancel:this.closeConfirm}))}}])&&Y(n.prototype,a),r&&Y(n,r),t}();function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Q(X,"propTypes",{bot:d.a.object.isRequired,owner:d.a.object,accessTokens:d.a.object.isRequired,filter:d.a.string,actions:d.a.shape({disableBot:d.a.func.isRequired,enableBot:d.a.func.isRequired,createUserAccessToken:d.a.func.isRequired,revokeUserAccessToken:d.a.func.isRequired,enableUserAccessToken:d.a.func.isRequired,disableUserAccessToken:d.a.func.isRequired}),team:d.a.object.isRequired});var re=function(e){function t(e){var n,a,r,o=this;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=ee(t).call(this,e),n=!r||"object"!==Z(r)&&"function"!=typeof r?te(a):r,ae(te(n),"botToJSX",function(e){return m.a.createElement(X,{key:e.user_id,bot:e,owner:n.props.owners[e.user_id],accessTokens:n.props.accessTokens[e.user_id]||{},actions:n.props.actions,team:n.props.team})}),ae(te(n),"bots",function(e){var t=Object.values(n.props.bots).sort(function(e,t){return e.username.localeCompare(t.username)}),a=function(t){return V(t,e,n.props.owners[t.user_id])},r=t.filter(function(e){return 0===e.delete_at}).filter(a).map(n.botToJSX),i=t.filter(function(e){return e.delete_at>0}).filter(a).map(n.botToJSX);return[m.a.createElement("div",{key:"sections"},m.a.createElement(o.EnabledSection,{enabledBots:r}),m.a.createElement(o.DisabledSection,{hasDisabled:i.length>0,disabledBots:i})),r.length>0||i.length>0]}),n.state={loading:!0},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.actions.loadBots(U.Q.Integrations.START_PAGE_NUM,U.Q.Integrations.PAGE_SIZE).then(function(t){if(t.data){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=t.data[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;e.props.actions.getUser(c.owner_id),n.push(e.props.actions.getUser(c.user_id)),n.push(e.props.actions.getUserAccessTokensForUser(c.user_id))}}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}Promise.all(n).then(function(){e.setState({loading:!1})})}})}},{key:"DisabledSection",value:function(e){if(!e.hasDisabled)return null;var t=m.a.Children.map(e.disabledBots,function(t){return m.a.cloneElement(t,{filter:e.filter})});return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"bot-disabled"},m.a.createElement(y.c,{id:"bots.disabled",defaultMessage:"Disabled"})),m.a.createElement("div",{className:"bot-list__disabled"},t))}},{key:"EnabledSection",value:function(e){var t=m.a.Children.map(e.enabledBots,function(t){return m.a.cloneElement(t,{filter:e.filter})});return m.a.createElement("div",null,t)}},{key:"render",value:function(){return m.a.createElement(I,{header:m.a.createElement(y.c,{id:"bots.manage.header",defaultMessage:"Bot Accounts"}),addText:this.props.createBots&&m.a.createElement(y.c,{id:"bots.manage.add",defaultMessage:"Add Bot Account"}),addLink:"/"+this.props.team.name+"/integrations/bots/add",addButtonId:"addBotAccount",emptyText:m.a.createElement(y.c,{id:"bots.manage.empty",defaultMessage:"No bot accounts found"}),emptyTextSearch:m.a.createElement(D.b,{id:"bots.manage.emptySearch",defaultMessage:"No bot accounts match **{searchTerm}**"}),helpText:m.a.createElement(y.c,{id:"bots.manage.help",defaultMessage:"Use {botAccounts} to integrate with Mattermost through plugins or the API. Bot accounts are available to everyone on your server.",values:{botAccounts:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattermost.com/pl/default-bot-accounts"},m.a.createElement(y.c,{id:"bots.manage.bot_accounts",defaultMessage:"Bot Accounts"}))}}),searchPlaceholder:v.ab("bots.manage.search","Search Bot Accounts"),loading:this.state.loading},this.bots)}}])&&$(n.prototype,a),r&&$(n,r),t}();ae(re,"propTypes",{bots:d.a.object.isRequired,accessTokens:d.a.object.isRequired,owners:d.a.object.isRequired,createBots:d.a.bool,actions:d.a.shape({loadBots:d.a.func.isRequired,getUserAccessTokensForUser:d.a.func.isRequired,createUserAccessToken:d.a.func.isRequired,revokeUserAccessToken:d.a.func.isRequired,enableUserAccessToken:d.a.func.isRequired,disableUserAccessToken:d.a.func.isRequired,getUser:d.a.func.isRequired,disableBot:d.a.func.isRequired,enableBot:d.a.func.isRequired}),team:d.a.object.isRequired});var oe=Object(a.connect)(function(e){var t="true"===Object(s.getConfig)(e).EnableBotAccountCreation,n=Object(h.getBotAccounts)(e),a=Object.values(n).reduce(function(t,n){return t[n.user_id]=o.getUser(e,n.owner_id),t},{});return{createBots:t,bots:n,accessTokens:e.entities.admin.userAccessTokensByUser,owners:a}},function(e){return{actions:Object(f.bindActionCreators)({loadBots:b.loadBots,getUserAccessTokensForUser:g.getUserAccessTokensForUser,createUserAccessToken:g.createUserAccessToken,revokeUserAccessToken:g.revokeUserAccessToken,enableUserAccessToken:g.enableUserAccessToken,disableUserAccessToken:g.disableUserAccessToken,getUser:g.getUser,disableBot:b.disableBot,enableBot:b.enableBot},e)}})(re),ie=n(212),se=(n(305),n(306),n(1763)),ce=n(1766),le=n(107),ue=n(1831),me=n.n(ue),pe=n(119);function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function he(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ye,ve,_e,Ee=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),he(this,be(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,m.a.Component),n=t,r=[{key:"propTypes",get:function(){return{children:d.a.node}}}],(a=[{key:"render",value:function(){var e=[],t=this.context.intl.formatMessage;return m.a.Children.forEach(this.props.children,function(n,a){0!==a&&e.push(m.a.createElement("span",{key:"divider"+a,className:"backstage-header__divider"},m.a.createElement("i",{className:"fa fa-angle-right",title:t({id:"generic_icons.breadcrumb",defaultMessage:"Breadcrumb Icon"})}))),e.push(n)}),m.a.createElement("div",{className:"backstage-header"},m.a.createElement("h1",null,e))}}])&&fe(n.prototype,a),r&&fe(n,r),t}();ye=Ee,ve="contextTypes",_e={intl:y.i.isRequired},ve in ye?Object.defineProperty(ye,ve,{value:_e,enumerable:!0,configurable:!0,writable:!0}):ye[ve]=_e;var ke=n(1560),Oe=n(1501),we=n(1541);function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Ce(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Se(o,a,r,i,s,"next",e)}function s(e){Se(o,a,r,i,s,"throw",e)}i(void 0)})}}function Ne(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ae="System Admin",xe="Member",Ie=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Pe(t).call(this,e),n=!r||"object"!==je(r)&&"function"!=typeof r?Me(a):r,Re(Me(n),"updateUsername",function(e){n.setState({username:e.target.value})}),Re(Me(n),"updateDisplayName",function(e){n.setState({displayName:e.target.value})}),Re(Me(n),"updateDescription",function(e){n.setState({description:e.target.value})}),Re(Me(n),"updateRole",function(e){n.setState({role:e.target.value})}),Re(Me(n),"updatePostAll",function(e){n.setState({postAll:e.target.checked})}),Re(Me(n),"updatePostChannels",function(e){n.setState({postChannels:e.target.checked})}),Re(Me(n),"updatePicture",function(e){if(e.target.files&&e.target.files[0]){var t=e.target.files[0];n.previewBlob=URL.createObjectURL(t);var a=new FileReader;a.onload=function(e){var t=we.c(e.target.result),a=we.e(t);n.setState({image:n.previewBlob,orientationStyles:a})},a.readAsArrayBuffer(t),e.target.value=null,n.setState({pictureFile:t})}else n.setState({pictureFile:null,image:null})}),Re(Me(n),"setDefault",function(){n.setState({pictureFile:"default",image:me.a})}),Re(Me(n),"updateRoles",function(){var e=Ce(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.General.SYSTEM_USER_ROLE,n.state.role===Ae?a+=" "+l.General.SYSTEM_ADMIN_ROLE:n.state.postAll?a+=" "+l.General.SYSTEM_POST_ALL_ROLE:n.state.postChannels&&(a+=" "+l.General.SYSTEM_POST_ALL_PUBLIC_ROLE),e.next=4,n.props.actions.updateUserRoles(t.user_id,a);case 4:if(!(r=e.sent)){e.next=7;break}return e.abrupt("return",r.error);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Re(Me(n),"handleSubmit",function(){var e=Ce(regeneratorRuntime.mark(function e(t){var a,r,o,i,s,c,l,u,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!n.state.adding){e.next=3;break}return e.abrupt("return");case 3:if(n.state.username&&!(n.state.username.length<3)){e.next=6;break}return n.setState({error:m.a.createElement(y.c,{id:"bots.manage.add.invalid_username",defaultMessage:"Usernames have to begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores."})}),e.abrupt("return");case 6:if(n.state.pictureFile&&(U.d.includes(n.state.pictureFile.type)?n.state.pictureFile.size>n.props.maxFileSize&&n.setState({error:m.a.createElement(y.c,{id:"user.settings.general.imageTooLarge",defaultMessage:"Unable to upload profile image. File is too large."})}):n.setState({error:m.a.createElement(y.c,{id:"user.settings.general.validImage",defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"})})),n.setState({adding:!0,error:""}),a={username:n.state.username.toLowerCase(),display_name:n.state.displayName,description:n.state.description},!n.props.bot){e.next=31;break}return e.next=12,n.props.actions.patchBot(n.props.bot.user_id,a);case 12:if((i=e.sent)?(r=i.data,o=i.error):o=v.ab("bot.edit_failed","Failed to edit bot"),o){e.next=25;break}if(!n.state.pictureFile||"default"===n.state.pictureFile){e.next=22;break}return e.next=18,n.props.actions.uploadProfileImage(r.user_id,n.state.pictureFile);case 18:s=e.sent,o=s.error,e.next=25;break;case 22:if(!n.state.pictureFile||"default"!==n.state.pictureFile){e.next=25;break}return e.next=25,n.props.actions.setDefaultProfileImage(r.user_id);case 25:if(!o&&r&&(o=n.updateRoles(r)),!r){e.next=29;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/bots")),e.abrupt("return");case 29:e.next=59;break;case 31:if(!(c=v.Y(a.username))){e.next=35;break}return n.setState({adding:!1,error:c}),e.abrupt("return");case 35:return e.next=37,n.props.actions.createBot(a);case 37:if((l=e.sent)?(r=l.data,o=l.error):o=v.ab("bot.create_failed","Failed to create bot"),u="",o){e.next=55;break}if(!n.state.pictureFile||"default"===n.state.pictureFile){e.next=46;break}return e.next=44,n.props.actions.uploadProfileImage(r.user_id,n.state.pictureFile);case 44:e.next=48;break;case 46:return e.next=48,n.props.actions.setDefaultProfileImage(r.user_id);case 48:return e.next=50,n.props.actions.createUserAccessToken(r.user_id,v.ab("bot.token.default.description","Default Token"));case 50:if((p=e.sent)&&!p.error){e.next=54;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/bots")),e.abrupt("return");case 54:u=p.data.token;case 55:if(!o&&r&&(o=n.updateRoles(r)),!r){e.next=59;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/confirm?type=bots&id=").concat(r.user_id,"&token=").concat(u)),e.abrupt("return");case 59:n.setState({adding:!1}),o&&n.setState({error:o.message});case 61:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.state={error:"",username:"",displayName:"",description:"",adding:!1,image:me.a,role:xe,postAll:!1,postChannels:!1},n.props.bot&&(n.state.username=n.props.bot.username,n.state.displayName=n.props.bot.display_name,n.state.description=n.props.bot.description,n.state.role=le.isSystemAdmin(n.props.roles||"")?Ae:xe,n.state.postAll=le.hasPostAllRole(n.props.roles||""),n.state.postChannels=le.hasPostAllPublicRole(n.props.roles||"")),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){var e=m.a.createElement(y.c,{id:"bots.manage.add",defaultMessage:"Add"}),t=m.a.createElement(y.c,{id:"bots.manage.add.create",defaultMessage:"Create Bot Account"}),n=m.a.createElement(y.c,{id:"bots.manage.add.creating",defaultMessage:"Creating..."});this.props.bot&&(e=m.a.createElement(y.c,{id:"bots.manage.edit",defaultMessage:"Edit"}),t=m.a.createElement(y.c,{id:"bots.manage.edit.title",defaultMessage:"Update"}),n=m.a.createElement(y.c,{id:"bots.manage.edit.editing",defaultMessage:"Updating..."}));var a="",r=m.a.createElement(se.a,{delayShow:U.OVERLAY_TIME_DELAY,placement:"right",overlay:m.a.createElement(ce.a,{id:"removeIcon"},m.a.createElement(y.c,{id:"bot.remove_profile_picture",defaultMessage:"Remove Bot Icon"}))},m.a.createElement("a",{className:"bot-profile__remove",onClick:this.setDefault},m.a.createElement("span",null,"×"))),o=null;return this.props.bot&&!this.state.pictureFile?a=v.J(this.props.bot.user_id):(a=this.state.image,o=this.state.orientationStyles,this.state.image===me.a&&(r=null)),m.a.createElement("div",{className:"backstage-content"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/bots")},m.a.createElement(y.c,{id:"bots.manage.header",defaultMessage:"Bot Accounts"})),e),m.a.createElement("div",{className:"backstage-form"},m.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.a.createElement(y.c,{id:"bots.add.username",defaultMessage:"Username"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"username",type:"text",maxLength:"22",className:"form-control",value:this.state.username,onChange:this.updateUsername}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"bot.add.username.help",defaultMessage:"You can use lowercase letters, numbers, periods, dashes, and underscores."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"boticon"},m.a.createElement(y.c,{id:"bots.add.icon",defaultMessage:"Bot Icon"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("div",{className:"bot-img-container"},m.a.createElement("img",{className:"bot-img",alt:"bot image",src:a,style:o}),r),m.a.createElement("div",{className:"btn btn-sm btn-primary btn-file sel-btn"},m.a.createElement(y.c,{id:"bots.image.upload",defaultMessage:"Upload an image"}),m.a.createElement("input",{accept:".jpg,.png,.bmp",type:"file",onChange:this.updatePicture})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.a.createElement(y.c,{id:"bots.add.displayName",defaultMessage:"Display Name"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"bot.add.display_name.help",defaultMessage:"(Optional) You can choose to display your bot's full name rather than its username."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.a.createElement(y.c,{id:"bot.add.description",defaultMessage:"Description"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"description",type:"text",maxLength:"1024",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"bot.add.description.help",defaultMessage:"(Optional) Let others know what this bot does."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"role"},m.a.createElement(y.c,{id:"bot.add.role",defaultMessage:"Role"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("select",{className:"form-control",value:this.state.role,disabled:!this.props.editingUserHasManageSystem,onChange:this.updateRole},m.a.createElement("option",{value:xe},xe),m.a.createElement("option",{value:Ae},Ae)),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"bot.add.role.help",defaultMessage:"Choose what role the bot should have."})))),m.a.createElement("div",{className:"row bot-profile__section"},m.a.createElement("div",{className:"col-md-5 col-sm-8 col-sm-offset-4"},m.a.createElement(D.b,{id:"admin.manage_roles.additionalRoles",defaultMessage:"Select additional permissions for the account. [Read more about roles and permissions](!https://about.mattermost.com/default-permissions)."}))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"postAll"},m.a.createElement(y.c,{id:"bot.add.post_all",defaultMessage:"post:all"})),m.a.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.a.createElement("div",{className:"checkbox no-padding"},m.a.createElement("label",{htmlFor:"postAll"},m.a.createElement("input",{id:"postAll",type:"checkbox",checked:this.state.postAll||this.state.role===Ae,onChange:this.updatePostAll,disabled:!this.props.editingUserHasManageSystem||this.state.role===Ae}),m.a.createElement(y.c,{id:"bot.add.post_all.enabled",defaultMessage:"Enabled"}))),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"bot.add.post_all.help",defaultMessage:"Bot will have access to post to all Mattermost channels including direct messages."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"postChannels"},m.a.createElement(y.c,{id:"bot.add.post_channels",defaultMessage:"post:channels"})),m.a.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.a.createElement("div",{className:"checkbox no-padding"},m.a.createElement("label",{htmlFor:"postChannels"},m.a.createElement("input",{id:"postChannels",type:"checkbox",checked:this.state.postChannels||this.state.role===Ae||this.state.postAll,onChange:this.updatePostChannels,disabled:!this.props.editingUserHasManageSystem||this.state.role===Ae||this.state.postAll}),m.a.createElement(y.c,{id:"bot.add.post_channels.enabled",defaultMessage:"Enabled"}))),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"bot.add.post_channels.help",defaultMessage:"Bot will have access to post to all Mattermost public channels."})))),m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(Oe.a,{type:"backstage",errors:[this.state.error]}),m.a.createElement(_.a,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/bots")},m.a.createElement(y.c,{id:"bots.manage.add.cancel",defaultMessage:"Cancel"})),m.a.createElement(ke.a,{className:"btn btn-primary",type:"submit",spinning:this.state.adding,spinningText:n,onClick:this.handleSubmit,id:"saveBot"},t)))))}}])&&Ne(n.prototype,a),r&&Ne(n,r),t}();Re(Ie,"propTypes",{team:d.a.object.isRequired,bot:d.a.object,roles:d.a.string,maxFileSize:d.a.number.isRequired,editingUserHasManageSystem:d.a.bool.isRequired,actions:d.a.shape({createBot:d.a.func.isRequired,patchBot:d.a.func.isRequired,uploadProfileImage:d.a.func.isRequired,setDefaultProfileImage:d.a.func.isRequired,createUserAccessToken:d.a.func.isRequired,updateUserRoles:d.a.func.isRequired})});var qe=Object(a.connect)(function(e,t){var n=Object(s.getConfig)(e),a=new URLSearchParams(t.location.search).get("id"),r=Object(h.getBotAccounts)(e),o=r?r[a]:null,i=o?Object(ie.getUsers)(e)[o.user_id]:null,u=i?i.roles:null;return{maxFileSize:parseInt(n.MaxFileSize,10),bot:o,roles:u,editingUserHasManageSystem:Object(c.haveISystemPermission)(e,{permission:l.Permissions.MANAGE_SYSTEM})}},function(e){return{actions:Object(f.bindActionCreators)({createBot:b.createBot,patchBot:b.patchBot,uploadProfileImage:g.uploadProfileImage,setDefaultProfileImage:g.setDefaultProfileImage,createUserAccessToken:g.createUserAccessToken,updateUserRoles:g.updateUserRoles},e)}})(Ie),Ue=n(1549),De=n(1558),Le=n(1733),He=n(2262),We=n.n(He),Be=n(2263),Fe=n.n(Be),Ge=n(2264),Ye=n.n(Ge),ze=n(2265),Ke=n.n(ze),Je=n(1571),Qe=n(1589);n(1507);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ze(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ze(this,$e(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,m.a.Component),n=t,r=[{key:"propTypes",get:function(){return{image:d.a.string.isRequired,title:d.a.node.isRequired,description:d.a.node.isRequired,link:d.a.string.isRequired}}}],(a=[{key:"render",value:function(){var e=this.props,t=e.image,n=e.title,a=e.description,r=e.link;return m.a.createElement(_.a,{to:r,className:"integration-option"},m.a.createElement("img",{alt:"integration image",className:"integration-option__image",src:t}),m.a.createElement("div",{className:"integration-option__title"},n),m.a.createElement("div",{className:"integration-option__description"},a))}}])&&Xe(n.prototype,a),r&&Xe(n,r),t}();function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var st=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=rt(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==nt(r)&&"function"!=typeof r?ot(a):r,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ot(n),"updateTitle",function(){var e=n.props.siteName||"";document.title=v.ab("admin.sidebar.integrations","Integrations")+" - "+n.props.team.display_name+" "+e}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}(t,m.a.Component),n=t,r=[{key:"propTypes",get:function(){return{team:d.a.object,user:d.a.object,siteName:d.a.string,enableIncomingWebhooks:d.a.bool,enableOutgoingWebhooks:d.a.bool,enableCommands:d.a.bool,enableOAuthServiceProvider:d.a.bool}}}],(a=[{key:"componentDidMount",value:function(){this.updateTitle()}},{key:"render",value:function(){var e=[];return this.props.enableIncomingWebhooks&&e.push(m.a.createElement(Qe.a,{teamId:this.props.team.id,permissions:[l.Permissions.MANAGE_INCOMING_WEBHOOKS],key:"incomingWebhookPermission"},m.a.createElement(tt,{key:"incomingWebhook",image:We.a,title:m.a.createElement(y.c,{id:"integrations.incomingWebhook.title",defaultMessage:"Incoming Webhook"}),description:m.a.createElement(y.c,{id:"integrations.incomingWebhook.description",defaultMessage:"Incoming webhooks allow external integrations to send messages"}),link:"/"+this.props.team.name+"/integrations/incoming_webhooks"}))),this.props.enableOutgoingWebhooks&&e.push(m.a.createElement(Qe.a,{teamId:this.props.team.id,permissions:[l.Permissions.MANAGE_OUTGOING_WEBHOOKS],key:"outgoingWebhookPermission"},m.a.createElement(tt,{key:"outgoingWebhook",image:Ye.a,title:m.a.createElement(y.c,{id:"integrations.outgoingWebhook.title",defaultMessage:"Outgoing Webhook"}),description:m.a.createElement(y.c,{id:"integrations.outgoingWebhook.description",defaultMessage:"Outgoing webhooks allow external integrations to receive and respond to messages"}),link:"/"+this.props.team.name+"/integrations/outgoing_webhooks"}))),this.props.enableCommands&&e.push(m.a.createElement(Qe.a,{teamId:this.props.team.id,permissions:[l.Permissions.MANAGE_SLASH_COMMANDS],key:"commandPermission"},m.a.createElement(tt,{key:"command",image:Ke.a,title:m.a.createElement(y.c,{id:"integrations.command.title",defaultMessage:"Slash Command"}),description:m.a.createElement(y.c,{id:"integrations.command.description",defaultMessage:"Slash commands send events to an external integration"}),link:"/"+this.props.team.name+"/integrations/commands"}))),this.props.enableOAuthServiceProvider&&e.push(m.a.createElement(Je.a,{permissions:[l.Permissions.MANAGE_OAUTH],key:"oauth2AppsPermission"},m.a.createElement(tt,{key:"oauth2Apps",image:Fe.a,title:m.a.createElement(y.c,{id:"integrations.oauthApps.title",defaultMessage:"OAuth 2.0 Applications"}),description:m.a.createElement(y.c,{id:"integrations.oauthApps.description",defaultMessage:"Auth 2.0 allows external applications to make authorized requests to the Mattermost API"}),link:"/"+this.props.team.name+"/integrations/oauth2-apps"}))),e.push(m.a.createElement(Je.a,{permissions:["manage_bots"],key:"botsPermissions"},m.a.createElement(tt,{image:me.a,title:m.a.createElement(y.c,{id:"bots.manage.header",defaultMessage:"Bot Accounts"}),description:m.a.createElement(y.c,{id:"bots.manage.description",defaultMessage:"Use bot accounts to integrate with Mattermost through plugins or the API"}),link:"/"+this.props.team.name+"/integrations/bots"}))),m.a.createElement("div",{className:"backstage-content row"},m.a.createElement("div",{className:"backstage-header"},m.a.createElement("h1",null,m.a.createElement(y.c,{id:"integrations.header",defaultMessage:"Integrations"}))),m.a.createElement("div",{className:"backstage-list__help"},m.a.createElement(y.c,{id:"integrations.help",defaultMessage:"Visit the {appDirectory} to find self-hosted, third-party apps and integrations for Mattermost.",values:{appDirectory:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://about.mattermost.com/default-app-directory/"},m.a.createElement(y.c,{id:"integrations.help.appDirectory",defaultMessage:"App Directory"}))}})),m.a.createElement("div",{className:"integrations-list d-flex flex-wrap"},e))}}])&&at(n.prototype,a),r&&at(n,r),t}();var ct=Object(a.connect)(function(e){var t=Object(s.getConfig)(e);return{siteName:t.SiteName,enableIncomingWebhooks:"true"===t.EnableIncomingWebhooks,enableOutgoingWebhooks:"true"===t.EnableOutgoingWebhooks,enableCommands:"true"===t.EnableCommands,enableOAuthServiceProvider:"true"===t.EnableOAuthServiceProvider}})(st),lt=n(248),ut=n(4),mt=n.n(ut);function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ft(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ft(this,ht(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){return this.props.hasPermission&&!this.props.invert?this.props.children:!this.props.hasPermission&&this.props.invert?this.props.children:null}}])&&dt(n.prototype,a),r&&dt(n,r),t}();gt(yt,"defaultProps",{invert:!1}),gt(yt,"propTypes",{permissions:d.a.arrayOf(d.a.string).isRequired,hasPermission:d.a.bool.isRequired,invert:d.a.bool.isRequired,children:d.a.node.isRequired});var vt=Object(a.connect)(function(e,t){var n=Object(i.getMyTeams)(e),a=!0,r=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var u=s.value,m=!0,p=!1,d=void 0;try{for(var f,h=t.permissions[Symbol.iterator]();!(m=(f=h.next()).done);m=!0){var b=f.value;if(Object(c.haveITeamPermission)(e,{team:u.id,permission:b}))return{hasPermission:!0}}}catch(e){p=!0,d=e}finally{try{m||null==h.return||h.return()}finally{if(p)throw d}}}}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return{hasPermission:!1}})(yt),_t=n(251),Et=n(213),kt=(n(210),n(156),n(36));function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pt=function(e){function t(e){var n,a,r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=jt(t).call(this,e),n=!r||"object"!==Ot(r)&&"function"!=typeof r?St(a):r,Nt(St(n),"handleOpenModal",function(e){e.preventDefault(),n.setState({showDeleteModal:!0})}),Nt(St(n),"handleConfirm",function(){n.props.onDelete()}),Nt(St(n),"handleCancel",function(){n.setState({showDeleteModal:!1})}),Nt(St(n),"handleKeyDown",function(e){v.S(e,U.Q.KeyCodes.ENTER)&&n.handleConfirm(e)}),n.constructor===t)throw new TypeError("Can not construct abstract class.");return n.state={showDeleteModal:!1},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){return m.a.createElement("span",null,m.a.createElement("button",{className:"color--link style--none",onClick:this.handleOpenModal},this.triggerTitle),m.a.createElement(L.a,{show:this.state.showDeleteModal,title:this.modalTitle,message:this.modalMessage,confirmButtonText:this.modalConfirmButton,onConfirm:this.handleConfirm,onCancel:this.handleCancel,onKeyDown:this.handleKeyDown}))}}])&&wt(n.prototype,a),r&&wt(n,r),t}();function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Rt(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xt(e,t){return(xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Nt(Pt,"propTypes",{onDelete:d.a.func.isRequired});var It=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rt(this,At(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xt(e,t)}(t,Pt),n=t,(a=[{key:"triggerTitle",get:function(){return m.a.createElement(y.c,{id:"emoji_list.delete",defaultMessage:"Delete"})}},{key:"modalTitle",get:function(){return m.a.createElement(y.c,{id:"emoji_list.delete.confirm.title",defaultMessage:"Delete Custom Emoji"})}},{key:"modalMessage",get:function(){return m.a.createElement("div",{className:"alert alert-warning"},m.a.createElement(B.a,{additionalClassName:"fa-margin--right"}),m.a.createElement(y.c,{id:"emoji_list.delete.confirm.msg",defaultMessage:"This action permanently deletes the custom emoji. Are you sure you want to delete it?"}))}},{key:"modalConfirmButton",get:function(){return m.a.createElement(y.c,{id:"emoji_list.delete.confirm.button",defaultMessage:"Delete"})}}])&&Tt(n.prototype,a),r&&Tt(n,r),t}();function qt(e){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dt(e){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(It,"propTypes",{onDelete:d.a.func.isRequired});var Bt=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Dt(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==qt(r)&&"function"!=typeof r?Lt(a):r,Wt(Lt(n),"handleDelete",function(){n.props.onDelete&&n.props.onDelete(n.props.emoji.id),n.props.actions.deleteCustomEmoji(n.props.emoji.id)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.emoji,t=this.props.creatorUsername,n=this.props.creatorDisplayName;t&&t!==n&&(n+=" (@"+t+")");var a=null;return a=e.creator_id===this.props.currentUserId?m.a.createElement(vt,{permissions:[mt.a.DELETE_EMOJIS]},m.a.createElement(It,{onDelete:this.handleDelete})):m.a.createElement(vt,{permissions:[mt.a.DELETE_EMOJIS]},m.a.createElement(vt,{permissions:[mt.a.DELETE_OTHERS_EMOJIS]},m.a.createElement(It,{onDelete:this.handleDelete}))),m.a.createElement("tr",{className:"backstage-list__item"},m.a.createElement("td",{className:"emoji-list__name"},":"+e.name+":"),m.a.createElement("td",{className:"emoji-list__image"},m.a.createElement("span",{className:"emoticon",style:{backgroundImage:"url("+kt.Client4.getCustomEmojiImageUrl(e.id)+")"}})),m.a.createElement("td",{className:"emoji-list__creator"},n),m.a.createElement("td",{className:"emoji-list-item_actions"},a))}}])&&Ut(n.prototype,a),r&&Ut(n,r),t}();Wt(Bt,"propTypes",{emoji:d.a.object.isRequired,currentUserId:d.a.string.isRequired,creatorDisplayName:d.a.string.isRequired,creatorUsername:d.a.string,currentTeam:d.a.object,onDelete:d.a.func,actions:d.a.shape({deleteCustomEmoji:d.a.func.isRequired}).isRequired}),Wt(Bt,"defaultProps",{emoji:{},currentUserId:"",currentTeam:{},creatorDisplayName:""});var Ft=Object(a.connect)(function(e,t){var n=e.entities.emojis.customEmoji[t.emojiId],a=Object(o.getUser)(e,n.creator_id);return{emoji:n,creatorDisplayName:Object(v.v)(a),creatorUsername:a?a.username:"",currentUserId:Object(o.getCurrentUserId)(e),currentTeam:Object(i.getCurrentTeam)(e)}},function(e){return{actions:Object(f.bindActionCreators)({deleteCustomEmoji:Et.deleteCustomEmoji},e)}})(Bt),Gt=n(1548),Yt=n(1584),zt=n(1499),Kt=n(57);function Jt(e){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Vt(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Xt(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Vt(o,a,r,i,s,"next",e)}function s(e){Vt(o,a,r,i,s,"throw",e)}i(void 0)})}}function Zt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $t(e){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function en(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tn(e,t){return(tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var an=50,rn=200,on=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=$t(t).call(this,e),n=!r||"object"!==Jt(r)&&"function"!=typeof r?en(a):r,nn(en(n),"nextPage",function(e){e&&e.preventDefault();var t=n.state.page+1;n.setState({nextLoading:!0}),n.props.actions.getCustomEmojis(t,an,l.Emoji.SORT_BY_NAME,!0).then(function(e){var a=e.data;n.setState({page:t,nextLoading:!1}),a&&a.length<an&&n.setState({missingPages:!1}),n.props.scrollToTop()})}),nn(en(n),"previousPage",function(e){e&&e.preventDefault(),n.setState({page:n.state.page-1,nextLoading:!1}),n.props.scrollToTop()}),nn(en(n),"onSearchChange",function(e){if(e&&e.target){var t=e.target.value||"";clearTimeout(n.searchTimeout),n.searchTimeout=setTimeout(Xt(regeneratorRuntime.mark(function e(){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.trim()){e.next=3;break}return n.setState({searchEmojis:null,page:0}),e.abrupt("return");case 3:return n.setState({loading:!0}),e.next=6,n.props.actions.searchCustomEmojis(t,{},!0);case 6:a=e.sent,(r=a.data)?n.setState({searchEmojis:r.map(function(e){return e.id}),loading:!1}):n.setState({searchEmojis:[],loading:!1});case 9:case"end":return e.stop()}},e)})),rn)}}),nn(en(n),"deleteFromSearch",function(e){if(n.state.searchEmojis){var t=n.state.searchEmojis.indexOf(e);if(!(t<0)){var a=Qt(n.state.searchEmojis);a.splice(t,1),n.setState({searchEmojis:a})}}}),n.searchTimeout=null,n.state={loading:!0,page:0,nextLoading:!1,searchEmojis:null,missingPages:!0},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tn(e,t)}(t,m.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.actions.getCustomEmojis(0,an+1,l.Emoji.SORT_BY_NAME,!0).then(function(t){var n=t.data;e.setState({loading:!1}),n&&n.length<an&&e.setState({missingPages:!1})})}},{key:"render",value:function(){var e,t,n=this,a=this.state.searchEmojis,r=[];if(this.state.loading)r.push(m.a.createElement("tr",{key:"loading",className:"backstage-list__item backstage-list__empty"},m.a.createElement("td",{colSpan:"4"},m.a.createElement(E.a,{key:"loading"}))));else if(0===this.props.emojiIds.length||a&&0===a.length)r.push(m.a.createElement("tr",{key:"empty",className:"backstage-list__item backstage-list__empty"},m.a.createElement("td",{colSpan:"4"},m.a.createElement(y.c,{id:"emoji_list.empty",defaultMessage:"No custom emoji found"}))));else if(a)a.forEach(function(e){r.push(m.a.createElement(Ft,{key:"emoji_search_item"+e,emojiId:e,onDelete:n.deleteFromSearch}))});else{var o=this.state.page*an,i=o+an;if(this.props.emojiIds.slice(o,i).forEach(function(e){r.push(m.a.createElement(Ft,{key:"emoji_list_item"+e,emojiId:e}))}),this.state.missingPages){var s=m.a.createElement("span",null,m.a.createElement(y.c,{id:"filtered_user_list.next",defaultMessage:"Next"}),m.a.createElement(Gt.a,{additionalClassName:"margin-left"}));e=m.a.createElement(W.a,{btnClass:"btn-link",extraClasses:"pull-right",onClick:this.nextPage,saving:this.state.nextLoading,disabled:this.state.nextLoading,defaultMessage:s,savingMessage:s})}this.state.page>0&&(t=m.a.createElement("button",{className:"btn btn-link",onClick:this.previousPage},m.a.createElement(Yt.a,{additionalClassName:"margin-right"}),m.a.createElement(y.c,{id:"filtered_user_list.prev",defaultMessage:"Previous"})))}return m.a.createElement("div",null,m.a.createElement("div",{className:"backstage-filters"},m.a.createElement("div",{className:"backstage-filter__search"},m.a.createElement(C,null),m.a.createElement(zt.a,{type:"search",className:"form-control",placeholder:{id:Object(Kt.b)("emoji_list.search"),defaultMessage:"Search Custom Emoji"},onChange:this.onSearchChange,style:sn.search}))),m.a.createElement("span",{className:"backstage-list__help"},m.a.createElement("p",null,m.a.createElement(y.c,{id:"emoji_list.help",defaultMessage:"Custom emoji are available to everyone on your server. Type ':' followed by two characters in a message box to bring up the emoji selection menu."})),m.a.createElement("p",null,m.a.createElement(y.c,{id:"emoji_list.help2",defaultMessage:"Tip: If you add #, ##, or ### as the first character on a new line containing emoji, you can use larger sized emoji. To try it out, send a message such as: '# :smile:'."}))),m.a.createElement("div",{className:"backstage-list"},m.a.createElement("table",{className:"emoji-list__table"},m.a.createElement("thead",null,m.a.createElement("tr",{className:"backstage-list__item emoji-list__table-header"},m.a.createElement("th",{className:"emoji-list__name"},m.a.createElement(y.c,{id:"emoji_list.name",defaultMessage:"Name"})),m.a.createElement("th",{className:"emoji-list__image"},m.a.createElement(y.c,{id:"emoji_list.image",defaultMessage:"Image"})),m.a.createElement("th",{className:"emoji-list__creator"},m.a.createElement(y.c,{id:"emoji_list.creator",defaultMessage:"Creator"})),m.a.createElement("th",{className:"emoji-list_actions"},m.a.createElement(y.c,{id:"emoji_list.actions",defaultMessage:"Actions"})))),m.a.createElement("tbody",null,r))),m.a.createElement("div",{className:"filter-controls padding-top x2"},t,e))}}])&&Zt(n.prototype,a),r&&Zt(n,r),t}();nn(on,"propTypes",{emojiIds:d.a.arrayOf(d.a.string).isRequired,scrollToTop:d.a.func.isRequired,actions:d.a.shape({getCustomEmojis:d.a.func.isRequired,searchCustomEmojis:d.a.func.isRequired}).isRequired});var sn={search:{flexGrow:0,flexShrink:0}};var cn=Object(a.connect)(function(e){return{emojiIds:Object(_t.getCustomEmojiIdsSortedByName)(e)||[]}},function(e){return{actions:Object(f.bindActionCreators)({getCustomEmojis:Et.getCustomEmojis,searchCustomEmojis:Et.searchCustomEmojis},e)}})(on);function ln(e){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function un(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mn(e){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(e,t){return(dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=mn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ln(r)&&"function"!=typeof r?pn(a):r,fn(pn(n),"updateTitle",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.props;document.title=v.ab("custom_emoji.header","Custom Emoji")+" - "+e.teamDisplayName+" "+e.siteName}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(t,m.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){this.updateTitle(),this.props.actions.loadRolesIfNeeded(["system_admin","team_admin","system_user","team_user"])}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.siteName!==e.siteName&&this.updateTitle(e)}},{key:"render",value:function(){return m.a.createElement("div",{className:"backstage-content emoji-list"},m.a.createElement("div",{className:"backstage-header"},m.a.createElement("h1",null,m.a.createElement(y.c,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),m.a.createElement(vt,{permissions:[mt.a.CREATE_EMOJIS]},m.a.createElement(_.a,{className:"add-link",to:"/"+this.props.teamName+"/emoji/add"},m.a.createElement("button",{type:"button",className:"btn btn-primary"},m.a.createElement(y.c,{id:"emoji_list.add",defaultMessage:"Add Custom Emoji"}))))),m.a.createElement(cn,{scrollToTop:this.props.scrollToTop}))}}])&&un(n.prototype,a),r&&un(n,r),t}();fn(hn,"propTypes",{teamId:d.a.string.isRequired,teamName:d.a.string.isRequired,teamDisplayName:d.a.string.isRequired,siteName:d.a.string,scrollToTop:d.a.func.isRequired,actions:d.a.shape({loadRolesIfNeeded:d.a.func.isRequired}).isRequired}),fn(hn,"defaultProps",{teamName:"",teamDisplayName:"",siteName:""});var bn=Object(a.connect)(function(e){var t=Object(i.getCurrentTeam)(e)||{};return{teamId:t.id,teamName:t.name,teamDisplayName:t.display_name,siteName:e.entities.general.config.SiteName}},function(e){return{actions:Object(f.bindActionCreators)({loadRolesIfNeeded:lt.loadRolesIfNeeded},e)}})(hn),gn=n(129);n(430),n(185);function yn(e){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function _n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function En(e){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function On(e,t){return(On=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jn=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=En(t).call(this,e),n=!r||"object"!==yn(r)&&"function"!=typeof r?kn(a):r,wn(kn(n),"handleSubmit",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,r,o,i,s,c,l,u,p,d,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props,r=a.actions,o=a.emojiMap,i=a.user,s=a.team,c=n.state,l=c.image,u=c.name,p=c.saving,t.preventDefault(),!p){e.next=5;break}return e.abrupt("return");case 5:if(n.setState({saving:!0,error:null}),(d={creator_id:i.id,name:u.trim().toLowerCase()}).name.startsWith(":")&&d.name.endsWith(":")&&(d.name=d.name.substring(1,d.name.length-1)),d.name){e.next=13;break}return n.setState({saving:!1,error:m.a.createElement(y.c,{id:"add_emoji.nameRequired",defaultMessage:"A name is required for the emoji"})}),e.abrupt("return");case 13:if(!/[^a-z0-9_-]/.test(d.name)){e.next=18;break}return n.setState({saving:!1,error:m.a.createElement(y.c,{id:"add_emoji.nameInvalid",defaultMessage:"An emoji's name can only contain lowercase letters, numbers, and the symbols '-' and '_'."})}),e.abrupt("return");case 18:if(!o.hasSystemEmoji(d.name)){e.next=21;break}return n.setState({saving:!1,error:m.a.createElement(y.c,{id:"add_emoji.nameTaken",defaultMessage:"This name is already in use by a system emoji. Please choose another name."})}),e.abrupt("return");case 21:if(l){e.next=24;break}return n.setState({saving:!1,error:m.a.createElement(y.c,{id:"add_emoji.imageRequired",defaultMessage:"An image is required for the emoji"})}),e.abrupt("return");case 24:return e.next=26,r.createCustomEmoji(d,l);case 26:if(f=e.sent,!(h=f.error)){e.next=31;break}return n.setState({saving:!1,error:h.message}),e.abrupt("return");case 31:pe.a.push("/"+s.name+"/emoji");case 32:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){vn(o,a,r,i,s,"next",e)}function s(e){vn(o,a,r,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),wn(kn(n),"updateName",function(e){n.setState({name:e.target.value})}),wn(kn(n),"updateImage",function(e){if(0!==e.target.files.length){var t=e.target.files[0],a=new FileReader;a.onload=function(){n.setState({image:t,imageUrl:a.result})},a.readAsDataURL(t)}else n.setState({image:null,imageUrl:""})}),n.state={name:"",image:null,imageUrl:"",saving:!1,error:null},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&On(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){var e=null;this.state.image&&(e=m.a.createElement("span",{className:"add-emoji__filename"},this.state.image.name));var t=null;return this.state.imageUrl&&(t=m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"preview"},m.a.createElement(y.c,{id:"add_emoji.preview",defaultMessage:"Preview"})),m.a.createElement("div",{className:"col-md-5 col-sm-8 add-emoji__preview"},m.a.createElement(y.c,{id:"add_emoji.preview.sentence",defaultMessage:"This is a sentence with {image} in it.",values:{image:m.a.createElement("span",{className:"emoticon",style:{backgroundImage:"url("+this.state.imageUrl+")"}})}})))),m.a.createElement("div",{className:"backstage-content row"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/"+this.props.team.name+"/emoji"},m.a.createElement(y.c,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),m.a.createElement(y.c,{id:"add_emoji.header",defaultMessage:"Add"})),m.a.createElement("div",{className:"backstage-form"},m.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},m.a.createElement(y.c,{id:"add_emoji.name",defaultMessage:"Name"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_emoji.name.help",defaultMessage:"Choose a name for your emoji made of up to 64 characters consisting of lowercase letters, numbers, and the symbols '-' and '_'."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"image"},m.a.createElement(y.c,{id:"add_emoji.image",defaultMessage:"Image"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("div",null,m.a.createElement("div",{className:"add-emoji__upload"},m.a.createElement("button",{className:"btn btn-primary"},m.a.createElement(y.c,{id:"add_emoji.image.button",defaultMessage:"Select"})),m.a.createElement("input",{id:"select-emoji",type:"file",accept:".jpg,.png,.gif",multiple:!1,onChange:this.updateImage})),e,m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_emoji.image.help",defaultMessage:"Choose the image for your emoji. The image can be a gif, png, or jpeg file with a max size of 64 KB and dimensions up to 128 by 128 pixels."}))))),t,m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(Oe.a,{type:"backstage",error:this.state.error}),m.a.createElement(_.a,{className:"btn btn-link btn-sm",to:"/"+this.props.team.name+"/emoji"},m.a.createElement(y.c,{id:"add_emoji.cancel",defaultMessage:"Cancel"})),m.a.createElement(ke.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:Object(v.ab)("add_emoji.saving","Saving..."),onClick:this.handleSubmit},m.a.createElement(y.c,{id:"add_emoji.save",defaultMessage:"Save"}))))))}}])&&_n(n.prototype,a),r&&_n(n,r),t}();wn(jn,"propTypes",{actions:d.a.shape({createCustomEmoji:d.a.func.isRequired}).isRequired,emojiMap:d.a.object.isRequired,team:d.a.object,user:d.a.object}),wn(jn,"contextTypes",{router:d.a.object.isRequired});var Sn=Object(a.connect)(function(e){return{emojiMap:Object(gn.a)(e)}},function(e){return{actions:Object(f.bindActionCreators)({createCustomEmoji:Et.createCustomEmoji},e)}})(jn),Cn=n(1512),Nn=n(16),Pn=n(1585);n(1785);function Mn(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Tn(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Mn(o,a,r,i,s,"next",e)}function s(e){Mn(o,a,r,i,s,"throw",e)}i(void 0)})}}var Rn=100;function An(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rn;return function(){var a=Tn(regeneratorRuntime.mark(function a(r){var o,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r(Cn.getIncomingHooks(e,t,n));case 2:o=a.sent,(i=o.data)&&r(xn(i));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}function xn(e){return function(){var t=Tn(regeneratorRuntime.mark(function t(n,a){var r,i,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r=a(),i={},s=0;s<e.length;s++)c=e[s],Object(o.getUser)(r,c.user_id)||(i[c.user_id]=!0);if(0!==(l=Object.keys(i)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(g.getProfilesByIds)(l));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function In(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rn;return function(){var a=Tn(regeneratorRuntime.mark(function a(r){var o,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r(Cn.getOutgoingHooks("",e,t,n));case 2:o=a.sent,(i=o.data)&&r(qn(i));case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}function qn(e){return function(){var t=Tn(regeneratorRuntime.mark(function t(n,a){var r,i,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r=a(),i={},s=0;s<e.length;s++)c=e[s],Object(o.getUser)(r,c.creator_id)||(i[c.creator_id]=!0);if(0!==(l=Object.keys(i)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(g.getProfilesByIds)(l));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function Un(e){return function(){var t=Tn(regeneratorRuntime.mark(function t(n){var a,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(Cn.getCustomTeamCommands(e));case 2:a=t.sent,(r=a.data)&&n(Dn(r));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}function Dn(e){return function(){var t=Tn(regeneratorRuntime.mark(function t(n,a){var r,i,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r=a(),i={},s=0;s<e.length;s++)c=e[s],Object(o.getUser)(r,c.creator_id)||(i[c.creator_id]=!0);if(0!==(l=Object.keys(i)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(g.getProfilesByIds)(l));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function Ln(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rn;return function(){var n=Tn(regeneratorRuntime.mark(function n(a){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a(Cn.getOAuthApps(e,t));case 2:r=n.sent,(o=r.data)&&a(Hn(o));case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}function Hn(e){return function(){var t=Tn(regeneratorRuntime.mark(function t(n,a){var r,i,s,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r=a(),i={},s=0;s<e.length;s++)c=e[s],Object(o.getUser)(r,c.creator_id)||(i[c.creator_id]=!0);if(0!==(l=Object.keys(i)).length){t.next=6;break}return t.abrupt("return");case 6:n(Object(g.getProfilesByIds)(l));case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}var Wn=n(307);function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gn(e){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zn(e,t){return(zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Gn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Bn(r)&&"function"!=typeof r?Yn(a):r,Kn(Yn(n),"copyText",function(e){e.preventDefault(),Object(v.g)(n.props.value)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zn(e,t)}(t,m.a.PureComponent),n=t,r=[{key:"defaultProps",get:function(){return{idMessage:"integrations.copy",defaultMessage:"Copy"}}}],(a=[{key:"render",value:function(){if(!document.queryCommandSupported("copy"))return null;var e=m.a.createElement(ce.a,{id:"copy"},m.a.createElement(y.c,{id:this.props.idMessage,defaultMessage:this.props.defaultMessage}));return m.a.createElement(se.a,{delayShow:U.Q.OVERLAY_TIME_DELAY,placement:"top",overlay:e},m.a.createElement("a",{href:"#",className:"fa fa-copy margin-left",onClick:this.copyText}))}}])&&Fn(n.prototype,a),r&&Fn(n,r),t}();function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Xn(e,t){return!t||"object"!==Qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zn(e){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $n(e,t){return($n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Kn(Jn,"propTypes",{value:d.a.string.isRequired,defaultMessage:d.a.string,idMessage:d.a.string});var ea=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xn(this,Zn(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$n(e,t)}(t,Pt),n=t,(a=[{key:"triggerTitle",get:function(){return m.a.createElement(y.c,{id:"installed_integrations.delete",defaultMessage:"Delete"})}},{key:"modalTitle",get:function(){return m.a.createElement(y.c,{id:"integrations.delete.confirm.title",defaultMessage:"Delete Integration"})}},{key:"modalMessage",get:function(){return m.a.createElement("div",{className:"alert alert-warning"},m.a.createElement(B.a,{additionalClassName:"fa-margin--right"}),m.a.createElement(y.c,{id:this.props.messageId,defaultMessage:"This action permanently deletes the integration and breaks any integrations using it. Are you sure you want to delete it?"}))}},{key:"modalConfirmButton",get:function(){return m.a.createElement(y.c,{id:"integrations.delete.confirm.button",defaultMessage:"Delete"})}}])&&Vn(n.prototype,a),r&&Vn(n,r),t}();function ta(e){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function na(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function aa(e){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oa(e,t){return(oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ia(e,t,n){return!n||(-1!==e.display_name.toLowerCase().indexOf(n)||-1!==e.description.toLowerCase().indexOf(n)||!(!e.channel_id||!t||-1===t.name.toLowerCase().indexOf(n)))}ea.propTypes={messageId:d.a.string.isRequired,onDelete:d.a.func.isRequired};var sa=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=aa(t).call(this,e))||"object"!==ta(r)&&"function"!=typeof r?ra(a):r).handleDelete=n.handleDelete.bind(ra(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oa(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"handleDelete",value:function(){this.props.onDelete(this.props.incomingWebhook)}},{key:"render",value:function(){var e,t=this.props.incomingWebhook,n=this.props.channel;if(!ia(t,n,this.props.filter?this.props.filter.toLowerCase():""))return null;e=t.display_name?t.display_name:n?n.display_name:m.a.createElement(y.c,{id:"installed_incoming_webhooks.unknown_channel",defaultMessage:"A Private Webhook"});var a=null;t.description&&(a=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__description"},t.description)));var r=null;this.props.canChange&&(r=m.a.createElement("div",{className:"item-actions"},m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/incoming_webhooks/edit?id=").concat(t.id)},m.a.createElement(y.c,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.a.createElement(ea,{messageId:Object(Kt.b)("installed_incoming_webhooks.delete.confirm"),onDelete:this.handleDelete})));var o=Object(Wn.e)()+"/hooks/"+t.id;return m.a.createElement("div",{className:"backstage-list__item"},m.a.createElement("div",{className:"item-details"},m.a.createElement("div",{className:"item-details__row"},m.a.createElement("strong",{className:"item-details__name"},e)),a,m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__url"},m.a.createElement(y.c,{id:"installed_integrations.url",defaultMessage:"URL: {url}",values:{url:o}}),m.a.createElement("span",null,m.a.createElement(Jn,{value:o})))),m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__creation"},m.a.createElement(y.c,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:this.props.creator.username,createAt:t.create_at}})))),r)}}])&&na(n.prototype,a),r&&na(n,r),t}();function ca(e){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function la(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ua(e){return(ua=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ma(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pa(e,t){return(pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function da(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(sa,"propTypes",{incomingWebhook:d.a.object.isRequired,onDelete:d.a.func.isRequired,filter:d.a.string,creator:d.a.object.isRequired,canChange:d.a.bool.isRequired,team:d.a.object.isRequired,channel:d.a.object});var fa=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=ua(t).call(this,e),n=!r||"object"!==ca(r)&&"function"!=typeof r?ma(a):r,da(ma(n),"deleteIncomingWebhook",function(e){n.props.actions.removeIncomingHook(e.id)}),da(ma(n),"incomingWebhookCompare",function(e,t){var a=e.display_name;if(!a){var r=n.props.channels[e.channel_id];a=r?r.display_name:v.ab("installed_incoming_webhooks.unknown_channel","A Private Webhook")}var o=t.display_name;return a.localeCompare(o)}),da(ma(n),"incomingWebhooks",function(e){return n.props.incomingWebhooks.sort(n.incomingWebhookCompare).filter(function(t){return ia(t,n.props.channels[t.channel_id],e)}).map(function(e){var t=n.props.canManageOthersWebhooks||n.props.user.id===e.user_id,a=n.props.channels[e.channel_id];return m.a.createElement(sa,{key:e.id,incomingWebhook:e,onDelete:n.deleteIncomingWebhook,creator:n.props.users[e.user_id]||{},canChange:t,team:n.props.team,channel:a})})}),n.state={loading:!0},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pa(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.enableIncomingWebhooks&&this.props.actions.loadIncomingHooksAndProfilesForTeam(this.props.teamId,U.Q.Integrations.START_PAGE_NUM,U.Q.Integrations.PAGE_SIZE).then(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){var e=this;return m.a.createElement(I,{header:m.a.createElement(y.c,{id:"installed_incoming_webhooks.header",defaultMessage:"Installed Incoming Webhooks"}),addText:m.a.createElement(y.c,{id:"installed_incoming_webhooks.add",defaultMessage:"Add Incoming Webhook"}),addLink:"/"+this.props.team.name+"/integrations/incoming_webhooks/add",addButtonId:"addIncomingWebhook",emptyText:m.a.createElement(y.c,{id:"installed_incoming_webhooks.empty",defaultMessage:"No incoming webhooks found"}),emptyTextSearch:m.a.createElement(D.b,{id:"installed_incoming_webhooks.emptySearch",defaultMessage:"No incoming webhooks match {searchTerm}"}),helpText:m.a.createElement(y.c,{id:"installed_incoming_webhooks.help",defaultMessage:"Use incoming webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.",values:{buildYourOwn:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://docs.mattermost.com/developer/webhooks-incoming.html"},m.a.createElement(y.c,{id:"installed_incoming_webhooks.help.buildYourOwn",defaultMessage:"Build your own"})),appDirectory:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://about.mattermost.com/default-app-directory/"},m.a.createElement(y.c,{id:"installed_incoming_webhooks.help.appDirectory",defaultMessage:"App Directory"}))}}),searchPlaceholder:v.ab("installed_incoming_webhooks.search","Search Incoming Webhooks"),loading:this.state.loading},function(t){var n=e.incomingWebhooks(t);return[n,n.length>0]})}}])&&la(n.prototype,a),r&&la(n,r),t}();da(fa,"propTypes",{team:d.a.object,user:d.a.object,canManageOthersWebhooks:d.a.bool,incomingWebhooks:d.a.array,channels:d.a.object,users:d.a.object,teamId:d.a.string,actions:d.a.shape({removeIncomingHook:d.a.func,loadIncomingHooksAndProfilesForTeam:d.a.func}),enableIncomingWebhooks:d.a.bool});var ha=Object(a.connect)(function(e){var t=Object(s.getConfig)(e),n=Object(i.getCurrentTeamId)(e),a=Object(c.haveITeamPermission)(e,{team:n,permission:l.Permissions.MANAGE_OTHERS_INCOMING_WEBHOOKS}),r=Object(Pn.getIncomingHooks)(e),u=Object.keys(r).map(function(e){return r[e]}).filter(function(e){return e.team_id===n}),m="true"===t.EnableIncomingWebhooks;return{incomingWebhooks:u,channels:Object(Nn.getAllChannels)(e),users:Object(o.getUsers)(e),teamId:n,canManageOthersWebhooks:a,enableIncomingWebhooks:m}},function(e){return{actions:Object(f.bindActionCreators)({loadIncomingHooksAndProfilesForTeam:An,removeIncomingHook:Cn.removeIncomingHook},e)}})(fa),ba=n(121),ga=n(434),ya=n(186);function va(e){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ea(e,t){return!t||"object"!==va(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ka(e){return(ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oa(e,t){return(Oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wa=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ea(this,ka(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oa(e,t)}(t,m.a.PureComponent),n=t,r=[{key:"propTypes",get:function(){return{channels:d.a.array.isRequired,onChange:d.a.func,value:d.a.string,selectOpen:d.a.bool.isRequired,selectPrivate:d.a.bool.isRequired,selectDm:d.a.bool.isRequired}}},{key:"defaultProps",get:function(){return{selectOpen:!1,selectPrivate:!1,selectDm:!1}}}],(a=[{key:"render",value:function(){var e=this,t=[m.a.createElement("option",{key:"",value:""},v.ab("channel_select.placeholder","--- Select a channel ---"))];return this.props.channels.forEach(function(n){var a=n.display_name||n.name;n.type===U.Q.OPEN_CHANNEL&&e.props.selectOpen?t.push(m.a.createElement("option",{key:n.id,value:n.id},a)):n.type===U.Q.PRIVATE_CHANNEL&&e.props.selectPrivate?t.push(m.a.createElement("option",{key:n.id,value:n.id},a)):n.type===U.Q.DM_CHANNEL&&e.props.selectDm&&t.push(m.a.createElement("option",{key:n.id,value:n.id},a))}),m.a.createElement("select",{className:"form-control",value:this.props.value,onChange:this.props.onChange,id:"channelSelect"},t)}}])&&_a(n.prototype,a),r&&_a(n,r),t}();function ja(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Sa=Object(ba.a)(Nn.getMyChannels,ga.getCurrentUserLocale,function(e,t){return ja(e).sort(ya.sortChannelsByTypeAndDisplayName.bind(null,t))});var Ca=Object(a.connect)(function(e){return{channels:Sa(e)}})(wa);function Na(e){return(Na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pa(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ma(e){return(Ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ra(e,t){return(Ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xa=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Ma(t).call(this,e),n=!r||"object"!==Na(r)&&"function"!=typeof r?Ta(a):r,Aa(Ta(n),"getStateFromHook",function(e){return{displayName:e.display_name||"",description:e.description||"",channelId:e.channel_id||"",channelLocked:e.channel_locked||!1,username:e.username||"",iconURL:e.icon_url||"",saving:!1,serverError:"",clientError:null}}),Aa(Ta(n),"handleSubmit",function(e){if(e.preventDefault(),!n.state.saving)if(n.setState({saving:!0,serverError:"",clientError:""}),n.state.channelId){var t={channel_id:n.state.channelId,channel_locked:n.state.channelLocked,display_name:n.state.displayName,description:n.state.description,username:n.state.username,icon_url:n.state.iconURL};n.props.action(t).then(function(){return n.setState({saving:!1})})}else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_incoming_webhook.channelRequired",defaultMessage:"A valid channel is required"})})}),Aa(Ta(n),"updateDisplayName",function(e){n.setState({displayName:e.target.value})}),Aa(Ta(n),"updateDescription",function(e){n.setState({description:e.target.value})}),Aa(Ta(n),"updateChannelId",function(e){n.setState({channelId:e.target.value})}),Aa(Ta(n),"updateChannelLocked",function(e){n.setState({channelLocked:e.target.checked})}),Aa(Ta(n),"updateUsername",function(e){n.setState({username:e.target.value})}),Aa(Ta(n),"updateIconURL",function(e){n.setState({iconURL:e.target.value})}),n.state=n.getStateFromHook(n.props.initialHook||{}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ra(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.header,t=this.props.footer;return m.a.createElement("div",{className:"backstage-content"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/incoming_webhooks")},m.a.createElement(y.c,{id:"installed_incoming_webhooks.header",defaultMessage:"Incoming Webhooks"})),m.a.createElement(y.c,{id:e.id,defaultMessage:e.defaultMessage})),m.a.createElement("div",{className:"backstage-form"},m.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.a.createElement(y.c,{id:"add_incoming_webhook.displayName",defaultMessage:"Title"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_incoming_webhook.displayName.help",defaultMessage:"Choose a title to be displayed on the webhook settings page. Maximum 64 characters."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.a.createElement(y.c,{id:"add_incoming_webhook.description",defaultMessage:"Description"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"description",type:"text",maxLength:"500",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_incoming_webhook.description.help",defaultMessage:"Description for your incoming webhook."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelId"},m.a.createElement(y.c,{id:"add_incoming_webhook.channel",defaultMessage:"Channel"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(Ca,{id:"channelId",value:this.state.channelId,onChange:this.updateChannelId,selectOpen:!0,selectPrivate:!0}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_incoming_webhook.channel.help",defaultMessage:"The default public or private channel that receives the webhook payloads. You must belong to the private channel when setting up the webhook."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelLocked"},m.a.createElement(y.c,{id:"add_incoming_webhook.channelLocked",defaultMessage:"Lock to this channel"})),m.a.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.a.createElement("input",{id:"channelLocked",type:"checkbox",checked:this.state.channelLocked,onChange:this.updateChannelLocked}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_incoming_webhook.channelLocked.help",defaultMessage:"If set, the incoming webhook can only post to the channel selected above."})))),this.props.enablePostUsernameOverride&&m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.a.createElement(y.c,{id:"add_incoming_webhook.username",defaultMessage:"Username"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"username",type:"text",maxLength:"22",className:"form-control",value:this.state.username,onChange:this.updateUsername}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_incoming_webhook.username.help",defaultMessage:'Choose the username this integration will post as. Usernames can be up to 22 characters, and may contain lowercase letters, numbers and the symbols "-", "_", and ".".'})))),this.props.enablePostIconOverride&&m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconURL"},m.a.createElement(y.c,{id:"add_incoming_webhook.icon_url",defaultMessage:"Profile Picture"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"iconURL",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconURL,onChange:this.updateIconURL}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_incoming_webhook.icon_url.help",defaultMessage:"Choose the profile picture this integration will use when posting. Enter the URL of a .png or .jpg file at least 128 pixels by 128 pixels."})))),m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(Oe.a,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.a.createElement(_.a,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/incoming_webhooks")},m.a.createElement(y.c,{id:"add_incoming_webhook.cancel",defaultMessage:"Cancel"})),m.a.createElement(ke.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:Object(v.ab)(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveWebhook"},m.a.createElement(y.c,{id:t.id,defaultMessage:t.defaultMessage}))))))}}])&&Pa(n.prototype,a),r&&Pa(n,r),t}();function Ia(e){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qa(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Ua(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Da(e){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function La(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ha(e,t){return(Ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Aa(xa,"propTypes",{team:d.a.object.isRequired,header:d.a.object.isRequired,footer:d.a.object.isRequired,loading:d.a.object.isRequired,serverError:d.a.string.isRequired,initialHook:d.a.object,enablePostUsernameOverride:d.a.bool.isRequired,enablePostIconOverride:d.a.bool.isRequired,action:d.a.func.isRequired});var Ba={id:Object(Kt.b)("integrations.add"),defaultMessage:"Add"},Fa={id:Object(Kt.b)("add_incoming_webhook.save"),defaultMessage:"Save"},Ga={id:Object(Kt.b)("add_incoming_webhook.saving"),defaultMessage:"Saving..."},Ya=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Da(t).call(this,e),n=!r||"object"!==Ia(r)&&"function"!=typeof r?La(a):r,Wa(La(n),"addIncomingHook",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.createIncomingHook(t);case 3:if(a=e.sent,!(r=a.data)){e.next=8;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/confirm?type=incoming_webhooks&id=").concat(r.id)),e.abrupt("return");case 8:n.props.createIncomingHookRequest.error&&n.setState({serverError:n.props.createIncomingHookRequest.error.message});case 9:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){qa(o,a,r,i,s,"next",e)}function s(e){qa(o,a,r,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),n.state={serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ha(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){return m.a.createElement(xa,{team:this.props.team,header:Ba,footer:Fa,loading:Ga,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride,action:this.addIncomingHook,serverError:this.state.serverError})}}])&&Ua(n.prototype,a),r&&Ua(n,r),t}();Wa(Ya,"propTypes",{team:d.a.object.isRequired,createIncomingHookRequest:d.a.object.isRequired,enablePostUsernameOverride:d.a.bool.isRequired,enablePostIconOverride:d.a.bool.isRequired,actions:d.a.shape({createIncomingHook:d.a.func.isRequired}).isRequired});var za=Object(a.connect)(function(e){var t=Object(s.getConfig)(e),n="true"===t.EnablePostUsernameOverride,a="true"===t.EnablePostIconOverride;return{createIncomingHookRequest:e.requests.integrations.createIncomingHook,enablePostUsernameOverride:n,enablePostIconOverride:a}},function(e){return{actions:Object(f.bindActionCreators)({createIncomingHook:Cn.createIncomingHook},e)}})(Ya);function Ka(e){return(Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Qa(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Ja(o,a,r,i,s,"next",e)}function s(e){Ja(o,a,r,i,s,"throw",e)}i(void 0)})}}function Va(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Xa(e){return(Xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Za(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $a(e,t){return($a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tr={id:Object(Kt.b)("integrations.edit"),defaultMessage:"Edit"},nr={id:Object(Kt.b)("update_incoming_webhook.update"),defaultMessage:"Update"},ar={id:Object(Kt.b)("update_incoming_webhook.updating"),defaultMessage:"Updating..."},rr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Xa(t).call(this,e),n=!r||"object"!==Ka(r)&&"function"!=typeof r?Za(a):r,er(Za(n),"editIncomingHook",function(){var e=Qa(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.newHook=t,n.props.hook.id&&(t.id=n.props.hook.id),n.props.hook.token&&(t.token=n.props.hook.token),e.next=5,n.submitHook();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),er(Za(n),"submitHook",Qa(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.updateIncomingHook(n.newHook);case 3:if(t=e.sent,!t.data){e.next=8;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/incoming_webhooks")),e.abrupt("return");case 8:n.props.updateIncomingHookRequest.error&&n.setState({serverError:n.props.updateIncomingHookRequest.error.message});case 9:case"end":return e.stop()}},e)}))),n.state={showConfirmModal:!1,serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$a(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){this.props.enableIncomingWebhooks&&this.props.actions.getIncomingHook(this.props.hookId)}},{key:"render",value:function(){return this.props.hook?m.a.createElement(xa,{team:this.props.team,header:tr,footer:nr,loading:ar,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride,action:this.editIncomingHook,serverError:this.state.serverError,initialHook:this.props.hook}):m.a.createElement(E.a,null)}}])&&Va(n.prototype,a),r&&Va(n,r),t}();er(rr,"propTypes",{team:d.a.object.isRequired,hook:d.a.object,hookId:d.a.string.isRequired,updateIncomingHookRequest:d.a.object.isRequired,enableIncomingWebhooks:d.a.bool.isRequired,enablePostUsernameOverride:d.a.bool.isRequired,enablePostIconOverride:d.a.bool.isRequired,actions:d.a.shape({updateIncomingHook:d.a.func.isRequired,getIncomingHook:d.a.func.isRequired}).isRequired});var or=Object(a.connect)(function(e,t){var n=Object(s.getConfig)(e),a="true"===n.EnableIncomingWebhooks,r="true"===n.EnablePostUsernameOverride,o="true"===n.EnablePostIconOverride,i=new URLSearchParams(t.location.search).get("id");return{hookId:i,hook:e.entities.integrations.incomingHooks[i],updateIncomingHookRequest:e.requests.integrations.updateIncomingHook,enableIncomingWebhooks:a,enablePostUsernameOverride:r,enablePostIconOverride:o}},function(e){return{actions:Object(f.bindActionCreators)({updateIncomingHook:Cn.updateIncomingHook,getIncomingHook:Cn.getIncomingHook},e)}})(rr);function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function cr(e){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mr(e,t,n){if(!n)return!0;var a=e.display_name,r=e.description,o=e.trigger_words;if(a&&-1!==a.toLowerCase().indexOf(n)||r&&-1!==r.toLowerCase().indexOf(n))return!0;if(o){var i=!0,s=!1,c=void 0;try{for(var l,u=o[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){if(-1!==l.value.toLowerCase().indexOf(n))return!0}}catch(e){s=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}}return!(!t||!t.name||-1===t.name.toLowerCase().indexOf(n))}var pr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=cr(t).call(this,e))||"object"!==ir(r)&&"function"!=typeof r?lr(a):r).handleRegenToken=n.handleRegenToken.bind(lr(n)),n.handleDelete=n.handleDelete.bind(lr(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"handleRegenToken",value:function(e){e.preventDefault(),this.props.onRegenToken(this.props.outgoingWebhook)}},{key:"handleDelete",value:function(){this.props.onDelete(this.props.outgoingWebhook)}},{key:"makeDisplayName",value:function(e,t){return e.display_name?e.display_name:t?t.display_name:m.a.createElement(y.c,{id:"installed_outgoing_webhooks.unknown_channel",defaultMessage:"A Private Webhook"})}},{key:"render",value:function(){var e=this.props.outgoingWebhook,t=this.props.channel,n=this.props.filter?this.props.filter.toLowerCase():"";if(e&&!mr(e,t,n))return null;var a=this.makeDisplayName(e,t),r=null;e.description&&(r=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__description"},e.description)));var o=null;e.trigger_words&&e.trigger_words.length>0&&(o=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__trigger-words"},m.a.createElement(y.c,{id:"installed_integrations.triggerWords",defaultMessage:"Trigger Words: {triggerWords}",values:{triggerWords:e.trigger_words.join(", ")}}))));var i,s=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__url"},m.a.createElement(y.c,{id:"installed_integrations.callback_urls",defaultMessage:"Callback URLs: {urls}",values:{urls:e.callback_urls.join(", ")}})));0===e.trigger_when?i=m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWordsTriggerWhenFullWord",defaultMessage:"First word matches a trigger word exactly"}):1===e.trigger_when&&(i=m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWordsTriggerWhenStartsWith",defaultMessage:"First word starts with a trigger word"}));var c=null;return this.props.canChange&&(c=m.a.createElement("div",{className:"item-actions"},m.a.createElement("button",{className:"style--none color--link",onClick:this.handleRegenToken},m.a.createElement(y.c,{id:"installed_integrations.regenToken",defaultMessage:"Regen Token"}))," - ",m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/outgoing_webhooks/edit?id=").concat(e.id)},m.a.createElement(y.c,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.a.createElement(ea,{messageId:Object(Kt.b)("installed_outgoing_webhooks.delete.confirm"),onDelete:this.handleDelete}))),m.a.createElement("div",{className:"backstage-list__item"},m.a.createElement("div",{className:"item-details"},m.a.createElement("div",{className:"item-details__row"},m.a.createElement("strong",{className:"item-details__name"},a)),r,m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__content_type"},m.a.createElement(y.c,{id:"installed_integrations.content_type",defaultMessage:"Content-Type: {contentType}",values:{contentType:e.content_type||"application/x-www-form-urlencoded"}}))),o,m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__trigger-when"},m.a.createElement(y.c,{id:"installed_integrations.triggerWhen",defaultMessage:"Trigger When: {triggerWhen}",values:{triggerWhen:i}}))),m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__token"},m.a.createElement(y.c,{id:"installed_integrations.token",defaultMessage:"Token: {token}",values:{token:e.token}}),m.a.createElement(Jn,{value:e.token}))),m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__creation"},m.a.createElement(y.c,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:this.props.creator.username,createAt:e.create_at}}))),s),c)}}])&&sr(n.prototype,a),r&&sr(n,r),t}();function dr(e){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function br(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gr(e,t){return(gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(pr,"propTypes",{outgoingWebhook:d.a.object.isRequired,onRegenToken:d.a.func.isRequired,onDelete:d.a.func.isRequired,filter:d.a.string,creator:d.a.object.isRequired,canChange:d.a.bool.isRequired,team:d.a.object.isRequired,channel:d.a.object});var vr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=hr(t).call(this,e),n=!r||"object"!==dr(r)&&"function"!=typeof r?br(a):r,yr(br(n),"regenOutgoingWebhookToken",function(e){n.props.actions.regenOutgoingHookToken(e.id)}),yr(br(n),"removeOutgoingHook",function(e){n.props.actions.removeOutgoingHook(e.id)}),yr(br(n),"outgoingWebhooks",function(e){return n.props.outgoingWebhooks.sort(n.outgoingWebhookCompare).filter(function(t){return mr(t,n.props.channels[t.channel_id],e)}).map(function(e){var t=n.props.canManageOthersWebhooks||n.props.user.id===e.creator_id,a=n.props.channels[e.channel_id];return m.a.createElement(pr,{key:e.id,outgoingWebhook:e,onRegenToken:n.regenOutgoingWebhookToken,onDelete:n.removeOutgoingHook,creator:n.props.users[e.creator_id]||{},canChange:t,team:n.props.team,channel:a})})}),n.outgoingWebhookCompare=n.outgoingWebhookCompare.bind(br(n)),n.state={loading:!0},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gr(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.enableOutgoingWebhooks&&this.props.actions.loadOutgoingHooksAndProfilesForTeam(this.props.teamId,U.Q.Integrations.START_PAGE_NUM,U.Q.Integrations.PAGE_SIZE).then(function(){return e.setState({loading:!1})})}},{key:"outgoingWebhookCompare",value:function(e,t){var n=e.display_name;if(!n){var a=this.props.channels[e.channel_id];n=a?a.display_name:v.ab("installed_outgoing_webhooks.unknown_channel","A Private Webhook")}var r=t.display_name;if(!r){var o=this.props.channels[t.channel_id];r=o?o.display_name:v.ab("installed_outgoing_webhooks.unknown_channel","A Private Webhook")}return n.localeCompare(r)}},{key:"render",value:function(){var e=this;return m.a.createElement(I,{header:m.a.createElement(y.c,{id:"installed_outgoing_webhooks.header",defaultMessage:"Installed Outgoing Webhooks"}),addText:m.a.createElement(y.c,{id:"installed_outgoing_webhooks.add",defaultMessage:"Add Outgoing Webhook"}),addLink:"/"+this.props.team.name+"/integrations/outgoing_webhooks/add",addButtonId:"addOutgoingWebhook",emptyText:m.a.createElement(y.c,{id:"installed_outgoing_webhooks.empty",defaultMessage:"No outgoing webhooks found"}),emptyTextSearch:m.a.createElement(D.b,{id:"installed_outgoing_webhooks.emptySearch",defaultMessage:"No outgoing webhooks match {searchTerm}"}),helpText:m.a.createElement(y.c,{id:"installed_outgoing_webhooks.help",defaultMessage:"Use outgoing webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.",values:{buildYourOwn:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://docs.mattermost.com/developer/webhooks-outgoing.html"},m.a.createElement(y.c,{id:"installed_outgoing_webhooks.help.buildYourOwn",defaultMessage:"Build your own"})),appDirectory:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://about.mattermost.com/default-app-directory/"},m.a.createElement(y.c,{id:"installed_outgoing_webhooks.help.appDirectory",defaultMessage:"App Directory"}))}}),searchPlaceholder:v.ab("installed_outgoing_webhooks.search","Search Outgoing Webhooks"),loading:this.state.loading},function(t){var n=e.outgoingWebhooks(t);return[n,n.length>0]})}}])&&fr(n.prototype,a),r&&fr(n,r),t}();yr(vr,"propTypes",{team:d.a.object,user:d.a.object,canManageOthersWebhooks:d.a.bool,outgoingWebhooks:d.a.array,channels:d.a.object,users:d.a.object,teamId:d.a.string,actions:d.a.shape({removeOutgoingHook:d.a.func,loadOutgoingHooksAndProfilesForTeam:d.a.func,regenOutgoingHookToken:d.a.func}),enableOutgoingWebhooks:d.a.bool});var _r=Object(a.connect)(function(e){var t=Object(s.getConfig)(e),n=Object(i.getCurrentTeamId)(e),a=Object(c.haveITeamPermission)(e,{team:n,permission:l.Permissions.MANAGE_OTHERS_OUTGOING_WEBHOOKS}),r=Object(Pn.getOutgoingHooks)(e),u=Object.keys(r).map(function(e){return r[e]}).filter(function(e){return e.team_id===n}),m="true"===t.EnableOutgoingWebhooks;return{outgoingWebhooks:u,channels:Object(Nn.getAllChannels)(e),users:Object(o.getUsers)(e),teamId:n,canManageOthersWebhooks:a,enableOutgoingWebhooks:m}},function(e){return{actions:Object(f.bindActionCreators)({loadOutgoingHooksAndProfilesForTeam:In,removeOutgoingHook:Cn.removeOutgoingHook,regenOutgoingHookToken:Cn.regenOutgoingHookToken},e)}})(vr);n(211);function Er(e){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Or(e){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jr(e,t){return(jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Or(t).call(this,e),n=!r||"object"!==Er(r)&&"function"!=typeof r?wr(a):r,Sr(wr(n),"getStateFromHook",function(e){var t="";if(e.trigger_words){var n=0;for(n=0;n<e.trigger_words.length;n++)t+=e.trigger_words[n]+"\n"}var a="";if(e.callback_urls){var r=0;for(r=0;r<e.callback_urls.length;r++)a+=e.callback_urls[r]+"\n"}return{displayName:e.display_name||"",description:e.description||"",contentType:e.content_type||"application/x-www-form-urlencoded",channelId:e.channel_id||"",triggerWords:t,triggerWhen:e.trigger_when||0,callbackUrls:a,saving:!1,clientError:null,username:e.username||"",iconURL:e.icon_url||""}}),Sr(wr(n),"handleSubmit",function(e){if(e.preventDefault(),!n.state.saving){n.setState({saving:!0,clientError:""});var t=[];if(n.state.triggerWords){var a=!0,r=!1,o=void 0;try{for(var i,s=n.state.triggerWords.split("\n")[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;(c=c.trim()).length>0&&t.push(c)}}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}}if(n.state.channelId||0!==t.length){var l=[],u=!0,p=!1,d=void 0;try{for(var f,h=n.state.callbackUrls.split("\n")[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var b=f.value;(b=b.trim()).length>0&&l.push(b)}}catch(e){p=!0,d=e}finally{try{u||null==h.return||h.return()}finally{if(p)throw d}}if(0!==l.length){var g={team_id:n.props.team.id,channel_id:n.state.channelId,trigger_words:t,trigger_when:parseInt(n.state.triggerWhen,10),callback_urls:l,display_name:n.state.displayName,content_type:n.state.contentType,description:n.state.description,username:n.state.username,icon_url:n.state.iconURL};n.props.action(g).then(function(){return n.setState({saving:!1})})}else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_outgoing_webhook.callbackUrlsRequired",defaultMessage:"One or more callback URLs are required"})})}else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWordsOrChannelRequired",defaultMessage:"A valid channel or a list of trigger words is required"})})}}),Sr(wr(n),"updateDisplayName",function(e){n.setState({displayName:e.target.value})}),Sr(wr(n),"updateDescription",function(e){n.setState({description:e.target.value})}),Sr(wr(n),"updateContentType",function(e){n.setState({contentType:e.target.value})}),Sr(wr(n),"updateChannelId",function(e){n.setState({channelId:e.target.value})}),Sr(wr(n),"updateTriggerWords",function(e){n.setState({triggerWords:e.target.value})}),Sr(wr(n),"updateTriggerWhen",function(e){n.setState({triggerWhen:e.target.value})}),Sr(wr(n),"updateCallbackUrls",function(e){n.setState({callbackUrls:e.target.value})}),Sr(wr(n),"updateUsername",function(e){n.setState({username:e.target.value})}),Sr(wr(n),"updateIconURL",function(e){n.setState({iconURL:e.target.value})}),n.state=n.getStateFromHook(n.props.initialHook||{}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jr(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){var e=this.props.header,t=this.props.footer,n=this.props.renderExtra;return m.a.createElement("div",{className:"backstage-content"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/outgoing_webhooks")},m.a.createElement(y.c,{id:"installed_outgoing_webhooks.header",defaultMessage:"Outgoing Webhooks"})),m.a.createElement(y.c,{id:e.id,defaultMessage:e.defaultMessage})),m.a.createElement("div",{className:"backstage-form"},m.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.a.createElement(y.c,{id:"add_outgoing_webhook.displayName",defaultMessage:"Title"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.displayName.help",defaultMessage:"Choose a title to be displayed on the webhook settings page. Maximum 64 characters."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.a.createElement(y.c,{id:"add_outgoing_webhook.description",defaultMessage:"Description"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"description",type:"text",maxLength:"500",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.description.help",defaultMessage:"Description for your incoming webhook."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"contentType"},m.a.createElement(y.c,{id:"add_outgoing_webhook.content_Type",defaultMessage:"Content Type"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("select",{className:"form-control",value:this.state.contentType,onChange:this.updateContentType},m.a.createElement("option",{value:"application/x-www-form-urlencoded"},"application/x-www-form-urlencoded"),m.a.createElement("option",{value:"application/json"},"application/json")),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.contentType.help1",defaultMessage:"Choose the content type by which the request will be sent."})),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.contentType.help2",defaultMessage:"If application/x-www-form-urlencoded is chosen, the server will encode the parameters in a URL format in the request body."})),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.contentType.help3",defaultMessage:"If application/json is chosen, the server will format the request body as JSON."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelId"},m.a.createElement(y.c,{id:"add_outgoing_webhook.channel",defaultMessage:"Channel"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(Ca,{id:"channelId",value:this.state.channelId,onChange:this.updateChannelId,selectOpen:!0}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.channel.help",defaultMessage:"Public channel that delivers payload to webhook. Optional if at least one Trigger Word is specified."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"triggerWords"},m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWords",defaultMessage:"Trigger Words (One Per Line)"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("textarea",{id:"triggerWords",rows:"3",maxLength:"1000",className:"form-control",value:this.state.triggerWords,onChange:this.updateTriggerWords}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWords.help",defaultMessage:"Messages that start with one of the specified words will trigger the outgoing webhook. Optional if Channel is selected."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"triggerWords"},m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWordsTriggerWhen",defaultMessage:"Trigger When"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("select",{className:"form-control",value:this.state.triggerWhen,onChange:this.updateTriggerWhen},m.a.createElement("option",{value:"0"},Object(v.ab)("add_outgoing_webhook.triggerWordsTriggerWhenFullWord","First word matches a trigger word exactly")),m.a.createElement("option",{value:"1"},Object(v.ab)("add_outgoing_webhook.triggerWordsTriggerWhenStartsWith","First word starts with a trigger word"))),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.triggerWordsTriggerWhen.help",defaultMessage:"Choose when to trigger the outgoing webhook; if the first word of a message matches a Trigger Word exactly, or if it starts with a Trigger Word."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"callbackUrls"},m.a.createElement(y.c,{id:"add_outgoing_webhook.callbackUrls",defaultMessage:"Callback URLs (One Per Line)"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("textarea",{id:"callbackUrls",rows:"3",maxLength:"1000",className:"form-control",value:this.state.callbackUrls,onChange:this.updateCallbackUrls}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.callbackUrls.help",defaultMessage:"The URL that messages will be sent to. If the URL is private, add it as a {link}.",values:{link:m.a.createElement("a",{href:"https://about.mattermost.com/default-allow-internal-connections-settings-documentation/",target:"_blank",rel:"noopener noreferrer"},m.a.createElement(y.c,{id:"add_outgoing_webhook.callbackUrls.helpLinkText",defaultMessage:"trusted internal connection"}))}})))),this.props.enablePostUsernameOverride&&m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.a.createElement(y.c,{id:"add_outgoing_webhook.username",defaultMessage:"Username"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"username",type:"text",maxLength:"22",className:"form-control",value:this.state.username,onChange:this.updateUsername}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.username.help",defaultMessage:'Choose the username this integration will post as. Usernames can be up to 22 characters, and may contain lowercase letters, numbers and the symbols "-", "_", and ".".'})))),this.props.enablePostIconOverride&&m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconURL"},m.a.createElement(y.c,{id:"add_outgoing_webhook.icon_url",defaultMessage:"Profile Picture"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"iconURL",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconURL,onChange:this.updateIconURL}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_outgoing_webhook.icon_url.help",defaultMessage:"Choose the profile picture this integration will use when posting. Enter the URL of a .png or .jpg file at least 128 pixels by 128 pixels."})))),m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(Oe.a,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.a.createElement(_.a,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/outgoing_webhooks")},m.a.createElement(y.c,{id:"add_outgoing_webhook.cancel",defaultMessage:"Cancel"})),m.a.createElement(ke.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:Object(v.ab)(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveWebhook"},m.a.createElement(y.c,{id:t.id,defaultMessage:t.defaultMessage})),n))))}}])&&kr(n.prototype,a),r&&kr(n,r),t}();function Nr(e){return(Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pr(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Mr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Tr(e){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ar(e,t){return(Ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Sr(Cr,"propTypes",{team:d.a.object.isRequired,header:d.a.object.isRequired,footer:d.a.object.isRequired,loading:d.a.object.isRequired,renderExtra:d.a.node.isRequired,serverError:d.a.string.isRequired,initialHook:d.a.object,action:d.a.func.isRequired,enablePostUsernameOverride:d.a.bool.isRequired,enablePostIconOverride:d.a.bool.isRequired});var Ir={id:Object(Kt.b)("integrations.add"),defaultMessage:"Add"},qr={id:Object(Kt.b)("add_outgoing_webhook.save"),defaultMessage:"Save"},Ur={id:Object(Kt.b)("add_outgoing_webhook.saving"),defaultMessage:"Saving..."},Dr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Tr(t).call(this,e),n=!r||"object"!==Nr(r)&&"function"!=typeof r?Rr(a):r,xr(Rr(n),"addOutgoingHook",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.createOutgoingHook(t);case 3:if(a=e.sent,!(r=a.data)){e.next=8;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/confirm?type=outgoing_webhooks&id=").concat(r.id)),e.abrupt("return");case 8:n.props.createOutgoingHookRequest.error&&n.setState({serverError:n.props.createOutgoingHookRequest.error.message});case 9:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Pr(o,a,r,i,s,"next",e)}function s(e){Pr(o,a,r,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),n.state={serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ar(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){return m.a.createElement(Cr,{team:this.props.team,header:Ir,footer:qr,loading:Ur,renderExtra:"",action:this.addOutgoingHook,serverError:this.state.serverError,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride})}}])&&Mr(n.prototype,a),r&&Mr(n,r),t}();xr(Dr,"propTypes",{team:d.a.object.isRequired,createOutgoingHookRequest:d.a.object.isRequired,actions:d.a.shape({createOutgoingHook:d.a.func.isRequired}).isRequired,enablePostUsernameOverride:d.a.bool.isRequired,enablePostIconOverride:d.a.bool.isRequired});var Lr=Object(a.connect)(function(e){var t=Object(s.getConfig)(e),n="true"===t.EnablePostUsernameOverride,a="true"===t.EnablePostIconOverride;return{createOutgoingHookRequest:e.requests.integrations.createOutgoingHook,enablePostUsernameOverride:n,enablePostIconOverride:a}},function(e){return{actions:Object(f.bindActionCreators)({createOutgoingHook:Cn.createOutgoingHook},e)}})(Dr);function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wr(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Br(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Wr(o,a,r,i,s,"next",e)}function s(e){Wr(o,a,r,i,s,"throw",e)}i(void 0)})}}function Fr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gr(e){return(Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zr(e,t){return(zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jr={id:"integrations.edit",defaultMessage:"Edit"},Qr={id:"update_outgoing_webhook.update",defaultMessage:"Update"},Vr={id:"update_outgoing_webhook.updating",defaultMessage:"Updating..."},Xr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Gr(t).call(this,e),n=!r||"object"!==Hr(r)&&"function"!=typeof r?Yr(a):r,Kr(Yr(n),"editOutgoingHook",function(){var e=Br(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.newHook=t,n.props.hook.id&&(t.id=n.props.hook.id),n.props.hook.token&&(t.token=n.props.hook.token),a=n.props.hook.trigger_words.length===t.trigger_words.length&&n.props.hook.trigger_words.every(function(e,n){return e===t.trigger_words[n]}),r=n.props.hook.callback_urls.length===t.callback_urls.length&&n.props.hook.callback_urls.every(function(e,n){return e===t.callback_urls[n]}),n.props.hook.content_type===t.content_type&&a&&r){e.next=9;break}n.handleConfirmModal(),e.next=11;break;case 9:return e.next=11,n.submitHook();case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Kr(Yr(n),"handleConfirmModal",function(){n.setState({showConfirmModal:!0})}),Kr(Yr(n),"confirmModalDismissed",function(){n.setState({showConfirmModal:!1})}),Kr(Yr(n),"submitHook",Br(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.updateOutgoingHook(n.newHook);case 3:if(t=e.sent,!t.data){e.next=8;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/outgoing_webhooks")),e.abrupt("return");case 8:n.setState({showConfirmModal:!1}),n.props.updateOutgoingHookRequest.error&&n.setState({serverError:n.props.updateOutgoingHookRequest.error.message});case 10:case"end":return e.stop()}},e)}))),Kr(Yr(n),"renderExtra",function(){var e=m.a.createElement(y.c,{id:"update_outgoing_webhook.update",defaultMessage:"Update"}),t=m.a.createElement(y.c,{id:"update_outgoing_webhook.confirm",defaultMessage:"Edit Outgoing Webhook"}),a=m.a.createElement(y.c,{id:"update_outgoing_webhook.question",defaultMessage:"Your changes may break the existing outgoing webhook. Are you sure you would like to update it?"});return m.a.createElement(L.a,{title:t,message:a,confirmButtonText:e,show:n.state.showConfirmModal,onConfirm:n.submitHook,onCancel:n.confirmModalDismissed})}),n.state={showConfirmModal:!1,serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zr(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){this.props.enableOutgoingWebhooks&&this.props.actions.getOutgoingHook(this.props.hookId)}},{key:"render",value:function(){return this.props.hook?m.a.createElement(Cr,{team:this.props.team,header:Jr,footer:Qr,loading:Vr,renderExtra:this.renderExtra(),action:this.editOutgoingHook,serverError:this.state.serverError,initialHook:this.props.hook,enablePostUsernameOverride:this.props.enablePostUsernameOverride,enablePostIconOverride:this.props.enablePostIconOverride}):m.a.createElement(E.a,null)}}])&&Fr(n.prototype,a),r&&Fr(n,r),t}();Kr(Xr,"propTypes",{team:d.a.object.isRequired,hook:d.a.object,hookId:d.a.string.isRequired,updateOutgoingHookRequest:d.a.object.isRequired,actions:d.a.shape({updateOutgoingHook:d.a.func.isRequired,getOutgoingHook:d.a.func.isRequired}).isRequired,enableOutgoingWebhooks:d.a.bool,enablePostUsernameOverride:d.a.bool.isRequired,enablePostIconOverride:d.a.bool.isRequired});var Zr=Object(a.connect)(function(e,t){var n=Object(s.getConfig)(e),a=new URLSearchParams(t.location.search).get("id"),r="true"===n.EnableOutgoingWebhooks,o="true"===n.EnablePostUsernameOverride,i="true"===n.EnablePostIconOverride;return{hookId:a,hook:e.entities.integrations.outgoingHooks[a],updateOutgoingHookRequest:e.requests.integrations.createOutgoingHook,enableOutgoingWebhooks:r,enablePostUsernameOverride:o,enablePostIconOverride:i}},function(e){return{actions:Object(f.bindActionCreators)({updateOutgoingHook:Cn.updateOutgoingHook,getOutgoingHook:Cn.getOutgoingHook},e)}})(Xr);function $r(e){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function to(e){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function no(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ao(e,t){return(ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ro(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oo="***************";function io(e,t){return!t||-1!==e.name.toLowerCase().indexOf(t)}var so=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=to(t).call(this,e),n=!r||"object"!==$r(r)&&"function"!=typeof r?no(a):r,ro(no(n),"handleShowClientSecret",function(e){e&&e.preventDefault&&e.preventDefault(),n.setState({clientSecret:n.props.oauthApp.client_secret})}),ro(no(n),"handleHideClientSecret",function(e){e.preventDefault(),n.setState({clientSecret:oo})}),ro(no(n),"handleRegenerate",function(e){e.preventDefault(),n.props.onRegenerateSecret(n.props.oauthApp.id).then(function(){var e=n.props.regenOAuthAppSecretRequest.error;e?n.setState({error:e.message}):(n.setState({error:null}),n.handleShowClientSecret())})}),ro(no(n),"handleDelete",function(){n.props.onDelete(n.props.oauthApp)}),n.state={clientSecret:oo},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ao(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e,t,n,a=this.props,r=a.oauthApp,o=a.creatorName;if(this.state.error&&(e=m.a.createElement(Oe.a,{error:this.state.error})),!io(r,this.props.filter))return null;t=r.name?r.name:m.a.createElement(y.c,{id:"installed_integrations.unnamed_oauth_app",defaultMessage:"Unnamed OAuth 2.0 Application"}),r.description&&(n=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__description"},r.description)));var i,s,c,l=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__url"},m.a.createElement(y.c,{id:"installed_integrations.callback_urls",defaultMessage:"Callback URLs: {urls}",values:{urls:r.callback_urls.join(", ")}})));i=r.is_trusted?v.ab("installed_oauth_apps.trusted.yes","Yes"):v.ab("installed_oauth_apps.trusted.no","No"),this.state.clientSecret===oo?(s=m.a.createElement("button",{id:"showSecretButton",className:"style--none color--link",onClick:this.handleShowClientSecret},m.a.createElement(y.c,{id:"installed_integrations.showSecret",defaultMessage:"Show Secret"})),c=m.a.createElement("span",{className:"item-details__token"},m.a.createElement(y.c,{id:"installed_integrations.client_secret",defaultMessage:"Client Secret: **{clientSecret}**",values:{clientSecret:this.state.clientSecret}}))):(s=m.a.createElement("button",{id:"hideSecretButton",className:"style--none color--link",onClick:this.handleHideClientSecret},m.a.createElement(y.c,{id:"installed_integrations.hideSecret",defaultMessage:"Hide Secret"})),c=m.a.createElement("span",{className:"item-details__token"},m.a.createElement(D.b,{id:"installed_integrations.client_secret",defaultMessage:"Client Secret: **{clientSecret}**",values:{clientSecret:this.state.clientSecret}}),m.a.createElement(Jn,{idMessage:"integrations.copy_client_secret",defaultMessage:"Copy Client Secret",value:this.state.clientSecret})));var u,p=m.a.createElement("button",{id:"regenerateSecretButton",className:"style--none color--link",onClick:this.handleRegenerate},m.a.createElement(y.c,{id:"installed_integrations.regenSecret",defaultMessage:"Regenerate Secret"}));return r.icon_url&&(u=m.a.createElement("div",{className:"integration__icon integration-list__icon"},m.a.createElement("img",{alt:"get app screenshot",src:r.icon_url}))),m.a.createElement("div",{className:"backstage-list__item"},u,m.a.createElement("div",{className:"item-details"},m.a.createElement("div",{className:"item-details__row"},m.a.createElement("strong",{className:"item-details__name"},t)),e,n,m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__url"},m.a.createElement(D.b,{id:"installed_oauth_apps.is_trusted",defaultMessage:"Is Trusted: **{isTrusted}**",values:{isTrusted:i}}))),m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__token"},m.a.createElement(D.b,{id:"installed_integrations.client_id",defaultMessage:"Client ID: **{clientId}**",values:{clientId:r.id}}),m.a.createElement(Jn,{idMessage:"integrations.copy_client_id",defaultMessage:"Copy Client Id",value:r.id}))),m.a.createElement("div",{className:"item-details__row"},c),l,m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__creation"},m.a.createElement(y.c,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:o,createAt:r.create_at}})))),m.a.createElement("div",{className:"item-actions"},s," - ",p," - ",m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/oauth2-apps/edit?id=").concat(r.id)},m.a.createElement(y.c,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.a.createElement(ea,{messageId:Object(Kt.b)("installed_oauth_apps.delete.confirm"),onDelete:this.handleDelete})))}}])&&eo(n.prototype,a),r&&eo(n,r),t}();ro(so,"propTypes",{team:d.a.object,oauthApp:d.a.object.isRequired,creatorName:d.a.string.isRequired,regenOAuthAppSecretRequest:d.a.object.isRequired,onRegenerateSecret:d.a.func.isRequired,onDelete:d.a.func.isRequired,filter:d.a.string});var co=Object(a.connect)(function(e,t){var n=t.oauthApp||{};return{creatorName:Object(v.v)(Object(o.getUser)(e,n.creator_id))}})(so);function lo(e){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mo(e){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fo(e,t){return(fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ho(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bo=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=mo(t).call(this,e),n=!r||"object"!==lo(r)&&"function"!=typeof r?po(a):r,ho(po(n),"deleteOAuthApp",function(e){e&&e.id&&n.props.actions.deleteOAuthApp(e.id)}),ho(po(n),"oauthApps",function(e){return Object.values(n.props.oauthApps).filter(function(t){return io(t,e)}).sort(n.oauthAppCompare).map(function(e){return m.a.createElement(co,{key:e.id,team:n.props.team,oauthApp:e,regenOAuthAppSecretRequest:n.props.regenOAuthAppSecretRequest,onRegenerateSecret:n.props.actions.regenOAuthAppSecret,onDelete:n.deleteOAuthApp})})}),n.state={loading:!0},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fo(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.enableOAuthServiceProvider&&this.props.actions.loadOAuthAppsAndProfiles().then(function(){return e.setState({loading:!1})})}},{key:"oauthAppCompare",value:function(e,t){var n=e.name;n||(n=Object(v.ab)("installed_integrations.unnamed_oauth_app","Unnamed OAuth 2.0 Application"));var a=t.name;return a||(a=Object(v.ab)("installed_integrations.unnamed_oauth_app","Unnamed OAuth 2.0 Application")),n.localeCompare(a)}},{key:"render",value:function(){var e,t=this;return this.props.enableOAuthServiceProvider&&this.props.canManageOauth&&(e={addLink:"/"+this.props.team.name+"/integrations/oauth2-apps/add",addText:Object(v.ab)("installed_oauth_apps.add","Add OAuth 2.0 Application"),addButtonId:"addOauthApp"}),m.a.createElement(I,Object.assign({header:m.a.createElement(y.c,{id:"installed_oauth_apps.header",defaultMessage:"OAuth 2.0 Applications"}),helpText:m.a.createElement(y.c,{id:"installed_oauth_apps.help",defaultMessage:"Create {oauthApplications} to securely integrate bots and third-party apps with Mattermost. Visit the {appDirectory} to find available self-hosted apps.",values:{oauthApplications:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.mattermost.com/developer/oauth-2-0-applications.html"},m.a.createElement(y.c,{id:"installed_oauth_apps.help.oauthApplications",defaultMessage:"OAuth 2.0 applications"})),appDirectory:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://about.mattermost.com/default-app-directory/"},m.a.createElement(y.c,{id:"installed_oauth_apps.help.appDirectory",defaultMessage:"App Directory"}))}}),emptyText:m.a.createElement(y.c,{id:"installed_oauth_apps.empty",defaultMessage:"No OAuth 2.0 Applications found"}),emptyTextSearch:m.a.createElement(D.b,{id:"installed_oauth_apps.emptySearch",defaultMessage:"No OAuth 2.0 Applications match {searchTerm}"}),searchPlaceholder:Object(v.ab)("installed_oauth_apps.search","Search OAuth 2.0 Applications"),loading:this.state.loading},e),function(e){var n=t.oauthApps(e);return[n,n.length>0]})}}])&&uo(n.prototype,a),r&&uo(n,r),t}();ho(bo,"propTypes",{team:d.a.object,oauthApps:d.a.object,canManageOauth:d.a.bool,regenOAuthAppSecretRequest:d.a.object.isRequired,actions:d.a.shape({loadOAuthAppsAndProfiles:d.a.func.isRequired,regenOAuthAppSecret:d.a.func.isRequired,deleteOAuthApp:d.a.func.isRequired}).isRequired,enableOAuthServiceProvider:d.a.bool});var go=Object(a.connect)(function(e){var t="true"===Object(s.getConfig)(e).EnableOAuthServiceProvider;return{canManageOauth:Object(c.haveISystemPermission)(e,{permission:l.Permissions.MANAGE_OAUTH}),oauthApps:Object(Pn.getOAuthApps)(e),regenOAuthAppSecretRequest:e.requests.integrations.updateOAuthApp,enableOAuthServiceProvider:t}},function(e){return{actions:Object(f.bindActionCreators)({loadOAuthAppsAndProfiles:Ln,regenOAuthAppSecret:Cn.regenOAuthAppSecret,deleteOAuthApp:Cn.deleteOAuthApp},e)}})(bo);function yo(e){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _o(e){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ko(e,t){return(ko=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wo=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=_o(t).call(this,e),n=!r||"object"!==yo(r)&&"function"!=typeof r?Eo(a):r,Oo(Eo(n),"getStateFromApp",function(e){return{name:e.name||"",description:e.description||"",homepage:e.homepage||"",icon_url:e.icon_url||"",callbackUrls:e.callback_urls?e.callback_urls.join("\n"):"",is_trusted:e.is_trusted||!1,has_icon:Boolean(e.icon_url),saving:!1,clientError:null}}),Oo(Eo(n),"imageLoaded",function(){n.setState({has_icon:!0,icon_url:n.refs.icon_url.value})}),Oo(Eo(n),"handleSubmit",function(e){if(e.preventDefault(),!n.state.saving)if(n.setState({saving:!0,clientError:""}),n.state.name)if(n.state.description)if(n.state.homepage){var t=[],a=!0,r=!1,o=void 0;try{for(var i,s=n.state.callbackUrls.split("\n")[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var c=i.value;(c=c.trim()).length>0&&t.push(c)}}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}if(0!==t.length){var l={name:n.state.name,callback_urls:t,homepage:n.state.homepage,description:n.state.description,is_trusted:n.state.is_trusted,icon_url:n.state.icon_url};n.props.action(l).then(function(){return n.setState({saving:!1})})}else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_oauth_app.callbackUrlsRequired",defaultMessage:"One or more callback URLs are required."})})}else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_oauth_app.homepageRequired",defaultMessage:"Homepage for the OAuth 2.0 application is required."})});else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_oauth_app.descriptionRequired",defaultMessage:"Description for the OAuth 2.0 application is required."})});else n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_oauth_app.nameRequired",defaultMessage:"Name for the OAuth 2.0 application is required."})})}),Oo(Eo(n),"updateName",function(e){n.setState({name:e.target.value})}),Oo(Eo(n),"updateTrusted",function(e){n.setState({is_trusted:"true"===e.target.value})}),Oo(Eo(n),"updateDescription",function(e){n.setState({description:e.target.value})}),Oo(Eo(n),"updateHomepage",function(e){n.setState({homepage:e.target.value})}),Oo(Eo(n),"updateIconUrl",function(e){n.setState({has_icon:!1,icon_url:e.target.value}),n.image.src=e.target.value}),Oo(Eo(n),"updateCallbackUrls",function(e){n.setState({callbackUrls:e.target.value})}),n.image=new Image,n.image.onload=n.imageLoaded,n.state=n.getStateFromApp(n.props.initialApp||{}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ko(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e,t=this.props.header,n=this.props.footer,a=this.props.renderExtra;this.state.has_icon&&(e=m.a.createElement("div",{className:"integration__icon"},m.a.createElement("img",{alt:"integration icon",src:this.state.icon_url})));var r=m.a.createElement(Je.a,{permissions:[l.Permissions.MANAGE_SYSTEM]},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"is_trusted"},m.a.createElement(y.c,{id:"installed_oauth_apps.trusted",defaultMessage:"Is Trusted"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("label",{className:"radio-inline"},m.a.createElement("input",{type:"radio",value:"true",name:"is_trusted",checked:this.state.is_trusted,onChange:this.updateTrusted}),m.a.createElement(y.c,{id:"installed_oauth_apps.trusted.yes",defaultMessage:"Yes"})),m.a.createElement("label",{className:"radio-inline"},m.a.createElement("input",{type:"radio",value:"false",name:"is_trusted",checked:!this.state.is_trusted,onChange:this.updateTrusted}),m.a.createElement(y.c,{id:"installed_oauth_apps.trusted.no",defaultMessage:"No"})),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_oauth_app.trusted.help",defaultMessage:"When true, the OAuth 2.0 application is considered trusted by the Mattermost server and doesn't require the user to accept authorization. When false, an additional window will appear, asking the user to accept or deny the authorization."})))));return m.a.createElement("div",{className:"backstage-content"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/oauth2-apps")},m.a.createElement(y.c,{id:"installed_oauth_apps.header",defaultMessage:"Installed OAuth2 Apps"})),m.a.createElement(y.c,{id:t.id,defaultMessage:t.defaultMessage})),m.a.createElement("div",{className:"backstage-form"},e,m.a.createElement("form",{className:"form-horizontal"},r,m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},m.a.createElement(y.c,{id:"installed_oauth_apps.name",defaultMessage:"Display Name"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_oauth_app.name.help",defaultMessage:"Display name for your OAuth 2.0 application made of up to 64 characters."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.a.createElement(y.c,{id:"installed_oauth_apps.description",defaultMessage:"Description"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"description",type:"text",maxLength:"512",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_oauth_app.description.help",defaultMessage:"Description for your OAuth 2.0 application."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"homepage"},m.a.createElement(y.c,{id:"installed_oauth_apps.homepage",defaultMessage:"Homepage"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"homepage",type:"url",maxLength:"256",className:"form-control",value:this.state.homepage,onChange:this.updateHomepage}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_oauth_app.homepage.help",defaultMessage:"The URL for the homepage of the OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL depending on your server configuration."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"icon_url"},m.a.createElement(y.c,{id:"installed_oauth_apps.iconUrl",defaultMessage:"Icon URL"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"icon_url",ref:"icon_url",type:"url",maxLength:"512",className:"form-control",value:this.state.icon_url,onChange:this.updateIconUrl}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_oauth_app.icon.help",defaultMessage:"The URL for the homepage of the OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL depending on your server configuration."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"callbackUrls"},m.a.createElement(y.c,{id:"installed_oauth_apps.callbackUrls",defaultMessage:"Callback URLs (One Per Line)"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("textarea",{id:"callbackUrls",rows:"3",maxLength:"1024",className:"form-control",value:this.state.callbackUrls,onChange:this.updateCallbackUrls}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_oauth_app.callbackUrls.help",defaultMessage:"The redirect URIs to which the service will redirect users after accepting or denying authorization of your application, and which will handle authorization codes or access tokens. Must be a valid URL and start with http:// or https://."})))),m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(Oe.a,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.a.createElement(_.a,{className:"btn btn-link btn-sm",to:"/".concat(this.props.team.name,"/integrations/oauth2-apps")},m.a.createElement(y.c,{id:"installed_oauth_apps.cancel",defaultMessage:"Cancel"})),m.a.createElement(ke.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:Object(v.ab)(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveOauthApp"},m.a.createElement(y.c,{id:n.id,defaultMessage:n.defaultMessage})),a))))}}])&&vo(n.prototype,a),r&&vo(n,r),t}();function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function So(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Co(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function No(e){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mo(e,t){return(Mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function To(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Oo(wo,"propTypes",{team:d.a.object.isRequired,header:d.a.object.isRequired,footer:d.a.object.isRequired,loading:d.a.object.isRequired,renderExtra:d.a.node.isRequired,serverError:d.a.string.isRequired,initialApp:d.a.object,action:d.a.func.isRequired});var Ro={id:Object(Kt.b)("add_oauth_app.header"),defaultMessage:"Add"},Ao={id:Object(Kt.b)("installed_oauth_apps.save"),defaultMessage:"Save"},xo={id:Object(Kt.b)("installed_oauth_apps.saving"),defaultMessage:"Saving..."},Io=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=No(t).call(this,e),n=!r||"object"!==jo(r)&&"function"!=typeof r?Po(a):r,To(Po(n),"addOAuthApp",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.addOAuthApp(t);case 3:if(a=e.sent,!(r=a.data)){e.next=8;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/confirm?type=oauth2-apps&id=").concat(r.id)),e.abrupt("return");case 8:n.props.addOAuthAppRequest.error&&n.setState({serverError:n.props.addOAuthAppRequest.error.message});case 9:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){So(o,a,r,i,s,"next",e)}function s(e){So(o,a,r,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),n.state={serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mo(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){return m.a.createElement(wo,{team:this.props.team,header:Ro,footer:Ao,loading:xo,renderExtra:"",action:this.addOAuthApp,serverError:this.state.serverError})}}])&&Co(n.prototype,a),r&&Co(n,r),t}();To(Io,"propTypes",{team:d.a.object,addOAuthAppRequest:d.a.object.isRequired,actions:d.a.shape({addOAuthApp:d.a.func.isRequired}).isRequired});var qo=Object(a.connect)(function(e){return{addOAuthAppRequest:e.requests.integrations.addOAuthApp}},function(e){return{actions:Object(f.bindActionCreators)({addOAuthApp:Cn.addOAuthApp},e)}})(Io);function Uo(e){return(Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Do(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function Lo(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Do(o,a,r,i,s,"next",e)}function s(e){Do(o,a,r,i,s,"throw",e)}i(void 0)})}}function Ho(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wo(e){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fo(e,t){return(Fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Go(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yo={id:"integrations.edit",defaultMessage:"Edit"},zo={id:"update_incoming_webhook.update",defaultMessage:"Update"},Ko={id:"update_incoming_webhook.updating",defaultMessage:"Updating..."},Jo=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Wo(t).call(this,e),n=!r||"object"!==Uo(r)&&"function"!=typeof r?Bo(a):r,Go(Bo(n),"editOAuthApp",function(){var e=Lo(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.newApp=t,n.props.oauthApp.id&&(t.id=n.props.oauthApp.id),n.props.oauthApp.token&&(t.token=n.props.oauthApp.token),!1!==(n.props.oauthApp.callback_urls.length===t.callback_urls.length&&n.props.oauthApp.callback_urls.every(function(e,n){return e===t.callback_urls[n]}))){e.next=8;break}n.handleConfirmModal(),e.next=10;break;case 8:return e.next=10,n.submitOAuthApp();case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Go(Bo(n),"handleConfirmModal",function(){n.setState({showConfirmModal:!0})}),Go(Bo(n),"confirmModalDismissed",function(){n.setState({showConfirmModal:!1})}),Go(Bo(n),"submitOAuthApp",Lo(regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.editOAuthApp(n.newApp);case 3:if(t=e.sent,a=t.data,r=t.error,!a){e.next=9;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/oauth2-apps")),e.abrupt("return");case 9:n.setState({showConfirmModal:!1}),r&&n.setState({serverError:r.message});case 11:case"end":return e.stop()}},e)}))),Go(Bo(n),"renderExtra",function(){var e=m.a.createElement(y.c,{id:"update_command.update",defaultMessage:"Update"}),t=m.a.createElement(y.c,{id:"update_oauth_app.confirm",defaultMessage:"Edit OAuth 2.0 application"}),a=m.a.createElement(y.c,{id:"update_oauth_app.question",defaultMessage:"Your changes may break the existing OAuth 2.0 application. Are you sure you would like to update it?"});return m.a.createElement(L.a,{title:t,message:a,confirmButtonText:e,show:n.state.showConfirmModal,onConfirm:n.submitOAuthApp,onCancel:n.confirmModalDismissed})}),n.state={showConfirmModal:!1,serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fo(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){this.props.enableOAuthServiceProvider&&this.props.actions.getOAuthApp(this.props.oauthAppId)}},{key:"render",value:function(){return this.props.oauthApp?m.a.createElement(wo,{team:this.props.team,header:Yo,footer:zo,loading:Ko,renderExtra:this.renderExtra(),action:this.editOAuthApp,serverError:this.state.serverError,initialApp:this.props.oauthApp}):m.a.createElement(E.a,null)}}])&&Ho(n.prototype,a),r&&Ho(n,r),t}();Go(Jo,"propTypes",{team:d.a.object.isRequired,oauthAppId:d.a.string.isRequired,oauthApp:d.a.object,actions:d.a.shape({getOAuthApp:d.a.func.isRequired,editOAuthApp:d.a.func.isRequired}).isRequired,enableOAuthServiceProvider:d.a.bool});var Qo=Object(a.connect)(function(e,t){var n=Object(s.getConfig)(e),a=new URLSearchParams(t.location.search).get("id"),r="true"===n.EnableOAuthServiceProvider;return{oauthAppId:a,oauthApp:e.entities.integrations.oauthApps[a],enableOAuthServiceProvider:r}},function(e){return{actions:Object(f.bindActionCreators)({getOAuthApp:Cn.getOAuthApp,editOAuthApp:Cn.editOAuthApp},e)}})(Jo);function Vo(e){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Zo(e){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ei(e,t){return(ei=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ti(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ni(e,t){return!t||(-1!==e.display_name.toLowerCase().indexOf(t)||-1!==e.description.toLowerCase().indexOf(t)||-1!==e.trigger.toLowerCase().indexOf(t))}var ai=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Zo(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Vo(r)&&"function"!=typeof r?$o(a):r,ti($o(n),"handleRegenToken",function(e){e.preventDefault(),n.props.onRegenToken(n.props.command)}),ti($o(n),"handleDelete",function(){n.props.onDelete(n.props.command)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ei(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e,t=this.props.command;if(!ni(t,this.props.filter?this.props.filter.toLowerCase():""))return null;e=t.display_name?t.display_name:m.a.createElement(y.c,{id:"installed_commands.unnamed_command",defaultMessage:"Unnamed Slash Command"});var n=null;t.description&&(n=m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__description"},t.description)));var a="- /"+t.trigger;t.auto_complete&&t.auto_complete_hint&&(a+=" "+t.auto_complete_hint);var r=null;this.props.canChange&&(r=m.a.createElement("div",{className:"item-actions"},m.a.createElement("button",{className:"style--none color--link",onClick:this.handleRegenToken},m.a.createElement(y.c,{id:"installed_integrations.regenToken",defaultMessage:"Regenerate Token"}))," - ",m.a.createElement(_.a,{to:"/".concat(this.props.team.name,"/integrations/commands/edit?id=").concat(t.id)},m.a.createElement(y.c,{id:"installed_integrations.edit",defaultMessage:"Edit"}))," - ",m.a.createElement(ea,{messageId:Object(Kt.b)("installed_commands.delete.confirm"),onDelete:this.handleDelete})));var o=t.token;return m.a.createElement("div",{className:"backstage-list__item"},m.a.createElement("div",{className:"item-details"},m.a.createElement("div",{className:"item-details__row"},m.a.createElement("strong",{className:"item-details__name"},e),m.a.createElement("span",{className:"item-details__trigger"},a)),n,m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__token"},m.a.createElement(y.c,{id:"installed_integrations.token",defaultMessage:"Token: {token}",values:{token:o}}),m.a.createElement(Jn,{value:o}))),m.a.createElement("div",{className:"item-details__row"},m.a.createElement("span",{className:"item-details__creation"},m.a.createElement(y.c,{id:"installed_integrations.creation",defaultMessage:"Created by {creator} on {createAt, date, full}",values:{creator:this.props.creator.username,createAt:t.create_at}})))),r)}}])&&Xo(n.prototype,a),r&&Xo(n,r),t}();function ri(e){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oi(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ci(e,t){return(ci=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ti(ai,"propTypes",{team:d.a.object.isRequired,command:d.a.object.isRequired,onRegenToken:d.a.func.isRequired,onDelete:d.a.func.isRequired,filter:d.a.string,creator:d.a.object.isRequired,canChange:d.a.bool.isRequired});var ui=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=ii(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ri(r)&&"function"!=typeof r?si(a):r,li(si(n),"regenCommandToken",function(e){n.props.actions.regenCommandToken(e.id)}),li(si(n),"deleteCommand",function(e){n.props.actions.deleteCommand(e.id)}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ci(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"commandCompare",value:function(e,t){var n=e.display_name;n||(n=v.ab("installed_commands.unnamed_command","Unnamed Slash Command"));var a=t.display_name;return a||(a=v.ab("installed_commands.unnamed_command","Unnamed Slash Command")),n.localeCompare(a)}},{key:"render",value:function(){var e=this;return m.a.createElement(I,{header:m.a.createElement(y.c,{id:"installed_commands.header",defaultMessage:"Installed Slash Commands"}),addText:m.a.createElement(y.c,{id:"installed_commands.add",defaultMessage:"Add Slash Command"}),addLink:"/"+this.props.team.name+"/integrations/commands/add",addButtonId:"addSlashCommand",emptyText:m.a.createElement(y.c,{id:"installed_commands.empty",defaultMessage:"No slash commands found"}),emptyTextSearch:m.a.createElement(D.b,{id:"installed_commands.emptySearch",defaultMessage:"No slash commands match {searchTerm}"}),helpText:m.a.createElement(y.c,{id:"installed_commands.help",defaultMessage:"Use slash commands to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.",values:{buildYourOwn:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://docs.mattermost.com/developer/slash-commands.html"},m.a.createElement(y.c,{id:"installed_commands.help.buildYourOwn",defaultMessage:"Build your own"})),appDirectory:m.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://about.mattermost.com/default-app-directory/"},m.a.createElement(y.c,{id:"installed_commands.help.appDirectory",defaultMessage:"App Directory"}))}}),searchPlaceholder:v.ab("installed_commands.search","Search Slash Commands"),loading:this.props.loading},function(t){var n=function(t){return e.props.commands.filter(function(t){return t.team_id===e.props.team.id}).filter(function(e){return ni(e,t)}).sort(e.commandCompare).map(function(t){var n=e.props.canManageOthersSlashCommands||e.props.user.id===t.creator_id;return m.a.createElement(ai,{key:t.id,team:e.props.team,command:t,onRegenToken:e.regenCommandToken,onDelete:e.deleteCommand,creator:e.props.users[t.creator_id]||{},canChange:n})})}(t);return[n,n.length>0]})}}])&&oi(n.prototype,a),r&&oi(n,r),t}();li(ui,"propTypes",{team:d.a.object,user:d.a.object,users:d.a.object,commands:d.a.array,loading:d.a.bool,canManageOthersSlashCommands:d.a.bool,actions:d.a.shape({regenCommandToken:d.a.func.isRequired,deleteCommand:d.a.func.isRequired}).isRequired});var mi=Object(a.connect)(function(e,t){return{canManageOthersSlashCommands:Object(c.haveITeamPermission)(e,{team:t.team.id,permission:l.Permissions.MANAGE_OTHERS_SLASH_COMMANDS})}},function(e){return{actions:Object(f.bindActionCreators)({regenCommandToken:Cn.regenCommandToken,deleteCommand:Cn.deleteCommand},e)}})(ui);function pi(e){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function di(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function fi(e){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bi(e,t){return(bi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yi="P",vi=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=fi(t).call(this,e),n=!r||"object"!==pi(r)&&"function"!=typeof r?hi(a):r,gi(hi(n),"getStateFromCommand",function(e){return{displayName:e.display_name||"",description:e.description||"",trigger:e.trigger||"",url:e.url||"",method:e.method||yi,username:e.username||"",iconUrl:e.icon_url||"",autocomplete:e.auto_complete||!1,autocompleteHint:e.auto_complete_hint||"",autocompleteDescription:e.auto_complete_desc||"",saving:!1,clientError:null}}),gi(hi(n),"handleSubmit",function(e){if(e.preventDefault(),!n.state.saving){n.setState({saving:!0,clientError:""});var t=n.state.trigger.trim().toLowerCase();0===t.indexOf("/")&&(t=t.substr(1));var a={display_name:n.state.displayName,description:n.state.description,trigger:t,url:n.state.url.trim(),method:n.state.method,username:n.state.username,icon_url:n.state.iconUrl,auto_complete:n.state.autocomplete,team_id:n.props.team.id};a.auto_complete&&(a.auto_complete_desc=n.state.autocompleteDescription,a.auto_complete_hint=n.state.autocompleteHint),a.trigger?0!==a.trigger.indexOf("/")?-1===a.trigger.indexOf(" ")?a.trigger.length<U.Q.MIN_TRIGGER_LENGTH||a.trigger.length>U.Q.MAX_TRIGGER_LENGTH?n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_command.triggerInvalidLength",defaultMessage:"A trigger word must contain between {min} and {max} characters",values:{min:U.Q.MIN_TRIGGER_LENGTH,max:U.Q.MAX_TRIGGER_LENGTH}})}):a.url?n.props.action(a).then(function(){return n.setState({saving:!1})}):n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_command.urlRequired",defaultMessage:"A request URL is required"})}):n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_command.triggerInvalidSpace",defaultMessage:"A trigger word must not contain spaces"})}):n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_command.triggerInvalidSlash",defaultMessage:"A trigger word cannot begin with a /"})}):n.setState({saving:!1,clientError:m.a.createElement(y.c,{id:"add_command.triggerRequired",defaultMessage:"A trigger word is required"})})}}),gi(hi(n),"updateDisplayName",function(e){n.setState({displayName:e.target.value})}),gi(hi(n),"updateDescription",function(e){n.setState({description:e.target.value})}),gi(hi(n),"updateTrigger",function(e){n.setState({trigger:e.target.value})}),gi(hi(n),"updateUrl",function(e){n.setState({url:e.target.value})}),gi(hi(n),"updateMethod",function(e){n.setState({method:e.target.value})}),gi(hi(n),"updateUsername",function(e){n.setState({username:e.target.value})}),gi(hi(n),"updateIconUrl",function(e){n.setState({iconUrl:e.target.value})}),gi(hi(n),"updateAutocomplete",function(e){n.setState({autocomplete:e.target.checked})}),gi(hi(n),"updateAutocompleteHint",function(e){n.setState({autocompleteHint:e.target.value})}),gi(hi(n),"updateAutocompleteDescription",function(e){n.setState({autocompleteDescription:e.target.value})}),n.state=n.getStateFromCommand(n.props.initialCommand||{}),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bi(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){var e=null,t=null;return this.state.autocomplete&&(e=m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocompleteHint"},m.a.createElement(y.c,{id:"add_command.autocompleteHint",defaultMessage:"Autocomplete Hint"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(zt.a,{id:"autocompleteHint",type:"text",maxLength:"1024",className:"form-control",value:this.state.autocompleteHint,onChange:this.updateAutocompleteHint,placeholder:{id:Object(Kt.b)("add_command.autocompleteHint.placeholder"),defaultMessage:"Example: [Patient Name]"}}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.autocompleteHint.help",defaultMessage:"(Optional) Arguments associated with your slash command, displayed as help in the autocomplete list."})))),t=m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocompleteDescription"},m.a.createElement(y.c,{id:"add_command.autocompleteDescription",defaultMessage:"Autocomplete Description"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(zt.a,{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.autocompleteDescription,onChange:this.updateAutocompleteDescription,placeholder:{id:Object(Kt.b)("add_command.autocompleteDescription.placeholder"),defaultMessage:'Example: "Returns search results for patient records"'}}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.autocompleteDescription.help",defaultMessage:"(Optional) Short description of slash command for the autocomplete list."}))))),m.a.createElement("div",{className:"backstage-content row"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/"+this.props.team.name+"/integrations/commands"},m.a.createElement(y.c,{id:"installed_command.header",defaultMessage:"Slash Commands"})),m.a.createElement(y.c,{id:this.props.header.id,defaultMessage:this.props.header.defaultMessage})),m.a.createElement("div",{className:"backstage-form"},m.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},m.a.createElement(y.c,{id:"add_command.displayName",defaultMessage:"Title"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.displayName.help",defaultMessage:"Choose a title to be displayed on the slash command settings page. Maximum 64 characters."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},m.a.createElement(y.c,{id:"add_command.description",defaultMessage:"Description"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("input",{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.description,onChange:this.updateDescription}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.description.help",defaultMessage:"Description for your incoming webhook."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"trigger"},m.a.createElement(y.c,{id:"add_command.trigger",defaultMessage:"Command Trigger Word"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(zt.a,{id:"trigger",type:"text",maxLength:U.Q.MAX_TRIGGER_LENGTH,className:"form-control",value:this.state.trigger,onChange:this.updateTrigger,placeholder:{id:Object(Kt.b)("add_command.trigger.placeholder"),defaultMessage:'Command trigger e.g. "hello" not including the slash'}}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.trigger.help",defaultMessage:"Trigger word must be unique, and cannot begin with a slash or contain any spaces."})),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.trigger.helpExamples",defaultMessage:"Examples: client, employee, patient, weather"})),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.trigger.helpReserved",defaultMessage:"Reserved: {link}",values:{link:m.a.createElement("a",{href:"https://docs.mattermost.com/help/messaging/executing-commands.html#built-in-commands",target:"_blank",rel:"noopener noreferrer"},m.a.createElement(y.c,{id:"add_command.trigger.helpReservedLinkText",defaultMessage:"see list of built-in slash commands"}))}})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"url"},m.a.createElement(y.c,{id:"add_command.url",defaultMessage:"Request URL"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(zt.a,{id:"url",type:"text",maxLength:"1024",className:"form-control",value:this.state.url,onChange:this.updateUrl,placeholder:{id:Object(Kt.b)("add_command.url.placeholder"),defaultMessage:"Must start with http:// or https://"}}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.url.help",defaultMessage:"The callback URL to receive the HTTP POST or GET event request when the slash command is run."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"method"},m.a.createElement(y.c,{id:"add_command.method",defaultMessage:"Request Method"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement("select",{id:"method",className:"form-control",value:this.state.method,onChange:this.updateMethod},m.a.createElement("option",{value:yi},v.ab("add_command.method.post","POST")),m.a.createElement("option",{value:"G"},v.ab("add_command.method.get","GET"))),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.method.help",defaultMessage:"The type of command request issued to the Request URL."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},m.a.createElement(y.c,{id:"add_command.username",defaultMessage:"Response Username"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(zt.a,{id:"username",type:"text",maxLength:"64",className:"form-control",value:this.state.username,onChange:this.updateUsername,placeholder:{id:Object(Kt.b)("add_command.username.placeholder"),defaultMessage:"Username"}}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.username.help",defaultMessage:'(Optional) Choose a username override for responses for this slash command. Usernames can consist of up to 22 characters consisting of lowercase letters, numbers and they symbols "-", "_", and "." .'})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconUrl"},m.a.createElement(y.c,{id:"add_command.iconUrl",defaultMessage:"Response Icon"})),m.a.createElement("div",{className:"col-md-5 col-sm-8"},m.a.createElement(zt.a,{id:"iconUrl",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconUrl,onChange:this.updateIconUrl,placeholder:{id:Object(Kt.b)("add_command.iconUrl.placeholder"),defaultMessage:"https://www.example.com/myicon.png"}}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.iconUrl.help",defaultMessage:"(Optional) Choose a profile picture override for the post responses to this slash command. Enter the URL of a .png or .jpg file at least 128 pixels by 128 pixels."})))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocomplete"},m.a.createElement(y.c,{id:"add_command.autocomplete",defaultMessage:"Autocomplete"})),m.a.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},m.a.createElement("input",{id:"autocomplete",type:"checkbox",checked:this.state.autocomplete,onChange:this.updateAutocomplete}),m.a.createElement("div",{className:"form__help"},m.a.createElement(y.c,{id:"add_command.autocomplete.help",defaultMessage:"(Optional) Show slash command in autocomplete list."})))),e,t,m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(Oe.a,{type:"backstage",errors:[this.props.serverError,this.state.clientError]}),m.a.createElement(_.a,{className:"btn btn-link btn-sm",to:"/"+this.props.team.name+"/integrations/commands"},m.a.createElement(y.c,{id:"add_command.cancel",defaultMessage:"Cancel"})),m.a.createElement(ke.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,spinningText:v.ab(this.props.loading.id,this.props.loading.defaultMessage),onClick:this.handleSubmit,id:"saveCommand"},m.a.createElement(y.c,{id:this.props.footer.id,defaultMessage:this.props.footer.defaultMessage})),this.props.renderExtra))))}}])&&di(n.prototype,a),r&&di(n,r),t}();function _i(e){return(_i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ei(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function ki(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ji(e,t){return(ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Si(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}gi(vi,"propTypes",{team:d.a.object.isRequired,header:d.a.object.isRequired,footer:d.a.object.isRequired,loading:d.a.object.isRequired,renderExtra:d.a.node.isRequired,serverError:d.a.string.isRequired,initialCommand:d.a.object,action:d.a.func.isRequired});var Ci={id:Object(Kt.b)("integrations.add"),defaultMessage:"Add"},Ni={id:Object(Kt.b)("add_command.save"),defaultMessage:"Save"},Pi={id:Object(Kt.b)("add_command.saving"),defaultMessage:"Saving..."},Mi=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Oi(t).call(this,e),n=!r||"object"!==_i(r)&&"function"!=typeof r?wi(a):r,Si(wi(n),"addCommand",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var a,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.addCommand(t);case 3:if(a=e.sent,r=a.data,o=a.error,!r){e.next=9;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/commands/confirm?type=commands&id=").concat(r.id)),e.abrupt("return");case 9:o&&n.setState({serverError:o.message});case 10:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Ei(o,a,r,i,s,"next",e)}function s(e){Ei(o,a,r,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}()),n.state={serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"render",value:function(){return m.a.createElement(vi,{team:this.props.team,header:Ci,footer:Ni,loading:Pi,renderExtra:"",action:this.addCommand,serverError:this.state.serverError})}}])&&ki(n.prototype,a),r&&ki(n,r),t}();Si(Mi,"propTypes",{team:d.a.object,actions:d.a.shape({addCommand:d.a.func.isRequired}).isRequired});var Ti=Object(a.connect)(null,function(e){return{actions:Object(f.bindActionCreators)({addCommand:Cn.addCommand},e)}})(Mi);function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ai(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function xi(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function i(e){Ai(o,a,r,i,s,"next",e)}function s(e){Ai(o,a,r,i,s,"throw",e)}i(void 0)})}}function Ii(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qi(e){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ui(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Di(e,t){return(Di=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hi={id:Object(Kt.b)("integrations.edit"),defaultMessage:"Edit"},Wi={id:Object(Kt.b)("edit_command.update"),defaultMessage:"Update"},Bi={id:Object(Kt.b)("edit_command.updating"),defaultMessage:"Updating..."},Fi=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=qi(t).call(this,e),n=!r||"object"!==Ri(r)&&"function"!=typeof r?Ui(a):r,Li(Ui(n),"editCommand",function(){var e=xi(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.newCommand=t,n.state.originalCommand.id&&(t.id=n.state.originalCommand.id),n.state.originalCommand.url===n.newCommand.url&&n.state.originalCommand.trigger===n.newCommand.trigger&&n.state.originalCommand.method===n.newCommand.method){e.next=6;break}n.handleConfirmModal(),e.next=8;break;case 6:return e.next=8,n.submitCommand();case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Li(Ui(n),"handleConfirmModal",function(){n.setState({showConfirmModal:!0})}),Li(Ui(n),"confirmModalDismissed",function(){n.setState({showConfirmModal:!1})}),Li(Ui(n),"submitCommand",xi(regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({serverError:""}),e.next=3,n.props.actions.editCommand(n.newCommand);case 3:if(t=e.sent,a=t.data,r=t.error,!a){e.next=9;break}return pe.a.push("/".concat(n.props.team.name,"/integrations/commands")),e.abrupt("return");case 9:n.setState({showConfirmModal:!1}),r&&n.setState({serverError:r.message});case 11:case"end":return e.stop()}},e)}))),Li(Ui(n),"renderExtra",function(){var e=m.a.createElement(y.c,{id:"update_command.update",defaultMessage:"Update"}),t=m.a.createElement(y.c,{id:"update_command.confirm",defaultMessage:"Edit Slash Command"}),a=m.a.createElement(y.c,{id:"update_command.question",defaultMessage:"Your changes may break the existing slash command. Are you sure you would like to update it?"});return m.a.createElement(L.a,{title:t,message:a,confirmButtonText:e,show:n.state.showConfirmModal,onConfirm:n.submitCommand,onCancel:n.confirmModalDismissed})}),n.state={originalCommand:null,showConfirmModal:!1,serverError:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Di(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.enableCommands&&this.props.actions.getCustomTeamCommands(this.props.team.id).then(function(){e.setState({originalCommand:Object.values(e.props.commands).filter(function(t){return t.id===e.props.commandId})[0]})})}},{key:"render",value:function(){return this.state.originalCommand?m.a.createElement(vi,{team:this.props.team,header:Hi,footer:Wi,loading:Bi,renderExtra:this.renderExtra(),action:this.editCommand,serverError:this.state.serverError,initialCommand:this.state.originalCommand}):m.a.createElement(E.a,null)}}])&&Ii(n.prototype,a),r&&Ii(n,r),t}();Li(Fi,"propTypes",{team:d.a.object.isRequired,commandId:d.a.string.isRequired,commands:d.a.object,actions:d.a.shape({getCustomTeamCommands:d.a.func.isRequired,editCommand:d.a.func.isRequired}).isRequired,enableCommands:d.a.bool});var Gi=Object(a.connect)(function(e,t){var n=Object(s.getConfig)(e),a=new URLSearchParams(t.location.search).get("id"),r="true"===n.EnableCommands;return{commandId:a,commands:Object(Pn.getCommands)(e),enableCommands:r}},function(e){return{actions:Object(f.bindActionCreators)({getCustomTeamCommands:Cn.getCustomTeamCommands,editCommand:Cn.editCommand},e)}})(Fi);n(120);function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zi(e){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ki(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ji(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qi(e,t,n){return t&&Ji(e.prototype,t),n&&Ji(e,n),e}function Vi(e,t){return(Vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xi=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=zi(t).call(this,e),n=!r||"object"!==Yi(r)&&"function"!=typeof r?Ki(a):r,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ki(n),"handleKeyPress",function(e){"Enter"===e.key&&pe.a.push("/"+n.props.team.name+"/integrations/"+n.state.type)}),n.state={type:new URLSearchParams(n.props.location.search).get("type"),id:new URLSearchParams(n.props.location.search).get("id")},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vi(e,t)}(t,m.a.Component),Qi(t,null,[{key:"propTypes",get:function(){return{team:d.a.object,location:d.a.object,commands:d.a.object,oauthApps:d.a.object,incomingHooks:d.a.object,outgoingHooks:d.a.object,bots:d.a.object}}}]),Qi(t,[{key:"componentDidMount",value:function(){window.addEventListener("keypress",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keypress",this.handleKeyPress)}},{key:"render",value:function(){var e=null,t=null,n=null,a=this.props.commands[this.state.id],r=this.props.incomingHooks[this.state.id],o=this.props.outgoingHooks[this.state.id],i=this.props.oauthApps[this.state.id],s=this.props.bots[this.state.id];if(this.state.type===U.i.Integrations.COMMAND&&a){var c=a.token;e=m.a.createElement(y.c,{id:"installed_commands.header",defaultMessage:"Slash Commands"}),t=m.a.createElement("p",null,m.a.createElement(D.b,{id:"add_command.doneHelp",defaultMessage:"Your slash command has been set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (see [documentation](!https://docs.mattermost.com/developer/slash-commands.html) for further details)."})),n=m.a.createElement("p",{className:"word-break--all"},m.a.createElement(D.b,{id:"add_command.token",defaultMessage:"**Token**: {token}",values:{token:c}}),m.a.createElement(Jn,{value:c}))}else if(this.state.type===U.i.Integrations.INCOMING_WEBHOOK&&r){var l=Object(Wn.e)()+"/hooks/"+r.id;e=m.a.createElement(y.c,{id:"installed_incoming_webhooks.header",defaultMessage:"Incoming Webhooks"}),t=m.a.createElement("p",null,m.a.createElement(D.b,{id:"add_incoming_webhook.doneHelp",defaultMessage:"Your incoming webhook has been set up. Please send data to the following URL (see [documentation](!https://docs.mattermost.com/developer/webhooks-incoming.html) for further details)."})),n=m.a.createElement("p",{className:"word-break--all"},m.a.createElement(D.b,{id:"add_incoming_webhook.url",defaultMessage:"**URL**: {url}",values:{url:"`"+l+"`"}}),m.a.createElement(Jn,{idMessage:"integrations.copy_client_secret",defaultMessage:"Copy Client Secret",value:l}))}else if(this.state.type===U.i.Integrations.OUTGOING_WEBHOOK&&o){var u=o.token;e=m.a.createElement(y.c,{id:"installed_outgoing_webhooks.header",defaultMessage:"Outgoing Webhooks"}),t=m.a.createElement("p",null,m.a.createElement(D.b,{id:"add_outgoing_webhook.doneHelp",defaultMessage:"Your outgoing webhook has been set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (see [documentation](!https://docs.mattermost.com/developer/webhooks-outgoing.html) for further details)."})),n=m.a.createElement("p",{className:"word-break--all"},m.a.createElement(D.b,{id:"add_outgoing_webhook.token",defaultMessage:"**Token**: {token}",values:{token:u}}),m.a.createElement(Jn,{value:u}))}else if(this.state.type===U.i.Integrations.OAUTH_APP&&i){var p=i.id,d=i.client_secret;e=m.a.createElement(y.c,{id:"installed_oauth_apps.header",defaultMessage:"OAuth 2.0 Applications"}),(t=[]).push(m.a.createElement("p",{key:"add_oauth_app.doneHelp"},m.a.createElement(D.b,{id:"add_oauth_app.doneHelp",defaultMessage:"Your OAuth 2.0 application has been set up. Please use the following Client ID and Client Secret when requesting authorization for your application (see [documentation](!https://docs.mattermost.com/developer/oauth-2-0-applications.html) for further details)."}))),t.push(m.a.createElement("p",{key:"add_oauth_app.clientId"},m.a.createElement(D.b,{id:"add_oauth_app.clientId",defaultMessage:"**Client ID**: {id}",values:{id:p}}),m.a.createElement(Jn,{idMessage:"integrations.copy_client_id",defaultMessage:"Copy Client Id",value:p}),m.a.createElement("br",null),m.a.createElement(D.b,{id:"add_oauth_app.clientSecret",defaultMessage:"**Client Secret**: {secret}",values:{secret:d}}),m.a.createElement(Jn,{idMessage:"integrations.copy_client_secret",defaultMessage:"Copy Client Secret",value:d}))),t.push(m.a.createElement("p",{key:"add_oauth_app.doneUrlHelp"},m.a.createElement(y.c,{id:"add_oauth_app.doneUrlHelp",defaultMessage:"The following are your authorized redirect URL(s)."}))),n=m.a.createElement("p",{className:"word-break--all"},m.a.createElement(D.b,{id:"add_oauth_app.url",defaultMessage:"**URL(s)**: {url}",values:{url:i.callback_urls}}))}else{if(this.state.type!==U.i.Integrations.BOT||!s)return pe.a.replace("/error?type=".concat(U.k.PAGE_NOT_FOUND)),"";var f=new URLSearchParams(this.props.location.search).get("token");e=m.a.createElement(y.c,{id:"bots.manage.header",defaultMessage:"Bot Accounts"}),t=m.a.createElement("p",null,m.a.createElement(D.b,{id:"bots.manage.created.text",defaultMessage:"Your bot account **{botname}** has been created successfully. Please use the following access token to connect to the bot (see [documentation](https://mattermost.com/pl/default-bot-accounts) for further details).",values:{botname:s.display_name||s.username}})),n=m.a.createElement("p",{className:"word-break--all"},m.a.createElement(D.b,{id:"add_outgoing_webhook.token",defaultMessage:"**Token**: {token}",values:{token:f}}),m.a.createElement(Jn,{value:f}),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement(D.b,{id:"add_outgoing_webhook.token.message",defaultMessage:"Make sure to add this bot account to teams and channels you want it to interact in. See [documentation](https://mattermost.com/pl/default-bot-accounts) to learn more."}))}return m.a.createElement("div",{className:"backstage-content row"},m.a.createElement(Ee,null,m.a.createElement(_.a,{to:"/"+this.props.team.name+"/integrations/"+this.state.type},e),m.a.createElement(y.c,{id:"integrations.add",defaultMessage:"Add"})),m.a.createElement("div",{className:"backstage-form backstage-form__confirmation"},m.a.createElement("h4",{className:"backstage-form__title",id:"formTitle"},m.a.createElement(y.c,{id:"integrations.successful",defaultMessage:"Setup Successful"})),t,n,m.a.createElement("div",{className:"backstage-form__footer"},m.a.createElement(_.a,{className:"btn btn-primary",type:"submit",to:"/"+this.props.team.name+"/integrations/"+this.state.type,id:"doneButton"},m.a.createElement(y.c,{id:"integrations.done",defaultMessage:"Done"})))))}}]),t}();var Zi=Object(a.connect)(function(e){return{commands:Object(Pn.getCommands)(e),oauthApps:Object(Pn.getOAuthApps)(e),incomingHooks:Object(Pn.getIncomingHooks)(e),outgoingHooks:Object(Pn.getOutgoingHooks)(e),bots:Object(h.getBotAccounts)(e)}})(Xi);function $i(e){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function es(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ts(e,t){return!t||"object"!==$i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ns(e){return(ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function as(e,t){return(as=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rs(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var os=function(e){var t=e.component,n=e.extraProps,a=rs(e,["component","extraProps"]);return m.a.createElement(r.b,Object.assign({},a,{render:function(e){return m.a.createElement(t,Object.assign({},n,e))}}))},is=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ts(this,ns(t).call(this,e))).state={loading:!0},n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&as(e,t)}(t,m.a.PureComponent),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.enableCommands&&this.props.actions.loadCommandsAndProfilesForTeam(this.props.team.id).then(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){var e=this,t={loading:this.state.loading,commands:this.props.commands||[],users:this.props.users,team:this.props.team,user:this.props.user};return m.a.createElement("div",null,m.a.createElement(r.d,null,m.a.createElement(r.b,{exact:!0,path:"".concat(this.props.match.url,"/"),render:function(){return m.a.createElement(r.a,{to:"".concat(e.props.match.url,"/installed")})}}),m.a.createElement(os,{extraProps:t,path:"".concat(this.props.match.url,"/installed"),component:mi}),m.a.createElement(os,{extraProps:t,path:"".concat(this.props.match.url,"/add"),component:Ti}),m.a.createElement(os,{extraProps:t,path:"".concat(this.props.match.url,"/edit"),component:Gi}),m.a.createElement(os,{extraProps:t,path:"".concat(this.props.match.url,"/confirm"),component:Zi})))}}])&&es(n.prototype,a),o&&es(n,o),t}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(is,"propTypes",{team:d.a.object,user:d.a.object,users:d.a.object,commands:d.a.array,match:d.a.shape({url:d.a.string.isRequired}).isRequired,actions:d.a.shape({loadCommandsAndProfilesForTeam:d.a.func.isRequired}).isRequired,enableCommands:d.a.bool});var ss=Object(a.connect)(function(e){var t="true"===Object(s.getConfig)(e).EnableCommands;return{commands:Object.values(Object(Pn.getCommands)(e)),users:Object(o.getUsers)(e),enableCommands:t}},function(e){return{actions:Object(f.bindActionCreators)({loadCommandsAndProfilesForTeam:Un},e)}})(is);function cs(e){return(cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ls(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function us(e,t){return!t||"object"!==cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ms(e){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ps(e,t){return(ps=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ds=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),us(this,ms(t).apply(this,arguments))}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ps(e,t)}(t,m.a.Component),n=t,o=[{key:"propTypes",get:function(){return{name:d.a.string.isRequired,title:d.a.node.isRequired,icon:d.a.string.isRequired,parentLink:d.a.string,children:d.a.arrayOf(d.a.element)}}},{key:"defaultProps",get:function(){return{parentLink:"",children:[]}}},{key:"contextTypes",get:function(){return{router:d.a.object.isRequired}}}],(a=[{key:"render",value:function(){var e=this.props,t=e.name,n=e.title,a=e.icon,o=e.parentLink,i=e.children,s=o+"/"+t;return m.a.createElement("li",{className:"backstage-sidebar__category"},m.a.createElement(_.b,{to:s,className:"category-title",activeClassName:"category-title--active"},m.a.createElement("i",{className:"fa "+a}),m.a.createElement("span",{className:"category-title__text"},n)),i&&i.length>0&&m.a.createElement(r.b,{path:s,render:function(){return m.a.createElement("ul",{className:"sections"},m.a.Children.map(i,function(e){return e?m.a.cloneElement(e,{parentLink:s}):e}))}}))}}])&&ls(n.prototype,a),o&&ls(n,o),t}();function fs(e){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hs(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function bs(e,t){return!t||"object"!==fs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gs(e){return(gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ys(e,t){return(ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),bs(this,gs(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(t,m.a.Component),n=t,r=[{key:"propTypes",get:function(){return{name:d.a.string.isRequired,title:d.a.node.isRequired,parentLink:d.a.string,subsection:d.a.bool,children:d.a.arrayOf(d.a.element),id:d.a.string}}},{key:"defaultProps",get:function(){return{parentLink:"",subsection:!1,children:[]}}},{key:"contextTypes",get:function(){return{router:d.a.object.isRequired}}}],(a=[{key:"getLink",value:function(){return this.props.parentLink+"/"+this.props.name}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.subsection,a=e.children,r=this.getLink(),o=null;a.length>0&&(o=m.a.createElement("ul",{className:"subsections"},m.a.Children.map(a,function(e){return m.a.cloneElement(e,{parentLink:r,subsection:!0})})));var i="section";return n&&(i="subsection"),m.a.createElement("li",{className:i,id:this.props.id},m.a.createElement(_.b,{className:"".concat(i,"-title"),activeClassName:"".concat(i,"-title--active"),to:r},m.a.createElement("span",{className:"".concat(i,"-title__text")},t)),o)}}])&&hs(n.prototype,a),r&&hs(n,r),t}();function _s(e){return(_s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Es(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ks(e,t){return!t||"object"!==_s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Os(e){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ws(e,t){return(ws=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var js=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ks(this,Os(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ws(e,t)}(t,m.a.Component),n=t,r=[{key:"propTypes",get:function(){return{team:d.a.object.isRequired,user:d.a.object.isRequired,enableCustomEmoji:d.a.bool.isRequired,enableIncomingWebhooks:d.a.bool.isRequired,enableOutgoingWebhooks:d.a.bool.isRequired,enableCommands:d.a.bool.isRequired,enableOAuthServiceProvider:d.a.bool.isRequired,canCreateOrDeleteCustomEmoji:d.a.bool.isRequired}}}],(a=[{key:"renderCustomEmoji",value:function(){return this.props.enableCustomEmoji&&this.props.canCreateOrDeleteCustomEmoji?m.a.createElement(ds,{name:"emoji",parentLink:"/"+this.props.team.name,icon:"fa-smile-o",title:m.a.createElement(y.c,{id:"backstage_sidebar.emoji",defaultMessage:"Custom Emoji"})}):null}},{key:"renderIntegrations",value:function(){var e=null;this.props.enableIncomingWebhooks&&(e=m.a.createElement(Qe.a,{permissions:[l.Permissions.MANAGE_INCOMING_WEBHOOKS],teamId:this.props.team.id},m.a.createElement(vs,{name:"incoming_webhooks",parentLink:"/"+this.props.team.name+"/integrations",title:m.a.createElement(y.c,{id:"backstage_sidebar.integrations.incoming_webhooks",defaultMessage:"Incoming Webhooks"}),id:"incomingWebhooks"})));var t=null;this.props.enableOutgoingWebhooks&&(t=m.a.createElement(Qe.a,{permissions:[l.Permissions.MANAGE_OUTGOING_WEBHOOKS],teamId:this.props.team.id},m.a.createElement(vs,{name:"outgoing_webhooks",parentLink:"/"+this.props.team.name+"/integrations",title:m.a.createElement(y.c,{id:"backstage_sidebar.integrations.outgoing_webhooks",defaultMessage:"Outgoing Webhooks"}),id:"outgoingWebhooks"})));var n=null;this.props.enableCommands&&(n=m.a.createElement(Qe.a,{permissions:[l.Permissions.MANAGE_SLASH_COMMANDS],teamId:this.props.team.id},m.a.createElement(vs,{name:"commands",parentLink:"/"+this.props.team.name+"/integrations",title:m.a.createElement(y.c,{id:"backstage_sidebar.integrations.commands",defaultMessage:"Slash Commands"}),id:"slashCommands"})));var a=null;this.props.enableOAuthServiceProvider&&(a=m.a.createElement(Je.a,{permissions:[l.Permissions.MANAGE_OAUTH]},m.a.createElement(vs,{name:"oauth2-apps",parentLink:"/"+this.props.team.name+"/integrations",title:m.a.createElement(y.c,{id:"backstage_sidebar.integrations.oauthApps",defaultMessage:"OAuth 2.0 Applications"}),id:"oauthApps"})));var r=m.a.createElement(Je.a,{permissions:["manage_bots"]},m.a.createElement(vs,{name:"bots",parentLink:"/"+this.props.team.name+"/integrations",title:m.a.createElement(y.c,{id:"backstage_sidebar.bots",defaultMessage:"Bot Accounts"}),id:"botAccounts"}));return m.a.createElement(Qe.a,{permissions:[l.Permissions.MANAGE_INCOMING_WEBHOOKS,l.Permissions.MANAGE_OUTGOING_WEBHOOKS,l.Permissions.MANAGE_SLASH_COMMANDS,l.Permissions.MANAGE_OAUTH],teamId:this.props.team.id},m.a.createElement(ds,{name:"integrations",icon:"fa-link",parentLink:"/"+this.props.team.name,title:m.a.createElement(y.c,{id:"backstage_sidebar.integrations",defaultMessage:"Integrations"})},e,t,n,a,r))}},{key:"render",value:function(){return m.a.createElement("div",{className:"backstage-sidebar"},m.a.createElement("ul",null,this.renderCustomEmoji(),this.renderIntegrations()))}}])&&Es(n.prototype,a),r&&Es(n,r),t}(),Ss=n(1600);function Cs(e){return(Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ns(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ps(e,t){return!t||"object"!==Cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ms(e){return(Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ts(e,t){return(Ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ps(this,Ms(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ts(e,t)}(t,m.a.Component),n=t,r=[{key:"propTypes",get:function(){return{team:d.a.object.isRequired,siteName:d.a.string}}}],(a=[{key:"render",value:function(){return this.props.team?m.a.createElement("div",{className:"backstage-navbar"},m.a.createElement(_.a,{className:"backstage-navbar__back",to:"/".concat(this.props.team.name)},m.a.createElement(Ss.a,null),m.a.createElement("span",null,m.a.createElement(y.c,{id:"backstage_navbar.backToMattermost",defaultMessage:"Back to {siteName}",values:{siteName:this.props.siteName}})))):null}}])&&Ns(n.prototype,a),r&&Ns(n,r),t}();function As(e){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xs(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Is(e){return(Is=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Us(e,t){return(Us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ds(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ls(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Hs=function(e){var t=e.component,n=e.extraProps,a=Ls(e,["component","extraProps"]);return m.a.createElement(r.b,Object.assign({},a,{render:function(e){return m.a.createElement(t,Object.assign({},n,e))}}))},Ws=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Is(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==As(r)&&"function"!=typeof r?qs(a):r,Ds(qs(n),"scrollToTop",function(){n.listRef&&(n.listRef.scrollTop=0)}),Ds(qs(n),"setListRef",function(e){n.listRef=e}),n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Us(e,t)}(t,m.a.Component),n=t,(a=[{key:"render",value:function(){if(null==this.props.team||null==this.props.user)return m.a.createElement("div",null);var e={team:this.props.team,user:this.props.user,scrollToTop:this.scrollToTop};return m.a.createElement("div",{className:"backstage"},m.a.createElement(De.a,null),m.a.createElement(Le.a,null),m.a.createElement(Rs,{team:this.props.team,siteName:this.props.siteName}),m.a.createElement(Ue.a,{pluggableName:"Root"}),m.a.createElement("div",{className:"backstage-body",ref:this.setListRef},m.a.createElement(js,{team:this.props.team,user:this.props.user,enableCustomEmoji:this.props.enableCustomEmoji,enableIncomingWebhooks:this.props.enableIncomingWebhooks,enableOutgoingWebhooks:this.props.enableOutgoingWebhooks,enableCommands:this.props.enableCommands,enableOAuthServiceProvider:this.props.enableOAuthServiceProvider,canCreateOrDeleteCustomEmoji:this.props.canCreateOrDeleteCustomEmoji}),m.a.createElement(r.d,null,m.a.createElement(Hs,{extraProps:e,exact:!0,path:"/:team/integrations",component:ct}),m.a.createElement(Hs,{extraProps:e,exact:!0,path:"".concat(this.props.match.url,"/incoming_webhooks"),component:ha}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/incoming_webhooks/add"),component:za}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/incoming_webhooks/edit"),component:or}),m.a.createElement(Hs,{extraProps:e,exact:!0,path:"".concat(this.props.match.url,"/outgoing_webhooks"),component:_r}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/outgoing_webhooks/add"),component:Lr}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/outgoing_webhooks/edit"),component:Zr}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/commands"),component:ss}),m.a.createElement(Hs,{extraProps:e,exact:!0,path:"".concat(this.props.match.url,"/oauth2-apps"),component:go}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/oauth2-apps/add"),component:qo}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/oauth2-apps/edit"),component:Qo}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/confirm"),component:Zi}),m.a.createElement(Hs,{extraProps:e,exact:!0,path:"/:team/emoji",component:bn}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/add"),component:Sn}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/bots/add"),component:qe}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/bots/edit"),component:qe}),m.a.createElement(Hs,{extraProps:e,path:"".concat(this.props.match.url,"/bots"),component:oe}))))}}])&&xs(n.prototype,a),o&&xs(n,o),t}();Ds(Ws,"propTypes",{user:d.a.object,team:d.a.object,match:d.a.shape({url:d.a.string.isRequired}).isRequired,siteName:d.a.string,enableCustomEmoji:d.a.bool.isRequired,enableIncomingWebhooks:d.a.bool.isRequired,enableOutgoingWebhooks:d.a.bool.isRequired,enableCommands:d.a.bool.isRequired,enableOAuthServiceProvider:d.a.bool.isRequired,canCreateOrDeleteCustomEmoji:d.a.bool.isRequired});t.default=Object(r.f)(Object(a.connect)(function(e){var t=Object(o.getCurrentUser)(e),n=Object(i.getCurrentTeam)(e),a=Object(s.getConfig)(e),r=a.SiteName,u="true"===a.EnableCustomEmoji,m="true"===a.EnableIncomingWebhooks,p="true"===a.EnableOutgoingWebhooks,d="true"===a.EnableCommands,f="true"===a.EnableOAuthServiceProvider,h=Object(c.haveISystemPermission)(e,{permission:l.Permissions.CREATE_EMOJIS})||Object(c.haveISystemPermission)(e,{permission:l.Permissions.DELETE_EMOJIS});if(!h){var b=!0,g=!1,y=void 0;try{for(var v,_=Object(i.getMyTeams)(e)[Symbol.iterator]();!(b=(v=_.next()).done);b=!0){var E=v.value;if(Object(c.haveITeamPermission)(e,{team:E.id,permission:l.Permissions.CREATE_EMOJIS})||Object(c.haveITeamPermission)(e,{team:E.id,permission:l.Permissions.DELETE_EMOJIS})){h=!0;break}}}catch(e){g=!0,y=e}finally{try{b||null==_.return||_.return()}finally{if(g)throw y}}}return{user:t,team:n,siteName:r,enableCustomEmoji:u,enableIncomingWebhooks:m,enableOutgoingWebhooks:p,enableCommands:d,enableOAuthServiceProvider:f,canCreateOrDeleteCustomEmoji:h}})(Ws))}}]);
//# sourceMappingURL=9.387e730620d6b12117af.js.map