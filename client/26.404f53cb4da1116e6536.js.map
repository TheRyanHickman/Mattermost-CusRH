{"version":3,"sources":["webpack:///./node_modules/mattermost-redux/actions/timezone.js","webpack:///./components/logged_in/logged_in.jsx","webpack:///./components/logged_in/index.js"],"names":["Object","defineProperty","exports","value","autoUpdateTimezone","deviceTimezone","fn","regeneratorRuntime","mark","_callee","dispatch","getState","currentUer","currentTimezone","newTimezoneExists","timezone","updatedUser","wrap","_context","prev","next","_users","getCurrentUser","_timezone","getUserTimezone","id","automaticTimezone","useAutomaticTimezone","manualTimezone","_objectSpread","_users2","updateMe","stop","_ref","self","this","args","arguments","Promise","resolve","reject","gen","apply","_next","asyncGeneratorStep","_throw","err","undefined","_x","_x2","__webpack_require__","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","target","i","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","obj","configurable","writable","arg","info","error","done","then","store","LoggedIn","props","_this","_classCallCheck","_getPrototypeOf","call","_assertThisInitialized","origin","_ref$data","data","type","_ref$data$message","message","userIsActive","manual","currentUser","window","location","WebSocketClient","userUpdateActiveStatus","root","document","getElementById","className","React","PureComponent","_this2","WebSocketActions","enableTimezone","actions","getBrowserTimezone","$","on","off","cookie","indexOf","viewChannel","currentChannelId","addEventListener","onFocusListener","onBlurListener","onDesktopMessageListener","UserAgent","addClass","attr","GlobalActions","encodeURIComponent","pathname","ev","removeClass","closest","find","e","which","is","preventDefault","removeEventListener","isValidState","react_default","a","createElement","loading_screen","mfaRequired","react_router","to","showTermsOfService","children","PropTypes","string","bool","isRequired","shape","func","connect","state","ownProps","license","getLicense","config","getConfig","shouldShowTermsOfService","getCurrentChannelId","checkIfMFARequired","match","url","ExperimentalTimezone","bindActionCreators"],"mappings":"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","file":"26.404f53cb4da1116e6536.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.autoUpdateTimezone = autoUpdateTimezone;\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _users = require(\"../selectors/entities/users\");\n\nvar _timezone = require(\"../selectors/entities/timezone\");\n\nvar _users2 = require(\"./users\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction autoUpdateTimezone(deviceTimezone\n/*: string*/\n) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(dispatch\n      /*: DispatchFunc*/\n      , getState\n      /*: GetStateFunc*/\n      ) {\n        var currentUer, currentTimezone, newTimezoneExists, timezone, updatedUser;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                currentUer = (0, _users.getCurrentUser)(getState());\n                currentTimezone = (0, _timezone.getUserTimezone)(getState(), currentUer.id);\n                newTimezoneExists = currentTimezone.automaticTimezone !== deviceTimezone;\n\n                if (currentTimezone.useAutomaticTimezone && newTimezoneExists) {\n                  timezone = {\n                    useAutomaticTimezone: 'true',\n                    automaticTimezone: deviceTimezone,\n                    manualTimezone: currentTimezone.manualTimezone\n                  };\n                  updatedUser = _objectSpread({}, currentUer, {\n                    timezone: timezone\n                  });\n                  (0, _users2.updateMe)(updatedUser)(dispatch, getState);\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Redirect} from 'react-router';\nimport {viewChannel} from 'mattermost-redux/actions/channels';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport * as WebSocketActions from 'actions/websocket_actions.jsx';\nimport * as UserAgent from 'utils/user_agent.jsx';\nimport LoadingScreen from 'components/loading_screen.jsx';\nimport {getBrowserTimezone} from 'utils/timezone.jsx';\nimport store from 'stores/redux_store.jsx';\nimport WebSocketClient from 'client/web_websocket_client.jsx';\n\nconst dispatch = store.dispatch;\nconst getState = store.getState;\n\nconst BACKSPACE_CHAR = 8;\n\nexport default class LoggedIn extends React.PureComponent {\n    static propTypes = {\n        currentUser: PropTypes.object,\n        currentChannelId: PropTypes.string,\n        children: PropTypes.object,\n        mfaRequired: PropTypes.bool.isRequired,\n        enableTimezone: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            autoUpdateTimezone: PropTypes.func.isRequired,\n        }).isRequired,\n        showTermsOfService: PropTypes.bool.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        const root = document.getElementById('root');\n        if (root) {\n            root.className += ' channel-view';\n        }\n    }\n\n    isValidState() {\n        return this.props.currentUser != null;\n    }\n\n    componentDidMount() {\n        // Initialize websocket\n        WebSocketActions.initialize();\n\n        if (this.props.enableTimezone) {\n            this.props.actions.autoUpdateTimezone(getBrowserTimezone());\n        }\n\n        // Make sure the websockets close and reset version\n        $(window).on('beforeunload',\n            () => {\n                // Turn off to prevent getting stuck in a loop\n                $(window).off('beforeunload');\n                if (document.cookie.indexOf('MMUSERID=') > -1) {\n                    viewChannel('', this.props.currentChannelId || '')(dispatch, getState);\n                }\n                WebSocketActions.close();\n            }\n        );\n\n        // Listen for focused tab/window state\n        window.addEventListener('focus', this.onFocusListener);\n        window.addEventListener('blur', this.onBlurListener);\n\n        // Listen for messages from the desktop app\n        window.addEventListener('message', this.onDesktopMessageListener);\n\n        // Because current CSS requires the root tag to have specific stuff\n\n        // Device tracking setup\n        if (UserAgent.isIos()) {\n            $('body').addClass('ios');\n        } else if (UserAgent.isAndroid()) {\n            $('body').addClass('android');\n        }\n\n        if (!this.props.currentUser) {\n            $('#root').attr('class', '');\n            GlobalActions.emitUserLoggedOutEvent('/login?redirect_to=' + encodeURIComponent(this.props.location.pathname), true, false);\n        }\n\n        $('body').on('mouseenter mouseleave', ':not(.post-list__dynamic) .post', function mouseOver(ev) {\n            if (ev.type === 'mouseenter') {\n                $(this).prev('.date-separator, .new-separator').addClass('hovered--after');\n                $(this).next('.date-separator, .new-separator').addClass('hovered--before');\n            } else {\n                $(this).prev('.date-separator, .new-separator').removeClass('hovered--after');\n                $(this).next('.date-separator, .new-separator').removeClass('hovered--before');\n            }\n        });\n\n        $('body').on('mouseenter mouseleave', '.search-item__container .post', function mouseOver(ev) {\n            if (ev.type === 'mouseenter') {\n                $(this).closest('.search-item__container').find('.date-separator').addClass('hovered--after');\n                $(this).closest('.search-item__container').next('div').find('.date-separator').addClass('hovered--before');\n            } else {\n                $(this).closest('.search-item__container').find('.date-separator').removeClass('hovered--after');\n                $(this).closest('.search-item__container').next('div').find('.date-separator').removeClass('hovered--before');\n            }\n        });\n\n        $('body').on('mouseenter mouseleave', ':not(.post-list__dynamic) .post.post--comment.same--root', function mouseOver(ev) {\n            if (ev.type === 'mouseenter') {\n                $(this).prev('.date-separator, .new-separator').addClass('hovered--comment');\n                $(this).next('.date-separator, .new-separator').addClass('hovered--comment');\n            } else {\n                $(this).prev('.date-separator, .new-separator').removeClass('hovered--comment');\n                $(this).next('.date-separator, .new-separator').removeClass('hovered--comment');\n            }\n        });\n\n        // Prevent backspace from navigating back a page\n        $(window).on('keydown.preventBackspace', (e) => {\n            if (e.which === BACKSPACE_CHAR && !$(e.target).is('input, textarea')) {\n                e.preventDefault();\n            }\n        });\n    }\n\n    componentWillUnmount() {\n        WebSocketActions.close();\n\n        $('body').off('click.userpopover');\n        $('body').off('mouseenter mouseleave', '.post');\n        $('body').off('mouseenter mouseleave', '.post.post--comment.same--root');\n\n        $('.modal').off('show.bs.modal');\n\n        $(window).off('keydown.preventBackspace');\n\n        window.removeEventListener('focus', this.onFocusListener);\n        window.removeEventListener('blur', this.onBlurListener);\n        window.removeEventListener('message', this.onDesktopMessageListener);\n    }\n\n    render() {\n        if (!this.isValidState()) {\n            return <LoadingScreen/>;\n        }\n\n        if (this.props.mfaRequired) {\n            if (this.props.location.pathname !== '/mfa/setup') {\n                return <Redirect to={'/mfa/setup'}/>;\n            }\n        } else if (this.props.location.pathname === '/mfa/confirm') {\n            // Nothing to do. Wait for MFA flow to complete before prompting TOS.\n        } else if (this.props.showTermsOfService) {\n            if (this.props.location.pathname !== '/terms_of_service') {\n                return <Redirect to={'/terms_of_service?redirect_to=' + encodeURIComponent(this.props.location.pathname)}/>;\n            }\n        }\n\n        return this.props.children;\n    }\n\n    onFocusListener() {\n        GlobalActions.emitBrowserFocus(true);\n    }\n\n    onBlurListener() {\n        GlobalActions.emitBrowserFocus(false);\n    }\n\n    onDesktopMessageListener = ({origin, data: {type, message: {userIsActive, manual} = {}} = {}} = {}) => {\n        if (!this.props.currentUser) {\n            return;\n        }\n        if (origin !== window.location.origin) {\n            return;\n        }\n\n        switch (type) {\n        case 'user-activity-update':\n            // update the server with the users current away status\n            if (userIsActive === true || userIsActive === false) {\n                WebSocketClient.userUpdateActiveStatus(userIsActive, manual);\n            }\n            break;\n        }\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {autoUpdateTimezone} from 'mattermost-redux/actions/timezone';\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentUser, shouldShowTermsOfService} from 'mattermost-redux/selectors/entities/users';\n\nimport {checkIfMFARequired} from 'utils/route';\n\nimport LoggedIn from './logged_in.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const license = getLicense(state);\n    const config = getConfig(state);\n    const showTermsOfService = shouldShowTermsOfService(state);\n\n    return {\n        currentUser: getCurrentUser(state),\n        currentChannelId: getCurrentChannelId(state),\n        mfaRequired: checkIfMFARequired(getCurrentUser(state), license, config, ownProps.match.url),\n        enableTimezone: config.ExperimentalTimezone === 'true',\n        showTermsOfService,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            autoUpdateTimezone,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LoggedIn);\n"],"sourceRoot":""}