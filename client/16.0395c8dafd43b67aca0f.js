(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1719:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r}),a.d(t,"c",function(){return o});var n=a(40),s=a(12);function i(e){return function(t,a){var i=Object(s.getCurrentUserId)(a());return t(n.updateUserMfa(i,!0,e))}}function r(){return function(e,t){var a=Object(s.getCurrentUserId)(t());return e(n.updateUserMfa(a,!1))}}function o(){return function(e,t){var a=Object(s.getCurrentUserId)(t());return e(n.generateMfaSecret(a))}}},1736:function(e,t,a){"use strict";var n=a(418),s=a(20),i=a(40),r=a(12),o=a(16),c=(a(88),a(43),a(211),a(120),a(30)),l=a.n(c),u=a(7),d=a.n(u),m=a(56),p=a(23),f=a(57);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y,S,_,O=Object(m.g)({sessionRevoked:{id:Object(f.b)("audit_table.sessionRevoked"),defaultMessage:"The session with id {sessionId} was revoked"},channelCreated:{id:Object(f.b)("audit_table.channelCreated"),defaultMessage:"Created the {channelName} channel"},establishedDM:{id:Object(f.b)("audit_table.establishedDM"),defaultMessage:"Established a direct message channel with {username}"},nameUpdated:{id:Object(f.b)("audit_table.nameUpdated"),defaultMessage:"Updated the {channelName} channel name"},headerUpdated:{id:Object(f.b)("audit_table.headerUpdated"),defaultMessage:"Updated the {channelName} channel header"},channelDeleted:{id:Object(f.b)("audit_table.channelDeleted"),defaultMessage:"Archived the channel with the URL {url}"},userAdded:{id:Object(f.b)("audit_table.userAdded"),defaultMessage:"Added {username} to the {channelName} channel"},userRemoved:{id:Object(f.b)("audit_table.userRemoved"),defaultMessage:"Removed {username} to the {channelName} channel"},attemptedRegisterApp:{id:Object(f.b)("audit_table.attemptedRegisterApp"),defaultMessage:"Attempted to register a new OAuth Application with ID {id}"},attemptedAllowOAuthAccess:{id:Object(f.b)("audit_table.attemptedAllowOAuthAccess"),defaultMessage:"Attempted to allow a new OAuth service access"},successfullOAuthAccess:{id:Object(f.b)("audit_table.successfullOAuthAccess"),defaultMessage:"Successfully gave a new OAuth service access"},failedOAuthAccess:{id:Object(f.b)("audit_table.failedOAuthAccess"),defaultMessage:"Failed to allow a new OAuth service access - the redirect URI did not match the previously registered callback"},attemptedOAuthToken:{id:Object(f.b)("audit_table.attemptedOAuthToken"),defaultMessage:"Attempted to get an OAuth access token"},successfullOAuthToken:{id:Object(f.b)("audit_table.successfullOAuthToken"),defaultMessage:"Successfully added a new OAuth service"},oauthTokenFailed:{id:Object(f.b)("audit_table.oauthTokenFailed"),defaultMessage:"Failed to get an OAuth access token - {token}"},attemptedLogin:{id:Object(f.b)("audit_table.attemptedLogin"),defaultMessage:"Attempted to login"},authenticated:{id:Object(f.b)("audit_table.authenticated"),defauleMessage:"Successfully authenticated"},successfullLogin:{id:Object(f.b)("audit_table.successfullLogin"),defaultMessage:"Successfully logged in"},failedLogin:{id:Object(f.b)("audit_table.failedLogin"),defaultMessage:"FAILED login attempt"},updatePicture:{id:Object(f.b)("audit_table.updatePicture"),defaultMessage:"Updated your profile picture"},updateGeneral:{id:Object(f.b)("audit_table.updateGeneral"),defaultMessage:"Updated the general settings of your account"},attemptedPassword:{id:Object(f.b)("audit_table.attemptedPassword"),defaultMessage:"Attempted to change password"},successfullPassword:{id:Object(f.b)("audit_table.successfullPassword"),defaultMessage:"Successfully changed password"},failedPassword:{id:Object(f.b)("audit_table.failedPassword"),defaultMessage:"Failed to change password - tried to update user password who was logged in through OAuth"},updatedRol:{id:Object(f.b)("audit_table.updatedRol"),defaultMessage:"Updated user role(s) to "},member:{id:Object(f.b)("audit_table.member"),defaultMessage:"member"},accountActive:{id:Object(f.b)("audit_table.accountActive"),defaultMessage:"Account activated"},accountInactive:{id:Object(f.b)("audit_table.accountInactive"),defaultMessage:"Account deactivated"},by:{id:Object(f.b)("audit_table.by"),defaultMessage:" by {username}"},byAdmin:{id:Object(f.b)("audit_table.byAdmin"),defaultMessage:" by an admin"},sentEmail:{id:Object(f.b)("audit_table.sentEmail"),defaultMessage:"Sent an email to {email} to reset your password"},attemptedReset:{id:Object(f.b)("audit_table.attemptedReset"),defaultMessage:"Attempted to reset password"},successfullReset:{id:Object(f.b)("audit_table.successfullReset"),defaultMessage:"Successfully reset password"},updateGlobalNotifications:{id:Object(f.b)("audit_table.updateGlobalNotifications"),defaultMessage:"Updated your global notification settings"},attemptedWebhookCreate:{id:Object(f.b)("audit_table.attemptedWebhookCreate"),defaultMessage:"Attempted to create a webhook"},succcessfullWebhookCreate:{id:Object(f.b)("audit_table.successfullWebhookCreate"),defaultMessage:"Successfully created a webhook"},failedWebhookCreate:{id:Object(f.b)("audit_table.failedWebhookCreate"),defaultMessage:"Failed to create a webhook - bad channel permissions"},attemptedWebhookDelete:{id:Object(f.b)("audit_table.attemptedWebhookDelete"),defaultMessage:"Attempted to delete a webhook"},successfullWebhookDelete:{id:Object(f.b)("audit_table.successfullWebhookDelete"),defaultMessage:"Successfully deleted a webhook"},failedWebhookDelete:{id:Object(f.b)("audit_table.failedWebhookDelete"),defaultMessage:"Failed to delete a webhook - inappropriate conditions"},logout:{id:Object(f.b)("audit_table.logout"),defaultMessage:"Logged out of your account"},verified:{id:Object(f.b)("audit_table.verified"),defaultMessage:"Successfully verified your email address"},revokedAll:{id:Object(f.b)("audit_table.revokedAll"),defaultMessage:"Revoked all current sessions for the team"},loginAttempt:{id:Object(f.b)("audit_table.loginAttempt"),defaultMessage:" (Login attempt)"},loginFailure:{id:Object(f.b)("audit_table.loginFailure"),defaultMessage:" (Login failure)"},attemptedLicenseAdd:{id:Object(f.b)("audit_table.attemptedLicenseAdd"),defaultMessage:"Attempted to add new license"},successfullLicenseAdd:{id:Object(f.b)("audit_table.successfullLicenseAdd"),defaultMessage:"Successfully added new license"},failedExpiredLicenseAdd:{id:Object(f.b)("audit_table.failedExpiredLicenseAdd"),defaultMessage:"Failed to add a new license as it has either expired or not yet been started"},failedInvalidLicenseAdd:{id:Object(f.b)("audit_table.failedInvalidLicenseAdd"),defaultMessage:"Failed to add an invalid license"},licenseRemoved:{id:Object(f.b)("audit_table.licenseRemoved"),defaultMessage:"Successfully removed a license"}}),w=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,v(t).apply(this,arguments))}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,d.a.PureComponent),a=t,(n=[{key:"componentDidMount",value:function(){var e=this.props.audits.map(function(e){return e.user_id});this.props.actions.getMissingProfilesByIds(e)}},{key:"render",value:function(){for(var e,t,a,n=this.props.audits,s=this.props.showUserId,i=this.props.showIp,r=this.props.showSession,o=[],c=0;c<n.length;c++){var l=n[c],u=this.formatAuditInfo(l),p=void 0;s&&(p=d.a.createElement("td",{className:"word-break--all"},u.userId));var f=void 0;i&&(f=d.a.createElement("td",{className:"whitespace--nowrap word-break--all"},u.ip));var g=void 0;r&&(g=d.a.createElement("td",{className:"whitespace--nowrap word-break--all"},u.sessionId));var h="";-1!==u.desc.toLowerCase().indexOf("fail")&&(h=" color--error"),o[c]=d.a.createElement("tr",{key:l.id},d.a.createElement("td",{className:"whitespace--nowrap word-break--all"},u.timestamp),p,d.a.createElement("td",{className:"word-break--all"+h},u.desc),f,g)}return s&&(e=d.a.createElement("th",null,d.a.createElement(m.c,{id:"audit_table.userId",defaultMessage:"User ID"}))),i&&(t=d.a.createElement("th",null,d.a.createElement(m.c,{id:"audit_table.ip",defaultMessage:"IP Address"}))),r&&(a=d.a.createElement("th",null,d.a.createElement(m.c,{id:"audit_table.session",defaultMessage:"Session ID"}))),d.a.createElement("table",{className:"table"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,d.a.createElement(m.c,{id:"audit_table.timestamp",defaultMessage:"Timestamp"})),e,d.a.createElement("th",null,d.a.createElement(m.c,{id:"audit_table.action",defaultMessage:"Action"})),t,a)),d.a.createElement("tbody",null,o))}},{key:"formatAuditInfo",value:function(e){var t=this.props.intl.formatMessage,a=e.action.replace(/\/api\/v[1-9]/,""),n="";if(0===a.indexOf("/channels")){var s,i=e.extra_info.split(" "),r=i[0].split("="),o="",c="";switch(r.indexOf("name")>=0&&(o=r[r.indexOf("name")+1],c=(s=this.props.getByName(o))?s.display_name:o),a){case"/channels/create":n=t(O.channelCreated,{channelName:c});break;case"/channels/create_direct":n=t(O.establishedDM,{username:Object(p.u)(s.id).username});break;case"/channels/update":n=t(O.nameUpdated,{channelName:c});break;case"/channels/update_desc":case"/channels/update_header":n=t(O.headerUpdated,{channelName:c});break;default:var l=[],u="",f="";if(i[1]&&(l=i[1].split("=")).indexOf("user_id")>=0){u=l[l.indexOf("user_id")+1];var g=this.props.getUser(u);g&&(f=g.username)}/\/channels\/[A-Za-z0-9]+\/delete/.test(a)?n=t(O.channelDeleted,{url:o}):/\/channels\/[A-Za-z0-9]+\/add/.test(a)?n=t(O.userAdded,{username:f,channelName:c}):/\/channels\/[A-Za-z0-9]+\/remove/.test(a)&&(n=t(O.userRemoved,{username:f,channelName:c}))}}else if(0===a.indexOf("/oauth")){var h=e.extra_info.split(" ");switch(a){case"/oauth/register":var b=h[0].split("=");"client_id"===b[0]&&(n=t(O.attemptedRegisterApp,{id:b[1]}));break;case"/oauth/allow":"attempt"===h[0]?n=t(O.attemptedAllowOAuthAccess):"success"===h[0]?n=t(O.successfullOAuthAccess):"fail - redirect_uri did not match registered callback"===h[0]&&(n=t(O.failedOAuthAccess));break;case"/oauth/access_token":if("attempt"===h[0])n=t(O.attemptedOAuthToken);else if("success"===h[0])n=t(O.successfullOAuthToken);else{var v=h[0].split("-");"fail"===v[0].trim()&&v[1]&&(n=t(v,{token:v[1].trim()}))}}}else if(0===a.indexOf("/users")){var E=e.extra_info.split(" ");switch(a){case"/users/login":"attempt"===E[0]?n=t(O.attemptedLogin):"success"===E[0]?n=t(O.successfullLogin):"authenticated"===E[0]?n=t(O.authenticated):E[0]&&(n=t(O.failedLogin));break;case"/users/revoke_session":n=t(O.sessionRevoked,{sessionId:E[0].split("=")[1]});break;case"/users/newimage":n=t(O.updatePicture);break;case"/users/update":n=t(O.updateGeneral);break;case"/users/newpassword":"attempted"===E[0]?n=t(O.attemptedPassword):"completed"===E[0]?n=t(O.successfullPassword):"failed - tried to update user password who was logged in through oauth"===E[0]&&(n=t(O.failedPassword));break;case"/users/update_roles":var y=E[0].split("=")[1];n=t(O.updatedRol),y.trim()?n+=y:n+=t(O.member);break;case"/users/update_active":var S=E[0].split("=")[0],_=E[0].split("=")[1];if("active"===S){"true"===_?n=t(O.accountActive):"false"===_&&(n=t(O.accountInactive));var w=E[1].split("=");if("session_user"===w[0]){var k=this.props.getUser(w[1]),M=this.props.currentUser;M&&k&&Object(p.W)(M.roles)?n+=t(O.by,{username:k.username}):M&&k&&(n+=t(O.byAdmin))}}else"session_id"===S&&(n=t(O.sessionRevoked,{sessionId:_}));break;case"/users/send_password_reset":n=t(O.sentEmail,{email:E[0].split("=")[1]});break;case"/users/reset_password":"attempt"===E[0]?n=t(O.attemptedReset):"success"===E[0]&&(n=t(O.successfullReset));break;case"/users/update_notify":n=t(O.updateGlobalNotifications)}}else if(0===a.indexOf("/hooks")){var N=e.extra_info;switch(a){case"/hooks/incoming/create":"attempt"===N?n=t(O.attemptedWebhookCreate):"success"===N?n=t(O.succcessfullWebhookCreate):"fail - bad channel permissions"===N&&(n=t(O.failedWebhookCreate));break;case"/hooks/incoming/delete":"attempt"===N?n=t(O.attemptedWebhookDelete):"success"===N?n=t(O.successfullWebhookDelete):"fail - inappropriate conditions"===N&&(n=t(O.failedWebhookDelete))}}else if(0===a.indexOf("/license")){var C=e.extra_info;switch(a){case"/license/add":"attempt"===C?n=t(O.attemptedLicenseAdd):"success"===C?n=t(O.successfullLicenseAdd):"failed - expired or non-started license"===C?n=t(O.failedExpiredLicenseAdd):"failed - invalid license"===C&&(n=t(O.failedInvalidLicenseAdd));break;case"/license/remove":n=t(O.licenseRemoved)}}else if(0===a.indexOf("/admin/download_compliance_report"))n=Object(p.kb)(e.extra_info);else switch(a){case"/logout":n=t(O.logout);break;case"/verify_email":n=t(O.verified)}if(!n)if(e.extra_info.indexOf("revoked_all=")>=0)n=t(O.revokedAll);else{var T="";a&&-1!==a.lastIndexOf("/")&&(T=a.substring(a.lastIndexOf("/")+1).replace("_"," "),T=Object(p.kb)(T));var A="";e.extra_info&&-1!==(A=e.extra_info).indexOf("=")&&(A=A.substring(A.indexOf("=")+1)),n=T+" "+A}var P=new Date(e.create_at),j={};j.timestamp=d.a.createElement("div",null,d.a.createElement("div",null,d.a.createElement(m.a,{value:P,day:"2-digit",month:"short",year:"numeric"})),d.a.createElement("div",null,d.a.createElement(m.d,{value:P,hour:"2-digit",minute:"2-digit"})));var R=this.props.getUser(e.user_id);return j.userId=R?R.email:e.user_id,j.desc=n,j.ip=e.ip_address,j.sessionId=e.session_id,j}}])&&h(a.prototype,n),s&&h(a,s),t}();y=w,S="propTypes",_={intl:m.i.isRequired,audits:l.a.array.isRequired,showUserId:l.a.bool,showIp:l.a.bool,showSession:l.a.bool,currentUser:l.a.object.isRequired,getUser:l.a.func.isRequired,getByName:l.a.func.isRequired,actions:l.a.shape({getMissingProfilesByIds:l.a.func.isRequired}).isRequired},S in y?Object.defineProperty(y,S,{value:_,enumerable:!0,configurable:!0,writable:!0}):y[S]=_;var k=Object(m.h)(w);t.a=Object(n.connect)(function(e){return{currentUser:Object(r.getCurrentUser)(e),getUser:function(t){return Object(r.getUser)(e,t)},getByName:function(t){return Object(o.getChannelByName)(e,t)}}},function(e){return{actions:Object(s.bindActionCreators)({getMissingProfilesByIds:i.getMissingProfilesByIds},e)}})(k)},2356:function(e,t,a){"use strict";a.r(t);var n=a(418),s=a(12),i=(a(88),a(43),a(30)),r=a.n(i),o=a(7),c=a.n(o),l=a(20),u=a(24),d=a(35),m=a(133),p=a(40),f=a(0),g=(a(116),a(117),a(74),a(33),a(34),a(25),a(44),a(56)),h=a(1493),b=a(23),v=a(1508),E=a(1519),y=a(1498),S=a(1600),_=a(14);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var T=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=k(t).call(this,e),a=!s||"object"!==O(s)&&"function"!=typeof s?M(n):s,C(M(a),"handleOnChange",function(e){var t=e.currentTarget.value;a.setState({joinLeaveState:t})}),C(M(a),"handleUpdateSection",function(e){e||a.setState({joinLeaveState:a.props.joinLeave}),a.props.onUpdateSection(e)}),C(M(a),"handleSubmit",function(){var e=a.props,t=e.actions,n=e.currentUserId,s=e.onUpdateSection,i={category:_.Preferences.CATEGORY_ADVANCED_SETTINGS,user_id:n,name:_.Preferences.ADVANCED_FILTER_JOIN_LEAVE,value:a.state.joinLeaveState};t.savePreferences(n,[i]),s()}),a.state={joinLeaveState:e.joinLeave},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"render",value:function(){var e=this.state.joinLeaveState;return this.props.activeSection===f.f.JOIN_LEAVE?c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),inputs:[c.a.createElement("fieldset",{key:"joinLeaveSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"joinLeaveOn",type:"radio",value:"true",name:f.f.JOIN_LEAVE,checked:"true"===e,onChange:this.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.advance.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"joinLeaveOff",type:"radio",value:"false",name:f.f.JOIN_LEAVE,checked:"false"===e,onChange:this.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.advance.joinLeaveDesc",defaultMessage:'When "On", System Messages saying a user has joined or left a channel will be visible. When "Off", the System Messages about joining or leaving a channel will be hidden. A message will still show up when you are added to a channel, so you can receive a notification.'})))],setting:f.f.JOIN_LEAVE,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),describe:this.props.renderOnOffLabel(e),section:f.f.JOIN_LEAVE,updateSection:this.handleUpdateSection})}}])&&w(a.prototype,n),s&&w(a,s),t}();C(T,"propTypes",{activeSection:r.a.string,currentUserId:r.a.string.isRequired,joinLeave:r.a.string,onUpdateSection:r.a.func.isRequired,renderOnOffLabel:r.a.func.isRequired,actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired});var A=Object(n.connect)(function(e){var t=Object(d.get)(e,_.Preferences.CATEGORY_ADVANCED_SETTINGS,_.Preferences.ADVANCED_FILTER_JOIN_LEAVE,"true");return{currentUserId:Object(s.getCurrentUserId)(e),joinLeave:t}},function(e){return{actions:Object(l.bindActionCreators)({savePreferences:m.savePreferences},e)}})(T);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function R(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){j(i,n,s,r,o,"next",e)}function o(e){j(i,n,s,r,o,"throw",e)}r(void 0)})}}function I(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var F=f.Q.PRE_RELEASE_FEATURES,z=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=L(t).call(this,e),a=!s||"object"!==P(s)&&"function"!=typeof s?D(n):s,U(D(a),"getStateFromProps",function(){var e=a.props.advancedSettingsCategory,t={send_on_ctrl_enter:a.props.sendOnCtrlEnter,code_block_ctrl_enter:a.props.codeBlockOnCtrlEnter,formatting:a.props.formatting,join_leave:a.props.joinLeave},n=Object.keys(F),s=0,i=!0,r=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)for(var u=c.value,d=0,m=n;d<m.length;d++){var p=m[d],g=F[p];u.name===f.Q.FeatureTogglePrefix+g.label&&(t[u.name]=u.value,"true"===u.value&&(s+=1))}}catch(e){r=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw o}}var h=a.props.enablePreviewFeatures;return{preReleaseFeatures:F,settings:t,preReleaseFeaturesKeys:n,enabledFeatures:s,isSaving:!1,previewFeaturesEnabled:h,showDeactivateAccountModal:!1}}),U(D(a),"updateSetting",function(e,t){var n=a.state.settings;n[e]=t,a.setState(n)}),U(D(a),"toggleFeature",function(e,t){var n=a.state.settings;n[f.Q.FeatureTogglePrefix+e]=String(t);var s=0;Object.keys(a.state.settings).forEach(function(e){0===e.lastIndexOf(f.Q.FeatureTogglePrefix)&&"true"===a.state.settings[e]&&s++}),a.setState({settings:n,enabledFeatures:s})}),U(D(a),"saveEnabledFeatures",function(){var e=[];Object.keys(a.state.settings).forEach(function(t){0===t.lastIndexOf(f.Q.FeatureTogglePrefix)&&e.push(t)}),a.handleSubmit(e)}),U(D(a),"handleSubmit",function(){var e=R(regeneratorRuntime.mark(function e(t){var n,s,i,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],s=a.props,i=s.actions,r=s.currentUser,o=r.id,(Array.isArray(t)?t:[t]).forEach(function(e){n.push({user_id:o,category:f.Q.Preferences.CATEGORY_ADVANCED_SETTINGS,name:e,value:a.state.settings[e]})}),a.setState({isSaving:!0}),e.next=7,i.savePreferences(o,n);case 7:a.handleUpdateSection("");case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),U(D(a),"handleDeactivateAccountSubmit",R(regeneratorRuntime.mark(function e(){var t,n,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.currentUser.id,a.setState({isSaving:!0}),a.props.actions.updateUserActive(t,!1).then(function(e){var t=e.error;t&&a.setState({serverError:t.message})}),e.next=5,a.props.actions.revokeAllSessionsForUser(t);case 5:n=e.sent,s=n.data,i=n.error,s?Object(h.e)():i&&a.setState({serverError:i.message});case 9:case"end":return e.stop()}},e)}))),U(D(a),"handleShowDeactivateAccountModal",function(){a.setState({showDeactivateAccountModal:!0})}),U(D(a),"handleHideDeactivateAccountModal",function(){a.setState({showDeactivateAccountModal:!1})}),U(D(a),"handleUpdateSection",function(e){e||a.setState(a.getStateFromProps()),a.setState({isSaving:!1}),a.props.updateSection(e)}),U(D(a),"renderFormattingSection",function(){return"formatting"===a.props.activeSection?c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),inputs:[c.a.createElement("fieldset",{key:"formattingSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"postFormattingOn",type:"radio",name:"formatting",checked:"false"!==a.state.settings.formatting,onChange:a.updateSetting.bind(D(a),"formatting","true")}),c.a.createElement(g.c,{id:"user.settings.advance.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"postFormattingOff",type:"radio",name:"formatting",checked:"false"===a.state.settings.formatting,onChange:a.updateSetting.bind(D(a),"formatting","false")}),c.a.createElement(g.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.advance.formattingDesc",defaultMessage:"If enabled, posts will be formatted to create links, show emoji, style the text, and add line breaks. By default, this setting is enabled."})))],setting:"formatting",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.handleUpdateSection}):c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),describe:a.renderOnOffLabel(a.state.settings.formatting),section:"formatting",updateSection:a.handleUpdateSection})}),a.state=a.getStateFromProps(),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"renderOnOffLabel",value:function(e){return"false"===e?c.a.createElement(g.c,{id:"user.settings.advance.off",defaultMessage:"Off"}):c.a.createElement(g.c,{id:"user.settings.advance.on",defaultMessage:"On"})}},{key:"renderCtrlEnterLabel",value:function(){var e=this.state.settings.send_on_ctrl_enter,t=this.state.settings.code_block_ctrl_enter;return"false"===e&&"false"===t?c.a.createElement(g.c,{id:"user.settings.advance.off",defaultMessage:"Off"}):"true"===e&&"true"===t?c.a.createElement(g.c,{id:"user.settings.advance.onForAllMessages",defaultMessage:"On for all messages"}):c.a.createElement(g.c,{id:"user.settings.advance.onForCode",defaultMessage:"On only for code blocks starting with ```"})}},{key:"renderFeatureLabel",value:function(e){switch(e){case"MARKDOWN_PREVIEW":return c.a.createElement(g.c,{id:"user.settings.advance.markdown_preview",defaultMessage:"Show markdown preview option in message input box"});default:return null}}},{key:"render",value:function(){var e,t=this,a=this.state.serverError||null;if("advancedCtrlSend"===this.props.activeSection){var n=["true"===this.state.settings.send_on_ctrl_enter,"false"===this.state.settings.send_on_ctrl_enter&&"true"===this.state.settings.code_block_ctrl_enter,"false"===this.state.settings.send_on_ctrl_enter&&"false"===this.state.settings.code_block_ctrl_enter],s=[c.a.createElement("div",{key:"ctrlSendSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"ctrlSendOn",type:"radio",name:"sendOnCtrlEnter",checked:n[0],onChange:function(){t.updateSetting("send_on_ctrl_enter","true"),t.updateSetting("code_block_ctrl_enter","true")}}),c.a.createElement(g.c,{id:"user.settings.advance.onForAllMessages",defaultMessage:"On for all messages"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"ctrlSendOnForCode",type:"radio",name:"sendOnCtrlEnter",checked:n[1],onChange:function(){t.updateSetting("send_on_ctrl_enter","false"),t.updateSetting("code_block_ctrl_enter","true")}}),c.a.createElement(g.c,{id:"user.settings.advance.onForCode",defaultMessage:"On only for code blocks starting with ```"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"ctrlSendOff",type:"radio",name:"sendOnCtrlEnter",checked:n[2],onChange:function(){t.updateSetting("send_on_ctrl_enter","false"),t.updateSetting("code_block_ctrl_enter","false")}}),c.a.createElement(g.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(g.c,{id:"user.settings.advance.sendDesc",defaultMessage:"When enabled, CTRL + ENTER will send the message and ENTER inserts a new line."})))];e=c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.sendTitle",defaultMessage:"Send messages on CTRL+ENTER"}),inputs:s,submit:this.handleSubmit.bind(this,["send_on_ctrl_enter","code_block_ctrl_enter"]),saving:this.state.isSaving,server_error:a,updateSection:this.handleUpdateSection})}else e=c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.sendTitle",defaultMessage:"Send messages on CTRL+ENTER"}),describe:this.renderCtrlEnterLabel(),section:"advancedCtrlSend",updateSection:this.handleUpdateSection});var i,r,o=this.renderFormattingSection(),l=null;if(o&&(l=c.a.createElement("div",{className:"divider-light"})),this.state.previewFeaturesEnabled&&this.state.preReleaseFeaturesKeys.length>0)if(r=c.a.createElement("div",{className:"divider-light"}),"advancedPreviewFeatures"===this.props.activeSection){var u=[];this.state.preReleaseFeaturesKeys.forEach(function(e){var a=t.state.preReleaseFeatures[e];u.push(c.a.createElement("div",{key:"advancedPreviewFeatures_"+a.label},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"advancedPreviewFeatures"+a.label,type:"checkbox",checked:"true"===t.state.settings[f.Q.FeatureTogglePrefix+a.label],onChange:function(e){t.toggleFeature(a.label,e.target.checked)}}),t.renderFeatureLabel(e)))))}),u.push(c.a.createElement("div",{key:"advancedPreviewFeatures_helptext"},c.a.createElement("br",null),c.a.createElement(g.c,{id:"user.settings.advance.preReleaseDesc",defaultMessage:"Check any pre-released features you'd like to preview.  You may also need to refresh the page before the setting will take effect."}))),i=c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.preReleaseTitle",defaultMessage:"Preview pre-release features"}),inputs:u,submit:this.saveEnabledFeatures,saving:this.state.isSaving,server_error:a,updateSection:this.handleUpdateSection})}else i=c.a.createElement(E.a,{title:b.ab("user.settings.advance.preReleaseTitle","Preview pre-release features"),describe:c.a.createElement(g.c,{id:"user.settings.advance.enabledFeatures",defaultMessage:"{count, number} {count, plural, one {Feature} other {Features}} Enabled",values:{count:this.state.enabledFeatures}}),section:"advancedPreviewFeatures",updateSection:this.handleUpdateSection});var d="",m="";if(""===this.props.currentUser.auth_service&&this.props.enableUserDeactivation){d="deactivateAccount"===this.props.activeSection?c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),inputs:[c.a.createElement("div",{key:"formattingSetting"},c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(g.c,{id:"user.settings.advance.deactivateDesc",defaultMessage:"Deactivating your account removes your ability to log in to this server and disables all email and mobile notifications. To reactivate your account, contact your System Administrator."})))],saveButtonText:"Deactivate",setting:"deactivateAccount",submit:this.handleShowDeactivateAccountModal,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),describe:c.a.createElement(g.c,{id:"user.settings.advance.deactivateDescShort",defaultMessage:"Click 'Edit' to deactivate your account"}),section:"deactivateAccount",updateSection:this.handleUpdateSection});var p=c.a.createElement(g.c,{id:"user.settings.advance.deactivate_member_modal.deactivateButton",defaultMessage:"Yes, deactivate my account"});m=c.a.createElement(y.a,{show:this.state.showDeactivateAccountModal,title:c.a.createElement(g.c,{id:"user.settings.advance.confirmDeactivateAccountTitle",defaultMessage:"Confirm Deactivation"}),message:c.a.createElement(g.c,{id:"user.settings.advance.confirmDeactivateDesc",defaultMessage:"Are you sure you want to deactivate your account? This can only be reversed by your System Administrator."}),confirmButtonClass:"btn btn-danger",confirmButtonText:p,onConfirm:this.handleDeactivateAccountSubmit,onCancel:this.handleHideDeactivateAccountModal})}return c.a.createElement("div",null,c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("span",{onClick:this.props.collapseModal},c.a.createElement(S.a,null))),c.a.createElement(g.c,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{className:"tab-header"},c.a.createElement(g.c,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"})),c.a.createElement("div",{className:"divider-dark first"}),e,l,o,c.a.createElement("div",{className:"divider-light"}),c.a.createElement(A,{activeSection:this.props.activeSection,onUpdateSection:this.handleUpdateSection,renderOnOffLabel:this.renderOnOffLabel}),r,i,l,d,c.a.createElement("div",{className:"divider-dark"}),m))}}])&&I(a.prototype,n),s&&I(a,s),t}();U(z,"propTypes",{currentUser:r.a.object.isRequired,advancedSettingsCategory:r.a.array.isRequired,sendOnCtrlEnter:r.a.string.isRequired,codeBlockOnCtrlEnter:r.a.bool,formatting:r.a.string.isRequired,joinLeave:r.a.string.isRequired,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,enablePreviewFeatures:r.a.bool,enableUserDeactivation:r.a.bool,actions:r.a.shape({savePreferences:r.a.func.isRequired,updateUserActive:r.a.func.isRequired,revokeAllSessionsForUser:r.a.func.isRequired}).isRequired});var q=Object(n.connect)(function(){var e=Object(d.makeGetCategory)();return function(t){var a=Object(u.getConfig)(t),n="true"===a.EnablePreviewFeatures,i="true"===a.EnableUserDeactivation;return{advancedSettingsCategory:e(t,f.z.CATEGORY_ADVANCED_SETTINGS),sendOnCtrlEnter:Object(d.get)(t,f.z.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter","false"),codeBlockOnCtrlEnter:Object(d.get)(t,f.z.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter","true"),formatting:Object(d.get)(t,f.z.CATEGORY_ADVANCED_SETTINGS,"formatting","true"),joinLeave:Object(d.get)(t,f.z.CATEGORY_ADVANCED_SETTINGS,"join_leave","true"),currentUser:Object(s.getCurrentUser)(t),enablePreviewFeatures:n,enableUserDeactivation:i}}},function(e){return{actions:Object(l.bindActionCreators)({savePreferences:m.savePreferences,updateUserActive:p.updateUserActive,revokeAllSessionsForUser:p.revokeAllSessionsForUser},e)}})(z),G=a(946),B=a(1701),H=a(316),V=a(314),Y=a(321),W=a(319),K=a(57),Q=a(31),J=(a(245),a(183)),X=a.n(J),Z=a(419),$=a.n(Z),ee=a(1679),te=a(1767),ae=a(1763),ne=(a(2102),a(38)),se=a(1798);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var de=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=oe(t).call(this,e),a=!s||"object"!==ie(s)&&"function"!=typeof s?ce(n):s,ue(ce(a),"checkClick",function(e){var t=$.a.findDOMNode(a.colorPicker);t&&t.contains(e.target)||a.setState({isOpened:!1})}),ue(ce(a),"togglePicker",function(){a.setState({isOpened:!a.state.isOpened})}),ue(ce(a),"handleChange",function(e){var t=e.hex,n=a.props.onChange;n&&n(t)}),ue(ce(a),"getColorPicker",function(e){a.colorPicker=e}),a.state={idOpened:!1},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,c.a.Component),a=t,(n=[{key:"componentDidUpdate",value:function(e,t){var a=t.isOpened,n=this.state.isOpened;n!==a&&(n?document.addEventListener("click",this.checkClick):document.removeEventListener("click",this.checkClick))}},{key:"render",value:function(){var e=this.props.color,t=this.state.isOpened;return c.a.createElement("div",{className:"color-input input-group"},c.a.createElement("input",{className:"form-control",type:"text",value:e,readOnly:!0}),c.a.createElement("span",{className:"input-group-addon",onClick:this.togglePicker},c.a.createElement("i",{className:"color-icon",style:{backgroundColor:e}})),t&&c.a.createElement("div",{ref:this.getColorPicker,className:"color-popover"},c.a.createElement(se.ChromePicker,{color:e,onChange:this.handleChange})))}}])&&re(a.prototype,n),s&&re(a,s),t}();ue(de,"propTypes",{color:r.a.string.isRequired,onChange:r.a.func});var me=de;function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ee=function(e){function t(){var e,a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=this,s=(e=ge(t)).call.apply(e,[this].concat(r)),a=!s||"object"!==pe(s)&&"function"!=typeof s?he(n):s,ve(he(a),"handleChange",function(e){var t=a.props,n=t.id,s=t.onChange;s&&s(n,e)}),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,c.a.Component),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.label,a=e.color;return c.a.createElement("div",null,c.a.createElement("label",{className:"custom-label"},t),c.a.createElement(me,{color:a,onChange:this.handleChange}))}}])&&fe(a.prototype,n),s&&fe(a,s),t}();ve(Ee,"propTypes",{id:r.a.string.isRequired,label:r.a.string.isRequired,color:r.a.string.isRequired,onChange:r.a.func});var ye=Ee;function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Ne(e,t,a[t])})}return e}function Oe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ce=Object(g.g)({sidebarBg:{id:Object(K.b)("user.settings.custom_theme.sidebarBg"),defaultMessage:"Sidebar BG"},sidebarText:{id:Object(K.b)("user.settings.custom_theme.sidebarText"),defaultMessage:"Sidebar Text"},sidebarHeaderBg:{id:Object(K.b)("user.settings.custom_theme.sidebarHeaderBg"),defaultMessage:"Sidebar Header BG"},sidebarHeaderTextColor:{id:Object(K.b)("user.settings.custom_theme.sidebarHeaderTextColor"),defaultMessage:"Sidebar Header Text"},sidebarUnreadText:{id:Object(K.b)("user.settings.custom_theme.sidebarUnreadText"),defaultMessage:"Sidebar Unread Text"},sidebarTextHoverBg:{id:Object(K.b)("user.settings.custom_theme.sidebarTextHoverBg"),defaultMessage:"Sidebar Text Hover BG"},sidebarTextActiveBorder:{id:Object(K.b)("user.settings.custom_theme.sidebarTextActiveBorder"),defaultMessage:"Sidebar Text Active Border"},sidebarTextActiveColor:{id:Object(K.b)("user.settings.custom_theme.sidebarTextActiveColor"),defaultMessage:"Sidebar Text Active Color"},onlineIndicator:{id:Object(K.b)("user.settings.custom_theme.onlineIndicator"),defaultMessage:"Online Indicator"},awayIndicator:{id:Object(K.b)("user.settings.custom_theme.awayIndicator"),defaultMessage:"Away Indicator"},dndIndicator:{id:Object(K.b)("user.settings.custom_theme.dndIndicator"),defaultMessage:"Do Not Disturb Indicator"},mentionBg:{id:Object(K.b)("user.settings.custom_theme.mentionBg"),defaultMessage:"Mention Jewel BG"},mentionColor:{id:Object(K.b)("user.settings.custom_theme.mentionColor"),defaultMessage:"Mention Jewel Text"},centerChannelBg:{id:Object(K.b)("user.settings.custom_theme.centerChannelBg"),defaultMessage:"Center Channel BG"},centerChannelColor:{id:Object(K.b)("user.settings.custom_theme.centerChannelColor"),defaultMessage:"Center Channel Text"},newMessageSeparator:{id:Object(K.b)("user.settings.custom_theme.newMessageSeparator"),defaultMessage:"New Message Separator"},linkColor:{id:Object(K.b)("user.settings.custom_theme.linkColor"),defaultMessage:"Link Color"},buttonBg:{id:Object(K.b)("user.settings.custom_theme.buttonBg"),defaultMessage:"Button BG"},buttonColor:{id:Object(K.b)("user.settings.custom_theme.buttonColor"),defaultMessage:"Button Text"},errorTextColor:{id:Object(K.b)("user.settings.custom_theme.errorTextColor"),defaultMessage:"Error Text Color"},mentionHighlightBg:{id:Object(K.b)("user.settings.custom_theme.mentionHighlightBg"),defaultMessage:"Mention Highlight BG"},mentionHighlightLink:{id:Object(K.b)("user.settings.custom_theme.mentionHighlightLink"),defaultMessage:"Mention Highlight Link"},codeTheme:{id:Object(K.b)("user.settings.custom_theme.codeTheme"),defaultMessage:"Code Theme"}}),Te=function(e){function t(e){var a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=we(t).call(this,e),a=!s||"object"!==Se(s)&&"function"!=typeof s?ke(n):s,Ne(ke(a),"handleColorChange",function(e,t){var n=a.props,s=n.updateTheme,i=n.theme;if(i[e]!==t){var r=_e({},i,Ne({type:"custom"},e,t));"mentionBg"===e&&(r.mentionBj=t),s(r);var o=a.setCopyTheme(r);a.setState({copyTheme:o})}}),Ne(ke(a),"pasteBoxChange",function(e){var t="";if(0!==(t=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.clipboardData.getData("Text")).length){var n;try{n=JSON.parse(t)}catch(e){return}a.setState({copyTheme:JSON.stringify(n)}),n.type="custom",a.props.updateTheme(n)}}),Ne(ke(a),"onChangeHandle",function(e){e.stopPropagation()}),Ne(ke(a),"selectTheme",function(){var e=a.refs.textarea;e.focus(),e.setSelectionRange(0,a.state.copyTheme.length)}),Ne(ke(a),"toggleSidebarStyles",function(e){e.preventDefault(),X()(a.refs.sidebarStylesHeader).toggleClass("open"),a.toggleSection(a.refs.sidebarStyles)}),Ne(ke(a),"toggleCenterChannelStyles",function(e){e.preventDefault(),X()(a.refs.centerChannelStylesHeader).toggleClass("open"),a.toggleSection(a.refs.centerChannelStyles)}),Ne(ke(a),"toggleLinkAndButtonStyles",function(e){e.preventDefault(),X()(a.refs.linkAndButtonStylesHeader).toggleClass("open"),a.toggleSection(a.refs.linkAndButtonStyles)}),Ne(ke(a),"onCodeThemeChange",function(e){var t=_e({},a.props.theme,{type:"custom",codeTheme:e.target.value});a.props.updateTheme(t)});var i=a.setCopyTheme(a.props.theme);return a.state={copyTheme:i},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,c.a.Component),a=t,(n=[{key:"componentDidMount",value:function(){X()(".group--code").on("change",this.onCodeThemeChange)}},{key:"componentWillUnmount",value:function(){X()(".group--code").off("change",this.onCodeThemeChange)}},{key:"setCopyTheme",value:function(e){var t=Object.assign({},e);return delete t.type,delete t.image,JSON.stringify(t)}},{key:"toggleSection",value:function(e){ne.g()?X()(e).toggleClass("open"):X()(e).slideToggle()}},{key:"render",value:function(){var e=this,t=this.context.intl.formatMessage,a=this.props.theme,n=[],s=[],i=[];f.Q.THEME_ELEMENTS.forEach(function(r,o){if("codeTheme"===r.id){var l=[],u="";r.themes.forEach(function(e,t){e.id===a[r.id]&&(u=e.iconURL),l.push(c.a.createElement("option",{key:"code-theme-key"+t,value:e.id},e.uiName))});var d=c.a.createElement(te.a,{bsStyle:"info",id:"code-popover",className:"code-popover"},c.a.createElement("img",{width:"200",alt:"code theme image",src:u}));s.push(c.a.createElement("div",{className:"col-sm-6 form-group",key:"custom-theme-key"+o},c.a.createElement("label",{className:"custom-label"},t(Ce[r.id])),c.a.createElement("div",{className:"input-group theme-group group--code dropdown",id:r.id},c.a.createElement("select",{id:"codeThemeSelect",className:"form-control",type:"text",defaultValue:a[r.id]},l),c.a.createElement(ae.a,{placement:"top",overlay:d,ref:"headerOverlay"},c.a.createElement("span",{className:"input-group-addon"},c.a.createElement("img",{alt:"code theme image",src:u}))))))}else if("centerChannelElements"===r.group)s.push(c.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+o},c.a.createElement(ye,{id:r.id,label:t(Ce[r.id]),color:a[r.id],onChange:e.handleColorChange})));else if("sidebarElements"===r.group){var m=a[r.id];m||"mentionBg"!==r.id||(m=a.mentionBj),n.push(c.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+o},c.a.createElement(ye,{id:r.id,label:t(Ce[r.id]),color:m,onChange:e.handleColorChange})))}else i.push(c.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+o},c.a.createElement(ye,{id:r.id,label:t(Ce[r.id]),color:a[r.id],onChange:e.handleColorChange})))});var r=c.a.createElement("div",{className:"col-sm-12"},c.a.createElement("label",{className:"custom-label"},c.a.createElement(g.c,{id:"user.settings.custom_theme.copyPaste",defaultMessage:"Copy and paste to share theme colors:"})),c.a.createElement("textarea",{ref:"textarea",className:"form-control",id:"pasteBox",value:this.state.copyTheme,onPaste:this.pasteBoxChange,onChange:this.onChangeHandle,onClick:this.selectTheme}));return c.a.createElement("div",{className:"appearance-section padding-top"},c.a.createElement("div",{className:"theme-elements row"},c.a.createElement("div",{ref:"sidebarStylesHeader",className:"theme-elements__header",onClick:this.toggleSidebarStyles},c.a.createElement(g.c,{id:"user.settings.custom_theme.sidebarTitle",defaultMessage:"Sidebar Styles"}),c.a.createElement("div",{className:"header__icon"},c.a.createElement("i",{className:"fa fa-plus",title:t({id:"generic_icons.expand",defaultMessage:"Expand Icon"})}),c.a.createElement("i",{className:"fa fa-minus",title:t({id:"generic_icons.collapse",defaultMessage:"Collapse Icon"})}))),c.a.createElement("div",{ref:"sidebarStyles",className:"theme-elements__body"},n)),c.a.createElement("div",{id:"centerChannelStyles",className:"theme-elements row"},c.a.createElement("div",{ref:"centerChannelStylesHeader",className:"theme-elements__header",onClick:this.toggleCenterChannelStyles},c.a.createElement(g.c,{id:"user.settings.custom_theme.centerChannelTitle",defaultMessage:"Center Channel Styles"}),c.a.createElement("div",{className:"header__icon"},c.a.createElement("i",{className:"fa fa-plus",title:t({id:"generic_icons.expand",defaultMessage:"Expand Icon"})}),c.a.createElement("i",{className:"fa fa-minus",title:t({id:"generic_icons.collapse",defaultMessage:"Collapse Icon"})}))),c.a.createElement("div",{ref:"centerChannelStyles",className:"theme-elements__body"},s)),c.a.createElement("div",{className:"theme-elements row"},c.a.createElement("div",{ref:"linkAndButtonStylesHeader",className:"theme-elements__header",onClick:this.toggleLinkAndButtonStyles},c.a.createElement(g.c,{id:"user.settings.custom_theme.linkButtonTitle",defaultMessage:"Link and Button Styles"}),c.a.createElement("div",{className:"header__icon"},c.a.createElement("i",{className:"fa fa-plus",title:t({id:"generic_icons.expand",defaultMessage:"Expand Icon"})}),c.a.createElement("i",{className:"fa fa-minus",title:t({id:"generic_icons.collapse",defaultMessage:"Collapse Icon"})}))),c.a.createElement("div",{ref:"linkAndButtonStyles",className:"theme-elements__body"},i)),c.a.createElement("div",{className:"row margin-top x2"},r))}}])&&Oe(a.prototype,n),s&&Oe(a,s),t}();Ne(Te,"propTypes",{theme:r.a.object.isRequired,updateTheme:r.a.func.isRequired}),Ne(Te,"contextTypes",{intl:g.i.isRequired});a(211),a(120);function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function je(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Le=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),je(this,Re(t).apply(this,arguments))}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,c.a.Component),a=t,(n=[{key:"render",value:function(){var e=this,t=this.props.theme,a=[],n=this.props.allowedThemes,s=n.length>1||n[0]&&n[0].trim().length>0;for(var i in f.Q.THEMES){if(f.Q.THEMES.hasOwnProperty(i))if("continue"===function(){if(s&&n.indexOf(i)<0)return"continue";var r=X.a.extend(!0,{},f.Q.THEMES[i]),o="";r.type===t.type&&(o="active"),a.push(c.a.createElement("div",{className:"col-xs-6 col-sm-3 premade-themes",key:"premade-theme-key"+i},c.a.createElement("div",{id:"premadeTheme".concat(r.type.replace(" ","")),className:o,onClick:function(){return e.props.updateTheme(r)}},c.a.createElement("label",null,c.a.createElement("img",{alt:"premade theme "+i,className:"img-responsive",src:r.image}),c.a.createElement("div",{className:"theme-label"},b.kb(r.type))))))}())continue}return c.a.createElement("div",{className:"row appearance-section"},c.a.createElement("div",{className:"clearfix"},a))}}])&&Pe(a.prototype,n),s&&Pe(a,s),t}();Le.propTypes={theme:r.a.object.isRequired,updateTheme:r.a.func.isRequired,allowedThemes:r.a.arrayOf(r.a.string)},Le.defaultProps={allowedThemes:[]};var De=Object(n.connect)(function(e){var t=Object(u.getConfig)(e);return{allowedThemes:t.AllowedThemes&&t.AllowedThemes.split(",")||[]}})(Le);function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Ve(e,t,a[t])})}return e}function Fe(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function ze(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){Fe(i,n,s,r,o,"next",e)}function o(e){Fe(i,n,s,r,o,"throw",e)}r(void 0)})}}function qe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ye=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=Ge(t).call(this,e),a=!s||"object"!==xe(s)&&"function"!=typeof s?Be(n):s,Ve(Be(a),"submitTheme",ze(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.applyToAllTeams?"":a.props.currentTeamId,a.setState({isSaving:!0}),e.next=4,a.props.actions.saveTheme(t,a.state.theme);case 4:if(!a.state.applyToAllTeams){e.next=7;break}return e.next=7,a.props.actions.deleteTeamSpecificThemes();case 7:a.props.setRequireConfirm(!1),a.originalTheme=Object.assign({},a.state.theme),a.scrollToTop(),a.props.updateSection(""),a.setState({isSaving:!1});case 12:case"end":return e.stop()}},e)}))),Ve(Be(a),"updateTheme",function(e){var t=a.state.theme.length===e.length;if(!t)for(var n in e)if(e.hasOwnProperty(n)&&a.state.theme[n]!==e[n]){t=!0;break}a.props.setRequireConfirm(t),a.setState({theme:e}),b.b(e)}),Ve(Be(a),"resetFields",function(){var e=a.getStateFromProps();e.serverError=null,a.setState(e),a.scrollToTop(),b.b(e.theme),a.props.setRequireConfirm(!1)}),Ve(Be(a),"handleImportModal",function(){ee.a.handleViewAction({type:f.e.TOGGLE_IMPORT_THEME_MODAL,value:!0,callback:a.updateTheme}),a.props.setEnforceFocus(!1)}),Ve(Be(a),"handleUpdateSection",function(e){a.props.updateSection(e)}),a.state=Ue({},a.getStateFromProps(e),{isSaving:!1}),a.originalTheme=Object.assign({},a.state.theme),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(t,c.a.Component),a=t,(n=[{key:"componentDidMount",value:function(){this.props.selected&&X()($.a.findDOMNode(this.refs[this.state.theme])).addClass("active-border")}},{key:"componentDidUpdate",value:function(){this.props.selected&&(X()(".color-btn").removeClass("active-border"),X()($.a.findDOMNode(this.refs[this.state.theme])).addClass("active-border"))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.selected&&!e.selected&&this.resetFields()}},{key:"componentWillUnmount",value:function(){this.props.selected&&b.b(this.props.theme)}},{key:"getStateFromProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=Ue({},e.theme);return t.codeTheme||(t.codeTheme=f.i.DEFAULT_CODE_THEME),{theme:t,type:t.type||"premade",showAllTeamsCheckbox:e.showAllTeamsCheckbox,applyToAllTeams:e.applyToAllTeams}}},{key:"scrollToTop",value:function(){X()(".ps-container.modal-body").scrollTop(0)}},{key:"updateType",value:function(e){this.setState({type:e})}},{key:"render",value:function(){var e,t=this;this.state.serverError&&(e=this.state.serverError);var a,n,s,i="custom"===this.state.type;if(i&&this.props.allowCustomThemes?a=c.a.createElement("div",{key:"customThemeChooser"},c.a.createElement(Te,{theme:this.state.theme,updateTheme:this.updateTheme})):n=c.a.createElement("div",{key:"premadeThemeChooser"},c.a.createElement("br",null),c.a.createElement(De,{theme:this.state.theme,updateTheme:this.updateTheme})),this.props.selected){var r=[];this.props.allowCustomThemes&&r.push(c.a.createElement("div",{className:"radio",key:"premadeThemeColorLabel"},c.a.createElement("label",null,c.a.createElement("input",{id:"standardThemes",type:"radio",name:"theme",checked:!i,onChange:this.updateType.bind(this,"premade")}),c.a.createElement(g.c,{id:"user.settings.display.theme.themeColors",defaultMessage:"Theme Colors"})),c.a.createElement("br",null))),r.push(n),this.props.allowCustomThemes&&(r.push(c.a.createElement("div",{className:"radio",key:"customThemeColorLabel"},c.a.createElement("label",null,c.a.createElement("input",{id:"customThemes",type:"radio",name:"theme",checked:i,onChange:this.updateType.bind(this,"custom")}),c.a.createElement(g.c,{id:"user.settings.display.theme.customTheme",defaultMessage:"Custom Theme"})))),r.push(a),r.push(c.a.createElement("div",{key:"otherThemes"},c.a.createElement("br",null),c.a.createElement("a",{id:"otherThemes",href:"http://docs.mattermost.com/help/settings/theme-colors.html#custom-theme-examples",target:"_blank",rel:"noopener noreferrer"},c.a.createElement(g.c,{id:"user.settings.display.theme.otherThemes",defaultMessage:"See other themes"})))),r.push(c.a.createElement("div",{key:"importSlackThemeButton",className:"padding-top"},c.a.createElement("button",{id:"slackImportTheme",className:"theme style--none color--link",onClick:this.handleImportModal},c.a.createElement(g.c,{id:"user.settings.display.theme.import",defaultMessage:"Import theme colors from Slack"})))));var o=null;this.state.showAllTeamsCheckbox&&(o=c.a.createElement("div",{className:"checkbox user-settings__submit-checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"applyThemeToAllTeams",type:"checkbox",checked:this.state.applyToAllTeams,onChange:function(e){return t.setState({applyToAllTeams:e.target.checked})}}),c.a.createElement(g.c,{id:"user.settings.display.theme.applyToAllTeams",defaultMessage:"Apply new theme to all my teams"})))),s=c.a.createElement(v.a,{inputs:r,submitExtra:o,submit:this.submitTheme,saving:this.state.isSaving,server_error:e,width:"full",updateSection:this.handleUpdateSection})}else s=c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.display.theme.title",defaultMessage:"Theme"}),describe:c.a.createElement(g.c,{id:"user.settings.display.theme.describe",defaultMessage:"Open to manage your theme"}),section:"theme",updateSection:this.handleUpdateSection,focused:this.props.focused});return s}}])&&qe(a.prototype,n),s&&qe(a,s),t}();Ve(Ye,"propTypes",{actions:r.a.shape({saveTheme:r.a.func.isRequired,deleteTeamSpecificThemes:r.a.func.isRequired}).isRequired,currentTeamId:r.a.string.isRequired,theme:r.a.object,selected:r.a.bool.isRequired,updateSection:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,allowCustomThemes:r.a.bool,focused:r.a.bool.isRequired});var We=Object(n.connect)(function(){var e=Object(d.makeGetCategory)();return function(t){return{currentTeamId:Object(Q.getCurrentTeamId)(t),theme:Object(d.getTheme)(t),applyToAllTeams:e(t,f.z.CATEGORY_THEME).length<=1,showAllTeamsCheckbox:Object(Q.getMyTeamsCount)(t)>1}}},function(e){return{actions:Object(l.bindActionCreators)({saveTheme:m.saveTheme,deleteTeamSpecificThemes:m.deleteTeamSpecificThemes},e)}})(Ye),Ke=(a(156),a(1561)),Qe=a(1562),Je=a(1515),Xe=a(1516);function Ze(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function $e(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){Ze(i,n,s,r,o,"next",e)}function o(e){Ze(i,n,s,r,o,"throw",e)}r(void 0)})}}function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nt(e,t,a){return t&&at(e.prototype,t),a&&at(e,a),e}function st(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ct=function(e){function t(){return tt(this,t),st(this,it(t).apply(this,arguments))}return rt(t,Xe["a"]),nt(t,[{key:"render",value:function(){var e=this.props,t=e.item,a="mentions__name";return e.isSelection&&(a+=" suggestion--selected"),c.a.createElement("div",Object.assign({onClick:this.handleClick,className:a},Xe.a.baseProps),t)}}]),t}(),lt=function(e){function t(){return tt(this,t),st(this,it(t).apply(this,arguments))}return rt(t,Je["a"]),nt(t,[{key:"handlePretextChanged",value:function(e,t){return 0===e.length?(this.displayAllTimezones(t,e),!0):!!e&&(this.filterTimezones(t,e),!0)}},{key:"displayAllTimezones",value:function(){var e=$e(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({matchedPretext:"",terms:Object(Y.c)(),items:Object(Y.c)(),component:ct});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"filterTimezones",value:function(){var e=$e(regeneratorRuntime.mark(function e(t,a){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(Y.c)().filter(function(e){return Object(V.getTimezoneRegion)(e).toLowerCase().indexOf(a)>=0||e.toLowerCase().indexOf(a)>=0}),t({matchedPretext:a,terms:n,items:n,component:ct});case 2:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()}]),t}();function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mt(e){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ht=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=mt(t).call(this,e),a=!s||"object"!==ut(s)&&"function"!=typeof s?pt(n):s,gt(pt(a),"onChange",function(e){a.setState({manualTimezoneInput:e.target.value})}),gt(pt(a),"handleTimezoneSelected",function(e){e&&a.setState({manualTimezone:e,manualTimezoneInput:e})}),gt(pt(a),"timezoneNotChanged",function(){var e=a.state,t=e.useAutomaticTimezone,n=e.automaticTimezone,s=e.manualTimezone,i=a.props,r=i.useAutomaticTimezone,o=i.automaticTimezone,c=i.manualTimezone;return t===r&&n===o&&s===c}),gt(pt(a),"changeTimezone",function(){a.timezoneNotChanged()?a.props.updateSection(""):a.submitUser()}),gt(pt(a),"submitUser",function(){var e=a.props,t=e.user,n=e.actions,s=a.state,i=s.useAutomaticTimezone,r=s.automaticTimezone,o=s.manualTimezone,c=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){gt(e,t,a[t])})}return e}({},t,{timezone:{useAutomaticTimezone:i.toString(),automaticTimezone:r,manualTimezone:o}});n.updateMe(c).then(function(e){var t=e.data,n=e.error;if(t)a.props.updateSection("");else if(n){var s;s=n.message?n.message:n,a.setState({serverError:s,isSaving:!1})}})}),gt(pt(a),"handleAutomaticTimezone",function(e){var t=e.target.checked,n="";t&&(n=Object(Y.a)()),a.setState({useAutomaticTimezone:t,automaticTimezone:n})}),gt(pt(a),"handleManualTimezone",function(e){a.setState({manualTimezone:e.target.value})}),a.state={useAutomaticTimezone:e.useAutomaticTimezone,automaticTimezone:e.automaticTimezone,manualTimezone:e.manualTimezone,manualTimezoneInput:e.manualTimezone,isSaving:!1},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"render",value:function(){var e,t=this.props.timezones,a=this.state,n=a.useAutomaticTimezone,s=a.automaticTimezone;this.state.serverError&&(e=c.a.createElement("label",{className:"has-error"},this.state.serverError));var i=[],r=c.a.createElement("div",{className:"section-describe padding-top"},n&&Object(V.getTimezoneRegion)(s)),o=0===t.length,l=c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"automaticTimezoneInput",type:"checkbox",checked:n,onChange:this.handleAutomaticTimezone,disabled:o}),c.a.createElement(g.c,{id:"user.settings.timezones.automatic",defaultMessage:"Set automatically"}),r)),u=[new lt],d=c.a.createElement("div",{key:"changeTimezone"},c.a.createElement("label",{className:"control-label"},c.a.createElement(g.c,{id:"user.settings.timezones.change",defaultMessage:"Change timezone"})),c.a.createElement("div",{className:"padding-top"},c.a.createElement(Ke.a,{ref:this.setSwitchBoxRef,className:"form-control focused",type:"search",onChange:this.onChange,value:this.state.manualTimezoneInput,onItemSelected:this.handleTimezoneSelected,listComponent:Qe.a,maxLength:"64",requiredCharacters:0,providers:u,listStyle:"bottom",completeOnTab:!1,renderDividers:!1,openOnFocus:!0,disabled:o}),e));return i.push(l),n||i.push(d),i.push(c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(g.b,{id:"user.settings.timezones.promote",defaultMessage:"Select the time zone used for timestamps in the user interface and email notifications."}))),c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),containerStyle:"timezone-container",width:"medium",submit:this.changeTimezone,saving:this.state.isSaving,inputs:i,updateSection:this.props.updateSection})}}])&&dt(a.prototype,n),s&&dt(a,s),t}();gt(ht,"propTypes",{user:r.a.object.isRequired,updateSection:r.a.func.isRequired,useAutomaticTimezone:r.a.bool.isRequired,automaticTimezone:r.a.string.isRequired,manualTimezone:r.a.string.isRequired,timezones:r.a.array.isRequired,actions:r.a.shape({updateMe:r.a.func.isRequired}).isRequired});var bt=Object(n.connect)(null,function(e){return{actions:Object(l.bindActionCreators)({updateMe:p.updateMe},e)}})(ht),vt=a(1735),Et=a(1491);function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Mt(e,t,a[t])})}return e}function _t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Nt=function(e){function t(e){var a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=Ot(t).call(this,e),a=!s||"object"!==yt(s)&&"function"!=typeof s?wt(n):s,Mt(wt(a),"handleContainerKeyDown",function(e){Object(b.S)(e,f.Q.KeyCodes.ESCAPE)&&a.state.openMenu&&(document.querySelector(".modal-body").classList.remove("no-scroll"),a.setState({openMenu:!1}),e.stopPropagation())}),Mt(wt(a),"handleKeyDown",function(e){Object(b.S)(e,f.Q.KeyCodes.ENTER)&&(document.querySelector(".modal-body").classList.add("no-scroll"),a.setState({openMenu:!0}))}),Mt(wt(a),"setLanguage",function(e){a.setState({locale:e.value,selectedOption:e})}),Mt(wt(a),"changeLanguage",function(){a.props.user.locale===a.state.locale?a.props.updateSection(""):a.submitUser(St({},a.props.user,{locale:a.state.locale}))}),Mt(wt(a),"submitUser",function(e){a.setState({isSaving:!0}),a.props.actions.updateMe(e).then(function(e){var t=e.data,n=e.error;if(t);else if(n){var s;s=n.message?n.message:n,a.setState({serverError:s,isSaving:!1})}})}),Mt(wt(a),"handleMenuClose",function(){document.querySelector(".modal-body").classList.remove("no-scroll"),a.setState({openMenu:!1})}),Mt(wt(a),"handleMenuOpen",function(){document.querySelector(".modal-body").classList.add("no-scroll"),a.setState({openMenu:!0})});var i=W.d(),r=e.locale,o={value:i[r].value,label:i[r].name};return a.reactSelectContainer=c.a.createRef(),a.state={locale:e.locale,selectedOption:o,isSaving:!1,openMenu:!1},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(t,c.a.Component),a=t,(n=[{key:"componentDidMount",value:function(){this.reactSelectContainer.current&&this.reactSelectContainer.current.addEventListener("keydown",this.handleContainerKeyDown)}},{key:"componentWillUnmount",value:function(){this.reactSelectContainer.current&&this.reactSelectContainer.current.removeEventListener("keydown",this.handleContainerKeyDown)}},{key:"render",value:function(){var e;this.state.serverError&&(e=c.a.createElement("label",{className:"has-error"},this.state.serverError));var t=[],a=W.d();Object.keys(a).map(function(e){return{value:a[e].value,name:a[e].name,order:a[e].order}}).sort(function(e,t){return e.order-t.order}).forEach(function(e){t.push({value:e.value,label:e.name})});var n={menuPortal:function(e){return St({},e,{zIndex:9999})}},s=c.a.createElement("div",{key:"changeLanguage"},c.a.createElement("br",null),c.a.createElement("label",{className:"control-label"},c.a.createElement(g.c,{id:"user.settings.languages.change",defaultMessage:"Change interface language"})),c.a.createElement("div",{ref:this.reactSelectContainer,className:"padding-top"},c.a.createElement(vt.a,{className:"react-select react-select-top",classNamePrefix:"react-select",id:"displayLanguage",menuIsOpen:this.state.openMenu,menuPortalTarget:document.body,styles:n,options:t,clearable:!1,onChange:this.setLanguage,onKeyDown:this.handleKeyDown,value:this.state.selectedOption,onMenuClose:this.handleMenuClose,onMenuOpen:this.handleMenuOpen}),e),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(Et.b,{id:"user.settings.languages.promote",defaultMessage:"Select which language Mattermost displays in the user interface.\\n \\nWould you like to help with translations? Join the [Mattermost Translation Server](!http://translate.mattermost.com/) to contribute."})));return c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",submit:this.changeLanguage,saving:this.state.isSaving,inputs:[s],updateSection:this.props.updateSection})}}])&&_t(a.prototype,n),s&&_t(a,s),t}();Mt(Nt,"propTypes",{user:r.a.object.isRequired,locale:r.a.string.isRequired,updateSection:r.a.func.isRequired,actions:r.a.shape({updateMe:r.a.func.isRequired}).isRequired});var Ct=Object(n.connect)(null,function(e){return{actions:Object(l.bindActionCreators)({updateMe:p.updateMe},e)}})(Nt);function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function At(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){xt(e,t,a[t])})}return e}function Pt(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function jt(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){Pt(i,n,s,r,o,"next",e)}function o(e){Pt(i,n,s,r,o,"throw",e)}r(void 0)})}}function Rt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ut=f.Q.Preferences;function Ft(e){return{militaryTime:e.militaryTime,teammateNameDisplay:e.teammateNameDisplay,channelDisplayMode:e.channelDisplayMode,messageDisplay:e.messageDisplay,collapseDisplay:e.collapseDisplay,linkPreviewDisplay:e.linkPreviewDisplay}}var zt=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=It(t).call(this,e),a=!s||"object"!==Tt(s)&&"function"!=typeof s?Lt(n):s,xt(Lt(a),"handleSubmit",jt(regeneratorRuntime.mark(function e(){var t,n,s,i,r,o,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.user.id,n={user_id:t,category:Ut.CATEGORY_DISPLAY_SETTINGS,name:Ut.USE_MILITARY_TIME,value:a.state.militaryTime},s={user_id:t,category:Ut.CATEGORY_DISPLAY_SETTINGS,name:Ut.NAME_NAME_FORMAT,value:a.state.teammateNameDisplay},i={user_id:t,category:Ut.CATEGORY_DISPLAY_SETTINGS,name:Ut.CHANNEL_DISPLAY_MODE,value:a.state.channelDisplayMode},r={user_id:t,category:Ut.CATEGORY_DISPLAY_SETTINGS,name:Ut.MESSAGE_DISPLAY,value:a.state.messageDisplay},o={user_id:t,category:Ut.CATEGORY_DISPLAY_SETTINGS,name:Ut.COLLAPSE_DISPLAY,value:a.state.collapseDisplay},c={user_id:t,category:Ut.CATEGORY_DISPLAY_SETTINGS,name:Ut.LINK_PREVIEW_DISPLAY,value:a.state.linkPreviewDisplay},a.setState({isSaving:!0}),l=[n,i,r,o,c,s],e.next=11,a.props.actions.savePreferences(t,l);case 11:a.updateSection("");case 12:case"end":return e.stop()}},e)}))),xt(Lt(a),"handleClockRadio",function(e){a.setState({militaryTime:e})}),xt(Lt(a),"handleTeammateNameDisplayRadio",function(e){a.setState({teammateNameDisplay:e})}),xt(Lt(a),"updateSection",function(e){a.updateState(),a.props.updateSection(e)}),xt(Lt(a),"updateState",function(){var e=Ft(a.props);b.c(e,a.state)||a.setState(e),a.setState({isSaving:!1})}),a.state=At({},Ft(e),{isSaving:!1}),0===e.timezones.length&&e.actions.getSupportedTimezones(),a.prevSections={theme:"dummySectionName",clock:"theme",linkpreview:"clock",message_display:"linkpreview",channel_display_mode:"message_display",languages:"channel_display_mode"},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,c.a.Component),a=t,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.actions,a=e.enableTimezone,n=e.shouldAutoUpdateTimezone;a&&n&&t.autoUpdateTimezone(Object(Y.a)())}},{key:"handleChannelDisplayModeRadio",value:function(e){this.setState({channelDisplayMode:e})}},{key:"handlemessageDisplayRadio",value:function(e){this.setState({messageDisplay:e})}},{key:"handleCollapseRadio",value:function(e){this.setState({collapseDisplay:e})}},{key:"handleLinkPreviewRadio",value:function(e){this.setState({linkPreviewDisplay:e})}},{key:"handleOnChange",value:function(e){this.setState(At({},e))}},{key:"createSection",value:function(e){var t,a,n=this,s=e.section,i=e.display,r=e.value,o=e.title,l=e.firstOption,u=e.secondOption,d=e.thirdOption,m=e.description,p=c.a.createElement(g.c,{id:l.radionButtonText.id,defaultMessage:l.radionButtonText.message});l.radionButtonText.moreId&&(t=": ",a=c.a.createElement("span",{className:"font-weight--normal"},c.a.createElement(g.c,{id:l.radionButtonText.moreId,defaultMessage:l.radionButtonText.moreMessage})));var f,h,b=c.a.createElement(g.c,{id:u.radionButtonText.id,defaultMessage:u.radionButtonText.message});u.radionButtonText.moreId&&(f=c.a.createElement("span",{className:"font-weight--normal"},c.a.createElement(g.c,{id:u.radionButtonText.moreId,defaultMessage:u.radionButtonText.moreMessage}))),d&&(h=c.a.createElement(g.c,{id:d.radionButtonText.id,defaultMessage:d.radionButtonText.message}));var y,S=c.a.createElement(g.c,{id:o.id,defaultMessage:o.message}),_=c.a.createElement(g.c,{id:m.id,defaultMessage:m.message});if(this.props.activeSection===s){var O=[!1,!1,!1];r===l.value?O[0]=!0:r===u.value?O[1]=!0:O[2]=!0;var w=s+"Format",k=s+"UserDisplay",M={};M[i]=l.value;var N={};N[i]=u.value;var C,T={};d&&(T[i]=d.value),h&&(C=c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:w+"C",type:"radio",name:w,checked:O[2],onChange:function(){return n.handleOnChange(T)}}),h),c.a.createElement("br",null)));var A=[c.a.createElement("div",{key:k},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:w+"A",type:"radio",name:w,checked:O[0],onChange:function(){return n.handleOnChange(M)}}),p,t,a),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:w+"B",type:"radio",name:w,checked:O[1],onChange:function(){return n.handleOnChange(N)}}),b,t,f),c.a.createElement("br",null)),C,c.a.createElement("div",null,c.a.createElement("br",null),_))];return c.a.createElement("div",null,c.a.createElement(v.a,{title:S,inputs:A,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}return y=r===l.value?p:r===u.value?b:h,c.a.createElement("div",null,c.a.createElement(E.a,{title:S,describe:y,section:s,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}},{key:"render",value:function(){var e=this.createSection({section:"collapse",display:"collapseDisplay",value:this.state.collapseDisplay,defaultDisplay:"false",title:{id:Object(K.b)("user.settings.display.collapseDisplay"),message:"Default appearance of image previews"},firstOption:{value:"false",radionButtonText:{id:Object(K.b)("user.settings.display.collapseOn"),message:"On"}},secondOption:{value:"true",radionButtonText:{id:Object(K.b)("user.settings.display.collapseOff"),message:"Off"}},description:{id:Object(K.b)("user.settings.display.collapseDesc"),message:"Set whether previews of image links and image attachment thumbnails show as expanded or collapsed by default. This setting can also be controlled using the slash commands /expand and /collapse."}}),t=null;this.props.enableLinkPreviews?(t=this.createSection({section:"linkpreview",display:"linkPreviewDisplay",value:this.state.linkPreviewDisplay,defaultDisplay:"true",title:{id:Object(K.b)("user.settings.display.linkPreviewDisplay"),message:"Website Link Previews"},firstOption:{value:"true",radionButtonText:{id:Object(K.b)("user.settings.display.linkPreviewOn"),message:"On"}},secondOption:{value:"false",radionButtonText:{id:Object(K.b)("user.settings.display.linkPreviewOff"),message:"Off"}},description:{id:Object(K.b)("user.settings.display.linkPreviewDesc"),message:"When available, the first web link in a message will show a preview of the website content below the message."}}),this.prevSections.message_display="linkpreview"):this.prevSections.message_display=this.prevSections.linkpreview;var a,n=this.createSection({section:"clock",display:"militaryTime",value:this.state.militaryTime,defaultDisplay:"false",title:{id:Object(K.b)("user.settings.display.clockDisplay"),message:"Clock Display"},firstOption:{value:"false",radionButtonText:{id:Object(K.b)("user.settings.display.normalClock"),message:"12-hour clock (example: 4:00 PM)"}},secondOption:{value:"true",radionButtonText:{id:Object(K.b)("user.settings.display.militaryClock"),message:"24-hour clock (example: 16:00)"}},description:{id:Object(K.b)("user.settings.display.preferTime"),message:"Select how you prefer time displayed."}}),s=this.createSection({section:Ut.NAME_NAME_FORMAT,display:"teammateNameDisplay",value:this.state.teammateNameDisplay,defaultDisplay:this.props.configTeammateNameDisplay,title:{id:Object(K.b)("user.settings.display.teammateNameDisplayTitle"),message:"Teammate Name Display"},firstOption:{value:f.Q.TEAMMATE_NAME_DISPLAY.SHOW_USERNAME,radionButtonText:{id:Object(K.b)("user.settings.display.teammateNameDisplayUsername"),message:"Show username"}},secondOption:{value:f.Q.TEAMMATE_NAME_DISPLAY.SHOW_NICKNAME_FULLNAME,radionButtonText:{id:Object(K.b)("user.settings.display.teammateNameDisplayNicknameFullname"),message:"Show nickname if one exists, otherwise show first and last name"}},thirdOption:{value:f.Q.TEAMMATE_NAME_DISPLAY.SHOW_FULLNAME,radionButtonText:{id:Object(K.b)("user.settings.display.teammateNameDisplayFullname"),message:"Show first and last name"}},description:{id:Object(K.b)("user.settings.display.teammateNameDisplayDescription"),message:"Set how to display other user's names in posts and the Direct Messages list."}});if(this.props.enableTimezone&&!this.props.shouldAutoUpdateTimezone){var i=this.props.userTimezone;a="timezone"===this.props.activeSection?c.a.createElement("div",null,c.a.createElement(bt,{user:this.props.user,timezones:this.props.timezones,useAutomaticTimezone:i.useAutomaticTimezone,automaticTimezone:i.automaticTimezone,manualTimezone:i.manualTimezone,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"})):c.a.createElement("div",null,c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),width:"medium",describe:Object(V.getTimezoneRegion)(this.props.currentUserTimezone),section:"timezone",updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}var r,o,l,u=this.createSection({section:Ut.MESSAGE_DISPLAY,display:"messageDisplay",value:this.state.messageDisplay,defaultDisplay:Ut.MESSAGE_DISPLAY_CLEAN,title:{id:Object(K.b)("user.settings.display.messageDisplayTitle"),message:"Message Display"},firstOption:{value:Ut.MESSAGE_DISPLAY_CLEAN,radionButtonText:{id:Object(K.b)("user.settings.display.messageDisplayClean"),message:"Standard",moreId:Object(K.b)("user.settings.display.messageDisplayCleanDes"),moreMessage:"Easy to scan and read."}},secondOption:{value:Ut.MESSAGE_DISPLAY_COMPACT,radionButtonText:{id:Object(K.b)("user.settings.display.messageDisplayCompact"),message:"Compact",moreId:Object(K.b)("user.settings.display.messageDisplayCompactDes"),moreMessage:"Fit as many messages on the screen as we can."}},description:{id:Object(K.b)("user.settings.display.messageDisplayDescription"),message:"Select how messages in a channel should be displayed."}}),d=this.createSection({section:Ut.CHANNEL_DISPLAY_MODE,display:"channelDisplayMode",value:this.state.channelDisplayMode,defaultDisplay:Ut.CHANNEL_DISPLAY_MODE_FULL_SCREEN,title:{id:Object(K.b)("user.settings.display.channelDisplayTitle"),message:"Channel Display"},firstOption:{value:Ut.CHANNEL_DISPLAY_MODE_FULL_SCREEN,radionButtonText:{id:Object(K.b)("user.settings.display.fullScreen"),message:"Full width"}},secondOption:{value:Ut.CHANNEL_DISPLAY_MODE_CENTERED,radionButtonText:{id:Object(K.b)("user.settings.display.fixedWidthCentered"),message:"Fixed width, centered"}},description:{id:Object(K.b)("user.settings.display.channeldisplaymode"),message:"Select the width of the center channel."}}),m=this.props.user.locale;"languages"===this.props.activeSection?(W.e(m)||(m=this.props.defaultClientLocale),r=c.a.createElement("div",null,c.a.createElement(Ct,{user:this.props.user,locale:m,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))):(o=W.e(m)?W.c(m).name:W.c(this.props.defaultClientLocale).name,r=c.a.createElement("div",null,c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",describe:o,section:"languages",updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"})));return 1===Object.keys(W.d()).length&&(r=null),this.props.enableThemeSelection&&(l=c.a.createElement("div",null,c.a.createElement(We,{selected:"theme"===this.props.activeSection,updateSection:this.updateSection,setRequireConfirm:this.props.setRequireConfirm,setEnforceFocus:this.props.setEnforceFocus,allowCustomThemes:this.props.allowCustomThemes}),c.a.createElement("div",{className:"divider-dark"}))),c.a.createElement("div",{id:"displaySettings"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("span",{onClick:this.props.collapseModal},c.a.createElement(S.a,null))),c.a.createElement(g.c,{id:"user.settings.display.title",defaultMessage:"Display Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{id:"displaySettingsTitle",className:"tab-header"},c.a.createElement(g.c,{id:"user.settings.display.title",defaultMessage:"Display Settings"})),c.a.createElement("div",{className:"divider-dark first"}),l,n,s,a,t,e,u,d,r))}}])&&Rt(a.prototype,n),s&&Rt(a,s),t}();xt(zt,"propTypes",{user:r.a.object,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,timezones:r.a.array.isRequired,userTimezone:r.a.object.isRequired,allowCustomThemes:r.a.bool,enableLinkPreviews:r.a.bool,defaultClientLocale:r.a.string,enableThemeSelection:r.a.bool,configTeammateNameDisplay:r.a.string,currentUserTimezone:r.a.string,enableTimezone:r.a.bool,shouldAutoUpdateTimezone:r.a.bool,militaryTime:r.a.string,teammateNameDisplay:r.a.string,channelDisplayMode:r.a.string,messageDisplay:r.a.string,collapseDisplay:r.a.string,linkPreviewDisplay:r.a.string,actions:r.a.shape({getSupportedTimezones:r.a.func.isRequired,autoUpdateTimezone:r.a.func.isRequired,savePreferences:r.a.func.isRequired}).isRequired});var qt=Object(n.connect)(function(e){var t=Object(u.getConfig)(e),a=Object(u.getSupportedTimezones)(e),n=Object(s.getCurrentUserId)(e),i=Object(H.getUserTimezone)(e,n),r=i&&i.useAutomaticTimezone&&!i.automaticTimezone,o=!i||r,c="true"===t.AllowCustomThemes,l="true"===t.EnableLinkPreviews,m=t.DefaultClientLocale,p="true"===t.EnableThemeSelection,g="true"===t.ExperimentalTimezone,h=t.TeammateNameDisplay;return{allowCustomThemes:c,configTeammateNameDisplay:h,enableLinkPreviews:l,defaultClientLocale:m,enableThemeSelection:p,enableTimezone:g,timezones:a,userTimezone:i,shouldAutoUpdateTimezone:o,currentUserTimezone:Object(V.getUserCurrentTimezone)(i),militaryTime:Object(d.get)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.USE_MILITARY_TIME,f.z.USE_MILITARY_TIME_DEFAULT),teammateNameDisplay:Object(d.get)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.NAME_NAME_FORMAT,h),channelDisplayMode:Object(d.get)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.CHANNEL_DISPLAY_MODE,f.z.CHANNEL_DISPLAY_MODE_DEFAULT),messageDisplay:Object(d.get)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.MESSAGE_DISPLAY,f.z.MESSAGE_DISPLAY_DEFAULT),collapseDisplay:Object(d.get)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.COLLAPSE_DISPLAY,f.z.COLLAPSE_DISPLAY_DEFAULT),linkPreviewDisplay:Object(d.get)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.LINK_PREVIEW_DISPLAY,f.z.LINK_PREVIEW_DISPLAY_DEFAULT)}},function(e){return{actions:Object(l.bindActionCreators)({getSupportedTimezones:G.getSupportedTimezones,autoUpdateTimezone:B.autoUpdateTimezone,savePreferences:m.savePreferences},e)}})(zt),Gt=a(106),Bt=(a(305),a(306),a(76)),Ht=a(420),Vt=a(1790),Yt=a(1526);function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function Qt(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){Kt(i,n,s,r,o,"next",e)}function o(e){Kt(i,n,s,r,o,"throw",e)}r(void 0)})}}function Jt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ea(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ta=Object(g.g)({usernameReserved:{id:Object(K.b)("user.settings.general.usernameReserved"),defaultMessage:"This username is reserved, please choose a new one."},usernameRestrictions:{id:Object(K.b)("user.settings.general.usernameRestrictions"),defaultMessage:"Username must begin with a letter, and contain between {min} to {max} lowercase characters made up of numbers, letters, and the symbols '.', '-', and '_'."},validEmail:{id:Object(K.b)("user.settings.general.validEmail"),defaultMessage:"Please enter a valid email address."},emailMatch:{id:Object(K.b)("user.settings.general.emailMatch"),defaultMessage:"The new emails you entered do not match."},incorrectPassword:{id:Object(K.b)("user.settings.general.incorrectPassword"),defaultMessage:"Your password is incorrect."},emptyPassword:{id:Object(K.b)("user.settings.general.emptyPassword"),defaultMessage:"Please enter your current password."},validImage:{id:Object(K.b)("user.settings.general.validImage"),defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"},imageTooLarge:{id:Object(K.b)("user.settings.general.imageTooLarge"),defaultMessage:"Unable to upload profile image. File is too large."},uploadImage:{id:Object(K.b)("user.settings.general.uploadImage"),defaultMessage:"Click 'Edit' to upload an image."},uploadImageMobile:{id:Object(K.b)("user.settings.general.mobile.uploadImage"),defaultMessage:"Click to upload an image"},fullName:{id:Object(K.b)("user.settings.general.fullName"),defaultMessage:"Full Name"},nickname:{id:Object(K.b)("user.settings.general.nickname"),defaultMessage:"Nickname"},username:{id:Object(K.b)("user.settings.general.username"),defaultMessage:"Username"},profilePicture:{id:Object(K.b)("user.settings.general.profilePicture"),defaultMessage:"Profile Picture"},close:{id:Object(K.b)("user.settings.general.close"),defaultMessage:"Close"},position:{id:Object(K.b)("user.settings.general.position"),defaultMessage:"Position"}}),aa=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=Xt(t).call(this,e),a=!s||"object"!==Wt(s)&&"function"!=typeof s?Zt(n):s,ea(Zt(a),"handleEmailResend",function(e){a.setState({resendStatus:"sending",showSpinner:!0}),a.props.actions.sendVerificationEmail(e).then(function(e){var t=e.data,n=e.error;t?a.setState({resendStatus:"success"}):n&&a.setState({resendStatus:"failure"})})}),ea(Zt(a),"createEmailResendLink",function(e){return c.a.createElement("span",{className:"resend-verification-wrapper"},c.a.createElement(Yt.a,{loading:a.state.showSpinner,text:b.ab("user.settings.general.sending","Sending")},c.a.createElement("a",{onClick:function(){a.handleEmailResend(e),setTimeout(function(){a.setState({showSpinner:!1})},500)}},c.a.createElement(g.c,{id:"user.settings.general.sendAgain",defaultMessage:"Send again"}))))}),ea(Zt(a),"submitUsername",function(){var e=Object.assign({},a.props.user),t=a.state.username.trim().toLowerCase(),n=a.props.intl.formatMessage,s=b.Y(t);"Cannot use a reserved word as a username."!==s?s?a.setState({clientError:n(ta.usernameRestrictions,{min:f.i.MIN_USERNAME_LENGTH,max:f.i.MAX_USERNAME_LENGTH}),serverError:""}):e.username!==t?(e.username=t,Object(Ht.d)("settings","user_settings_update",{field:"username"}),a.submitUser(e,!1)):a.updateSection(""):a.setState({clientError:n(ta.usernameReserved),serverError:""})}),ea(Zt(a),"submitNickname",function(){var e=Object.assign({},a.props.user),t=a.state.nickname.trim();e.nickname!==t?(e.nickname=t,Object(Ht.d)("settings","user_settings_update",{field:"nickname"}),a.submitUser(e,!1)):a.updateSection("")}),ea(Zt(a),"submitName",function(){var e=Object.assign({},a.props.user),t=a.state.firstName.trim(),n=a.state.lastName.trim();e.first_name!==t||e.last_name!==n?(e.first_name=t,e.last_name=n,Object(Ht.d)("settings","user_settings_update",{field:"fullname"}),a.submitUser(e,!1)):a.updateSection("")}),ea(Zt(a),"submitEmail",function(){var e=Object.assign({},a.props.user),t=a.state.email.trim().toLowerCase(),n=a.state.confirmEmail.trim().toLowerCase(),s=a.state.currentPassword,i=a.props.intl.formatMessage;t!==e.email||""!==n&&n!==e.email?""!==t&&Object(Bt.isEmail)(t)?t===n?""!==s?(e.email=t,e.password=s,Object(Ht.d)("settings","user_settings_update",{field:"email"}),a.submitUser(e,!0)):a.setState({emailError:i(ta.emptyPassword),clientError:"",serverError:""}):a.setState({emailError:i(ta.emailMatch),clientError:"",serverError:""}):a.setState({emailError:i(ta.validEmail),clientError:"",serverError:""}):a.updateSection("")}),ea(Zt(a),"submitUser",function(e,t){var n=a.props.intl.formatMessage;a.setState({sectionIsSaving:!0}),a.props.actions.updateMe(e).then(function(e){var s=e.data,i=e.error;if(s)a.updateSection(""),a.props.actions.getMe(),a.props.sendEmailNotifications&&a.props.requireEmailVerification&&t&&(a.props.actions.clearErrors(),a.props.actions.logError({message:f.g.EMAIL_VERIFICATION_REQUIRED,type:f.h.SUCCESS},!0));else if(i){var r;r=i.server_error_id&&"api.user.check_user_password.invalid.app_error"===i.server_error_id?n(ta.incorrectPassword):i.message?i.message:i,a.setState({serverError:r,emailError:"",clientError:"",sectionIsSaving:!1})}})}),ea(Zt(a),"setDefaultProfilePicture",Qt(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.actions.setDefaultProfileImage(a.props.user.id);case 3:a.updateSection(""),a.submitActive=!1,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t=e.t0.message?e.t0.message:e.t0,a.setState({serverError:t,emailError:"",clientError:"",sectionIsSaving:!1});case 11:case"end":return e.stop()}},e,null,[[0,7]])}))),ea(Zt(a),"submitPicture",function(){if(a.state.pictureFile&&a.submitActive){Object(Ht.d)("settings","user_settings_update",{field:"picture"});var e=a.props.intl.formatMessage,t=a.state.pictureFile;f.d.includes(t.type)?t.size>a.props.maxFileSize?a.setState({clientError:e(ta.imageTooLarge),serverError:""}):(a.setState({loadingPicture:!0}),a.props.actions.uploadProfileImage(a.props.user.id,t).then(function(e){var t=e.data,n=e.error;if(t)a.updateSection(""),a.submitActive=!1;else if(n){var s=a.setupInitialState(a.props);s.serverError=n.message,a.setState(s)}})):a.setState({clientError:e(ta.validImage),serverError:""})}}),ea(Zt(a),"submitPosition",function(){var e=Object.assign({},a.props.user),t=a.state.position.trim();e.position!==t?(e.position=t,Object(Ht.d)("settings","user_settings_update",{field:"position"}),a.submitUser(e,!1)):a.updateSection("")}),ea(Zt(a),"updateUsername",function(e){a.setState({username:e.target.value})}),ea(Zt(a),"updateFirstName",function(e){a.setState({firstName:e.target.value})}),ea(Zt(a),"updateLastName",function(e){a.setState({lastName:e.target.value})}),ea(Zt(a),"updateNickname",function(e){a.setState({nickname:e.target.value})}),ea(Zt(a),"updatePosition",function(e){a.setState({position:e.target.value})}),ea(Zt(a),"updateEmail",function(e){a.setState({email:e.target.value})}),ea(Zt(a),"updateConfirmEmail",function(e){a.setState({confirmEmail:e.target.value})}),ea(Zt(a),"updateCurrentPassword",function(e){a.setState({currentPassword:e.target.value})}),ea(Zt(a),"updatePicture",function(e){e.target.files&&e.target.files[0]?(a.setState({pictureFile:e.target.files[0]}),a.submitActive=!0,a.setState({clientError:null})):a.setState({pictureFile:null})}),ea(Zt(a),"updateSection",function(e){a.setState(Object.assign({},a.setupInitialState(a.props),{clientError:"",serverError:"",emailError:"",sectionIsSaving:!1})),a.submitActive=!1,a.props.updateSection(e)}),a.submitActive=!1,a.state=a.setupInitialState(e),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,c.a.Component),a=t,(n=[{key:"setupInitialState",value:function(e){var t=e.user;return{username:t.username,firstName:t.first_name,lastName:t.last_name,nickname:t.nickname,position:t.position,originalEmail:t.email,email:"",confirmEmail:"",currentPassword:"",pictureFile:null,loadingPicture:!1,sectionIsSaving:!1,showSpinner:!1}}},{key:"createEmailSection",value:function(){var e,t=this.props.intl.formatMessage;if("email"===this.props.activeSection){var a=this.props.sendEmailNotifications,n=this.props.requireEmailVerification,s=[],i=c.a.createElement(g.c,{id:"user.settings.general.emailHelp1",defaultMessage:"Email is used for sign-in, notifications, and password reset. Email requires verification if changed."});a?n||(i=c.a.createElement(g.c,{id:"user.settings.general.emailHelp3",defaultMessage:"Email is used for sign-in, notifications, and password reset."})):i=c.a.createElement("div",{className:"setting-list__hint col-sm-12 text-danger"},c.a.createElement(g.c,{id:"user.settings.general.emailHelp2",defaultMessage:"Email has been disabled by your System Administrator. No notification emails will be sent until it is enabled."}));var r=null;""===this.props.user.auth_service?(s.push(c.a.createElement("div",{key:"currentEmailSetting"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.general.currentEmail",defaultMessage:"Current Email"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("label",{className:"control-label word-break--all text-left"},this.state.originalEmail))))),s.push(c.a.createElement("div",{key:"emailSetting"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.general.newEmail",defaultMessage:"New Email"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{autoFocus:!0,id:"primaryEmail",className:"form-control",type:"email",onChange:this.updateEmail,value:this.state.email,"aria-label":t({id:"user.settings.general.newEmail",defaultMessage:"New Email"})}))))),s.push(c.a.createElement("div",{key:"confirmEmailSetting"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.general.confirmEmail",defaultMessage:"Confirm Email"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"confirmEmail",className:"form-control",type:"email",onChange:this.updateConfirmEmail,value:this.state.confirmEmail,"aria-label":t({id:"user.settings.general.confirmEmail",defaultMessage:"Confirm Email"})}))))),s.push(c.a.createElement("div",{key:"currentPassword"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.general.currentPassword",defaultMessage:"Current Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"currentPassword",className:"form-control",type:"password",onChange:this.updateCurrentPassword,value:this.state.currentPassword,"aria-label":t({id:"user.settings.general.currentPassword",defaultMessage:"Current Password"})}))),i)),r=this.submitEmail):this.props.user.auth_service===f.i.GITLAB_SERVICE?s.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.general.emailGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===f.i.GOOGLE_SERVICE?s.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.general.emailGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===f.i.OFFICE365_SERVICE?s.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.general.emailOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===f.i.LDAP_SERVICE?s.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-bottom"},c.a.createElement("div",{className:"setting-list__hint padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.general.emailLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})))):this.props.user.auth_service===f.i.SAML_SERVICE&&s.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-bottom"},c.a.createElement("div",{className:"setting-list__hint padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.general.emailSamlCantUpdate",defaultMessage:"Login occurs through SAML. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)),e=c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.general.email",defaultMessage:"Email"}),inputs:s,submit:r,saving:this.state.sectionIsSaving,serverError:this.state.serverError,clientError:this.state.emailError,updateSection:this.updateSection})}else{var o="";""===this.props.user.auth_service?o=this.props.user.email:this.props.user.auth_service===f.i.GITLAB_SERVICE?o=c.a.createElement(g.c,{id:"user.settings.general.loginGitlab",defaultMessage:"Login done through GitLab ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===f.i.GOOGLE_SERVICE?o=c.a.createElement(g.c,{id:"user.settings.general.loginGoogle",defaultMessage:"Login done through Google Apps ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===f.i.OFFICE365_SERVICE?o=c.a.createElement(g.c,{id:"user.settings.general.loginOffice365",defaultMessage:"Login done through Office 365 ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===f.i.LDAP_SERVICE?o=c.a.createElement(g.c,{id:"user.settings.general.loginLdap",defaultMessage:"Login done through AD/LDAP ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===f.i.SAML_SERVICE&&(o=c.a.createElement(g.c,{id:"user.settings.general.loginSaml",defaultMessage:"Login done through SAML ({email})",values:{email:this.state.originalEmail}})),e=c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.general.email",defaultMessage:"Email"}),describe:o,section:"email",updateSection:this.updateSection})}return e}},{key:"render",value:function(){var e=this,t=this.props.user,a=this.props.intl.formatMessage,n=null;this.state.clientError&&(n=this.state.clientError);var s,i=null;this.state.serverError&&(i=this.state.serverError);var r,o,l,u=[];if("name"===this.props.activeSection){var d,m=null;if("ldap"===this.props.user.auth_service&&(this.props.ldapFirstNameAttributeSet||this.props.ldapLastNameAttributeSet)||this.props.user.auth_service===f.i.SAML_SERVICE&&(this.props.samlFirstNameAttributeSet||this.props.samlLastNameAttributeSet))d=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."}));else{u.push(c.a.createElement("div",{key:"firstNameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.general.firstName",defaultMessage:"First Name"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"firstName",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateFirstName,value:this.state.firstName,onFocus:b.cb,"aria-label":a({id:"user.settings.general.firstName",defaultMessage:"First Name"})})))),u.push(c.a.createElement("div",{key:"lastNameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.general.lastName",defaultMessage:"Last Name"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"lastName",className:"form-control",type:"text",onChange:this.updateLastName,value:this.state.lastName,"aria-label":a({id:"user.settings.general.lastName",defaultMessage:"Last Name"})}))));var p=c.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),this.updateSection(""),this.props.updateTab("notifications")}.bind(this)},c.a.createElement(g.c,{id:"user.settings.general.notificationsLink",defaultMessage:"Notifications"}));d=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.notificationsExtra",defaultMessage:"By default, you will receive mention notifications when someone types your first name. Go to {notify} settings to change this default.",values:{notify:p}})),m=this.submitName}s=c.a.createElement(v.a,{title:a(ta.fullName),inputs:u,submit:m,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:d})}else{var h="";t.first_name&&t.last_name?h=t.first_name+" "+t.last_name:t.first_name?h=t.first_name:t.last_name?h=t.last_name:(h=c.a.createElement(g.c,{id:"user.settings.general.emptyName",defaultMessage:"Click 'Edit' to add your full name"}),b.U()&&(h=c.a.createElement(g.c,{id:"user.settings.general.mobile.emptyName",defaultMessage:"Click to add your full name"}))),s=c.a.createElement(E.a,{title:a(ta.fullName),describe:h,section:"name",updateSection:this.updateSection})}if("nickname"===this.props.activeSection){var y,S=null;if("ldap"===this.props.user.auth_service&&this.props.ldapNicknameAttributeSet||this.props.user.auth_service===f.i.SAML_SERVICE&&this.props.samlNicknameAttributeSet)y=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));else{var _=c.a.createElement(g.c,{id:"user.settings.general.nickname",defaultMessage:"Nickname"});b.U()&&(_=""),u.push(c.a.createElement("div",{key:"nicknameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},_),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"nickname",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateNickname,value:this.state.nickname,maxLength:f.i.MAX_NICKNAME_LENGTH,autoCapitalize:"off","aria-label":a({id:"user.settings.general.nickname",defaultMessage:"Nickname"})})))),y=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.nicknameExtra",defaultMessage:"Use Nickname for a name you might be called that is different from your first name and username. This is most often used when two or more people have similar sounding names and usernames."})),S=this.submitNickname}r=c.a.createElement(v.a,{title:a(ta.nickname),inputs:u,submit:S,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:y})}else{var O="";t.nickname?O=t.nickname:(O=c.a.createElement(g.c,{id:"user.settings.general.emptyNickname",defaultMessage:"Click 'Edit' to add a nickname"}),b.U()&&(O=c.a.createElement(g.c,{id:"user.settings.general.mobile.emptyNickname",defaultMessage:"Click to add a nickname"}))),r=c.a.createElement(E.a,{title:a(ta.nickname),describe:O,section:"nickname",updateSection:this.updateSection})}if("username"===this.props.activeSection){var w,k=null;if(""===this.props.user.auth_service){var M=c.a.createElement(g.c,{id:"user.settings.general.username",defaultMessage:"Username"});b.U()&&(M=""),u.push(c.a.createElement("div",{key:"usernameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},M),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"username",autoFocus:!0,maxLength:f.i.MAX_USERNAME_LENGTH,className:"form-control",type:"text",onChange:this.updateUsername,value:this.state.username,autoCapitalize:"off",onFocus:b.cb,"aria-label":a({id:"user.settings.general.username",defaultMessage:"Username"})})))),w=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.usernameInfo",defaultMessage:"Pick something easy for teammates to recognize and recall."})),k=this.submitUsername}else w=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));o=c.a.createElement(v.a,{title:a(ta.username),inputs:u,submit:k,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:w})}else o=c.a.createElement(E.a,{title:a(ta.username),describe:this.props.user.username,section:"username",updateSection:this.updateSection});if("position"===this.props.activeSection){var N,C=null;if(this.props.user.auth_service===f.i.LDAP_SERVICE&&this.props.ldapPositionAttributeSet||this.props.user.auth_service===f.i.SAML_SERVICE&&this.props.samlPositionAttributeSet)N=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));else{var T=c.a.createElement(g.c,{id:"user.settings.general.position",defaultMessage:"Position"});b.U()&&(T=""),u.push(c.a.createElement("div",{key:"positionSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},T),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"position",autoFocus:!0,className:"form-control",type:"text",onChange:this.updatePosition,value:this.state.position,maxLength:f.i.MAX_POSITION_LENGTH,autoCapitalize:"off",onFocus:b.cb,"aria-label":a({id:"user.settings.general.position",defaultMessage:"Position"})})))),N=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.general.positionExtra",defaultMessage:"Use Position for your role or job title. This will be shown in your profile popover."})),C=this.submitPosition}l=c.a.createElement(v.a,{title:a(ta.position),inputs:u,submit:C,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:N})}else{var A="";t.position?A=t.position:(A=c.a.createElement(g.c,{id:"user.settings.general.emptyPosition",defaultMessage:"Click 'Edit' to add your job title / position"}),b.U()&&(A=c.a.createElement(g.c,{id:"user.settings.general.mobile.emptyPosition",defaultMessage:"Click to add your job title / position"}))),l=c.a.createElement(E.a,{title:a(ta.position),describe:A,section:"position",updateSection:this.updateSection})}var P,j=this.createEmailSection();if("picture"===this.props.activeSection)P=c.a.createElement(Vt.a,{title:a(ta.profilePicture),onSubmit:this.submitPicture,onSetDefault:t.last_picture_update>0?this.setDefaultProfilePicture:null,src:b.J(t),defaultImageSrc:b.i(t.id),serverError:i,clientError:n,updateSection:function(t){e.updateSection(""),t.preventDefault()},file:this.state.pictureFile,onFileChange:this.updatePicture,submitActive:this.submitActive,loadingPicture:this.state.loadingPicture,maxFileSize:this.props.maxFileSize});else{var R=a(ta.uploadImage);b.U()&&(R=a(ta.uploadImageMobile)),t.last_picture_update&&(R=c.a.createElement(g.c,{id:"user.settings.general.imageUpdated",defaultMessage:"Image last updated {date}",values:{date:c.a.createElement(g.a,{value:new Date(t.last_picture_update),day:"2-digit",month:"short",year:"numeric"})}})),P=c.a.createElement(E.a,{title:a(ta.profilePicture),describe:R,section:"picture",updateSection:this.updateSection})}return c.a.createElement("div",{id:"generalSettings"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeUserSettings",type:"button",className:"close","data-dismiss":"modal","aria-label":a(ta.close),onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement(g.c,{id:"generic_icons.collapse",defaultMessage:"Collapse Icon"},function(t){return c.a.createElement("i",{className:"fa fa-angle-left",title:t,onClick:e.props.collapseModal})})),c.a.createElement(g.c,{id:"user.settings.general.title",defaultMessage:"General Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{id:"generalSettingsTitle",className:"tab-header"},c.a.createElement(g.c,{id:"user.settings.general.title",defaultMessage:"General Settings"})),c.a.createElement("div",{className:"divider-dark first"}),s,c.a.createElement("div",{className:"divider-light"}),o,c.a.createElement("div",{className:"divider-light"}),r,c.a.createElement("div",{className:"divider-light"}),l,c.a.createElement("div",{className:"divider-light"}),j,c.a.createElement("div",{className:"divider-light"}),P,c.a.createElement("div",{className:"divider-dark"})))}}])&&Jt(a.prototype,n),s&&Jt(a,s),t}();ea(aa,"propTypes",{intl:g.i.isRequired,user:r.a.object.isRequired,updateSection:r.a.func.isRequired,updateTab:r.a.func.isRequired,activeSection:r.a.string.isRequired,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,actions:r.a.shape({logError:r.a.func.isRequired,clearErrors:r.a.func.isRequired,getMe:r.a.func.isRequired,updateMe:r.a.func.isRequired,sendVerificationEmail:r.a.func.isRequired,setDefaultProfileImage:r.a.func.isRequired,uploadProfileImage:r.a.func.isRequired}).isRequired,sendEmailNotifications:r.a.bool,requireEmailVerification:r.a.bool,maxFileSize:r.a.number,ldapFirstNameAttributeSet:r.a.bool,ldapLastNameAttributeSet:r.a.bool,samlFirstNameAttributeSet:r.a.bool,samlLastNameAttributeSet:r.a.bool,ldapNicknameAttributeSet:r.a.bool,samlNicknameAttributeSet:r.a.bool,ldapPositionAttributeSet:r.a.bool,samlPositionAttributeSet:r.a.bool});var na=Object(g.h)(aa);var sa=Object(n.connect)(function(e){var t=Object(u.getConfig)(e);return{sendEmailNotifications:"true"===t.SendEmailNotifications,requireEmailVerification:"true"===t.RequireEmailVerification,maxFileSize:parseInt(t.MaxFileSize,10),ldapFirstNameAttributeSet:"true"===t.LdapFirstNameAttributeSet,ldapLastNameAttributeSet:"true"===t.LdapLastNameAttributeSet,samlFirstNameAttributeSet:"true"===t.SamlFirstNameAttributeSet,samlLastNameAttributeSet:"true"===t.SamlLastNameAttributeSet,ldapNicknameAttributeSet:"true"===t.LdapNicknameAttributeSet,samlNicknameAttributeSet:"true"===t.SamlNicknameAttributeSet,samlPositionAttributeSet:"true"===t.SamlPositionAttributeSet,ldapPositionAttributeSet:"true"===t.LdapPositionAttributeSet}},function(e){return{actions:Object(l.bindActionCreators)({logError:Gt.logError,clearErrors:Gt.clearErrors,getMe:p.getMe,updateMe:p.updateMe,sendVerificationEmail:p.sendVerificationEmail,setDefaultProfileImage:p.setDefaultProfileImage,uploadProfileImage:p.uploadProfileImage},e)}})(na);function ia(e){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ra(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oa(e){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ca(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function la(e,t){return(la=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ua(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var da=function(e){function t(){var e,a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=this,s=(e=oa(t)).call.apply(e,[this].concat(r)),a=!s||"object"!==ia(s)&&"function"!=typeof s?ca(n):s,ua(ca(a),"handleMinUpdateSection",function(e){a.props.updateSection(e),a.props.cancel()}),ua(ca(a),"handleMaxUpdateSection",function(e){a.props.updateSection(e)}),ua(ca(a),"handleOnChange",function(e){var t=e.currentTarget.getAttribute("data-key"),n=e.currentTarget.getAttribute("data-value");a.props.setParentState(t,n)}),ua(ca(a),"buildMaximizedSetting",function(){var e,t=[],n=[!1,!1,!1];if(a.props.activity===f.s.MENTION?n[1]=!0:a.props.activity===f.s.NONE?n[2]=!0:n[0]=!0,a.props.activity!==f.s.NONE){var s=[!1,!1];"false"===a.props.sound?s[1]=!0:s[0]=!0,e=b.H()?c.a.createElement("fieldset",null,c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"soundOn",type:"radio",name:"notificationSounds",checked:s[0],"data-key":"desktopSound","data-value":"true",onChange:a.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.notifications.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"soundOff",type:"radio",name:"notificationSounds",checked:s[1],"data-key":"desktopSound","data-value":"false",onChange:a.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.notifications.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.notifications.sounds_info",defaultMessage:"Notification sounds are available on IE11, Safari, Chrome and Mattermost Desktop Apps."}))):c.a.createElement("fieldset",null,c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),c.a.createElement("br",null),c.a.createElement(g.c,{id:"user.settings.notifications.soundConfig",defaultMessage:"Please configure notification sounds in your browser settings"}))}return t.push(c.a.createElement("div",{key:"userNotificationLevelOption"},c.a.createElement("fieldset",null,c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.notifications.desktop",defaultMessage:"Send desktop notifications"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"desktopNotificationAllActivity",type:"radio",name:"desktopNotificationLevel",checked:n[0],"data-key":"desktopActivity","data-value":f.s.ALL,onChange:a.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.notifications.allActivity",defaultMessage:"For all activity"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"desktopNotificationMentions",type:"radio",name:"desktopNotificationLevel",checked:n[1],"data-key":"desktopActivity","data-value":f.s.MENTION,onChange:a.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.notifications.onlyMentions",defaultMessage:"Only for mentions and direct messages"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"desktopNotificationNever",type:"radio",name:"desktopNotificationLevel",checked:n[2],"data-key":"desktopActivity","data-value":f.s.NONE,onChange:a.handleOnChange}),c.a.createElement(g.c,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.notifications.info",defaultMessage:"Desktop notifications are available on Edge, Firefox, Safari, Chrome and Mattermost Desktop Apps."}))),c.a.createElement("hr",null),e)),c.a.createElement(v.a,{title:b.ab("user.settings.notifications.desktop.title","Desktop notifications"),inputs:t,submit:a.props.submit,saving:a.props.saving,server_error:a.props.error,updateSection:a.handleMaxUpdateSection})}),ua(ca(a),"buildMinimizedSetting",function(){var e,t=b.H();return e=a.props.activity===f.s.MENTION?t&&"false"!==a.props.sound?{id:Object(K.b)("user.settings.notifications.desktop.mentionsSound"),defaultMessage:"For mentions and direct messages, with sound"}:t&&"false"===a.props.sound?{id:Object(K.b)("user.settings.notifications.desktop.mentionsNoSound"),defaultMessage:"For mentions and direct messages, without sound"}:{id:Object(K.b)("user.settings.notifications.desktop.mentionsSoundHidden"),defaultMessage:"For mentions and direct messages"}:a.props.activity===f.s.NONE?{id:Object(K.b)("user.settings.notifications.off"),defaultMessage:"Off"}:t&&"false"!==a.props.sound?{id:Object(K.b)("user.settings.notifications.desktop.allSound"),defaultMessage:"For all activity, with sound"}:t&&"false"===a.props.sound?{id:Object(K.b)("user.settings.notifications.desktop.allNoSound"),defaultMessage:"For all activity, without sound"}:{id:Object(K.b)("user.settings.notifications.desktop.allSoundHidden"),defaultMessage:"For all activity"},c.a.createElement(E.a,{title:b.ab("user.settings.notifications.desktop.title","Desktop notifications"),describe:c.a.createElement(g.c,e),focused:a.props.focused,section:"desktop",updateSection:a.handleMinUpdateSection})}),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&la(e,t)}(t,c.a.Component),a=t,(n=[{key:"render",value:function(){return this.props.active?this.buildMaximizedSetting():this.buildMinimizedSetting()}}])&&ra(a.prototype,n),s&&ra(a,s),t}();da.propTypes={activity:r.a.string.isRequired,sound:r.a.string.isRequired,updateSection:r.a.func,setParentState:r.a.func,submit:r.a.func,cancel:r.a.func,error:r.a.string,active:r.a.bool,saving:r.a.bool,focused:r.a.bool};var ma=a(212),pa=a(2260);function fa(e){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ga(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function ha(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){ga(i,n,s,r,o,"next",e)}function o(e){ga(i,n,s,r,o,"throw",e)}r(void 0)})}}function ba(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function va(e){return(va=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ea(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ya(e,t){return(ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _a=60,Oa=function(e){function t(e){var a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=va(t).call(this,e),a=!s||"object"!==fa(s)&&"function"!=typeof s?Ea(n):s,Sa(Ea(a),"handleChange",function(e){var t=e.currentTarget.getAttribute("data-enable-email");a.setState({enableEmail:t,newInterval:parseInt(e.currentTarget.getAttribute("data-email-interval"),10)}),a.props.onChange(t)}),Sa(Ea(a),"handleSubmit",ha(regeneratorRuntime.mark(function e(){var t,n,s,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state.newInterval,a.props.emailInterval!==t){e.next=5;break}a.props.updateSection(""),e.next=10;break;case 5:return n=a.props,s=n.currentUserId,i=n.actions,r={user_id:s,category:f.z.CATEGORY_NOTIFICATIONS,name:f.z.EMAIL_INTERVAL,value:t.toString()},e.next=9,i.savePreferences(s,[r]);case 9:a.props.onSubmit();case 10:case"end":return e.stop()}},e)}))),Sa(Ea(a),"handleUpdateSection",function(e){e?a.props.updateSection(e):(a.props.updateSection(""),a.setState({enableEmail:a.props.enableEmail,newInterval:a.props.emailInterval}),a.props.onCancel())}),Sa(Ea(a),"renderMinSettingView",function(){var e,t=a.props,n=t.enableEmail,s=t.focused,i=t.sendEmailNotifications,r=a.state.newInterval;if(i)if(n)switch(r){case f.z.INTERVAL_IMMEDIATE:e=c.a.createElement(g.c,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"});break;case f.z.INTERVAL_HOUR:e=c.a.createElement(g.c,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"});break;case f.z.INTERVAL_FIFTEEN_MINUTES:e=c.a.createElement(g.c,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count, plural, one {minute} other {{count, number} minutes}}",values:{count:r/_a}});break;default:e=c.a.createElement(g.c,{id:"user.settings.notifications.email.never",defaultMessage:"Never"})}else e=c.a.createElement(g.c,{id:"user.settings.notifications.email.never",defaultMessage:"Never"});else e=c.a.createElement(g.c,{id:"user.settings.notifications.email.disabled",defaultMessage:"Email notifications are not enabled"});return c.a.createElement(E.a,{title:Object(b.ab)("user.settings.notifications.emailNotifications","Email notifications"),describe:e,focused:s,section:"email",updateSection:a.handleUpdateSection})}),Sa(Ea(a),"renderMaxSettingView",function(){if(!a.props.sendEmailNotifications)return c.a.createElement(v.a,{title:Object(b.ab)("user.settings.notifications.emailNotifications","Email notifications"),inputs:[c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-top"},c.a.createElement(g.c,{id:"user.settings.notifications.email.disabled_long",defaultMessage:"Email notifications have not been enabled by your System Administrator."}))],server_error:a.props.serverError,section:"email",updateSection:a.handleUpdateSection});var e=a.state.newInterval,t=null,n=null;return a.props.enableEmailBatching&&(t=c.a.createElement("fieldset",null,c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationMinutes",type:"radio",name:"emailNotifications",checked:e===f.z.INTERVAL_FIFTEEN_MINUTES,"data-enable-email":"true","data-email-interval":f.z.INTERVAL_FIFTEEN_MINUTES,onChange:a.handleChange}),c.a.createElement(g.c,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count} minutes",values:{count:f.z.INTERVAL_FIFTEEN_MINUTES/_a}}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationHour",type:"radio",name:"emailNotifications",checked:e===f.z.INTERVAL_HOUR,"data-enable-email":"true","data-email-interval":f.z.INTERVAL_HOUR,onChange:a.handleChange}),c.a.createElement(g.c,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"})))),n=c.a.createElement(g.c,{id:"user.settings.notifications.emailBatchingInfo",defaultMessage:"Notifications received over the time period selected are combined and sent in a single email."})),c.a.createElement(v.a,{title:Object(b.ab)("user.settings.notifications.emailNotifications","Email notifications"),inputs:[c.a.createElement("fieldset",{key:"userNotificationEmailOptions"},c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.notifications.email.send",defaultMessage:"Send email notifications"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationImmediately",type:"radio",name:"emailNotifications",checked:e===f.z.INTERVAL_IMMEDIATE,"data-enable-email":"true","data-email-interval":f.z.INTERVAL_IMMEDIATE,onChange:a.handleChange}),c.a.createElement(g.c,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"}))),t,c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationNever",type:"radio",name:"emailNotifications",checked:e===f.z.INTERVAL_NEVER,"data-enable-email":"false","data-email-interval":f.z.INTERVAL_NEVER,onChange:a.handleChange}),c.a.createElement(g.c,{id:"user.settings.notifications.email.never",defaultMessage:"Never"}))),c.a.createElement("div",{className:"margin-top x2"},c.a.createElement(g.c,{id:"user.settings.notifications.emailInfo",defaultMessage:"Email notifications are sent for mentions and direct messages when you are offline or away from {siteName} for more than 5 minutes.",values:{siteName:a.props.siteName}})," ",n))],submit:a.handleSubmit,saving:a.props.saving,server_error:a.props.serverError,updateSection:a.handleUpdateSection})});var i=e.emailInterval,r=e.enableEmail,o=e.enableEmailBatching,l=e.sendEmailNotifications;return a.state={emailInterval:i,enableEmailBatching:o,sendEmailNotifications:l,newInterval:Object(pa.getEmailInterval)(r&&l,o,i)},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ya(e,t)}(t,c.a.Component),a=t,s=[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.emailInterval,n=e.enableEmail,s=e.enableEmailBatching,i=e.sendEmailNotifications;return i!==t.sendEmailNotifications||s!==t.enableEmailBatching||a!==t.emailInterval?{emailInterval:a,enableEmailBatching:s,sendEmailNotifications:i,newInterval:Object(pa.getEmailInterval)(n&&i,s,a)}:null}}],(n=[{key:"render",value:function(){return"email"!==this.props.activeSection?this.renderMinSettingView():this.renderMaxSettingView()}}])&&ba(a.prototype,n),s&&ba(a,s),t}();Sa(Oa,"propTypes",{currentUserId:r.a.string.isRequired,activeSection:r.a.string.isRequired,updateSection:r.a.func.isRequired,enableEmail:r.a.bool.isRequired,emailInterval:r.a.number.isRequired,onSubmit:r.a.func.isRequired,onCancel:r.a.func.isRequired,onChange:r.a.func.isRequired,serverError:r.a.string,saving:r.a.bool,focused:r.a.bool,sendEmailNotifications:r.a.bool,enableEmailBatching:r.a.bool,siteName:r.a.string,actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired});var wa=Object(n.connect)(function(e){var t=Object(u.getConfig)(e),a=parseInt(Object(d.get)(e,_.Preferences.CATEGORY_NOTIFICATIONS,_.Preferences.EMAIL_INTERVAL,_.Preferences.INTERVAL_NOT_SET.toString()),10);return{currentUserId:Object(ma.getCurrentUserId)(e),emailInterval:a,enableEmailBatching:"true"===t.EnableEmailBatching,sendEmailNotifications:"true"===t.SendEmailNotifications}},function(e){return{actions:Object(l.bindActionCreators)({savePreferences:m.savePreferences},e)}})(Oa),ka=a(1781);function Ma(e){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Na(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ca(e){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aa(e,t){return(Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ja=function(e){function t(){var e,a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=this,s=(e=Ca(t)).call.apply(e,[this].concat(r)),a=!s||"object"!==Ma(s)&&"function"!=typeof s?Ta(n):s,Pa(Ta(a),"handleAutoResponderChecked",function(e){a.props.setParentState("autoResponderActive",e.target.checked)}),Pa(Ta(a),"onMessageChanged",function(e){a.props.setParentState("autoResponderMessage",e.target.value)}),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aa(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"render",value:function(){var e,t=this.props,a=t.autoResponderActive,n=t.autoResponderMessage;this.props.error&&(e=c.a.createElement("label",{className:"has-error"},this.props.error));var s=[],i=c.a.createElement("div",{id:"autoResponderCheckbox",key:"autoResponderCheckbox",className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"autoResponderActive",type:"checkbox",checked:a,onChange:this.handleAutoResponderChecked}),c.a.createElement(g.c,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}))),r=c.a.createElement("div",{id:"autoResponderMessage",key:"autoResponderMessage"},c.a.createElement("div",{className:"padding-top"},c.a.createElement(ka.a,{style:{resize:"none"},id:"autoResponderMessageInput",className:"form-control",rows:"5",placeholder:Object(b.ab)("user.settings.notifications.autoResponderPlaceholder","Message"),value:n,maxLength:200,onChange:this.onMessageChanged}),e));return s.push(i),a&&s.push(r),s.push(c.a.createElement("div",{key:"autoResponderHint",className:"margin-top x3"},c.a.createElement(g.b,{id:"user.settings.notifications.autoResponderHint",defaultMessage:"Set a custom message that will be automatically sent in response to Direct Messages. Mentions in Public and Private Channels will not trigger the automated reply. Enabling Automatic Replies sets your status to Out of Office and disables email and push notifications."}))),c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",shiftEnter:!0,submit:this.props.submit,saving:this.props.saving,inputs:s,updateSection:this.props.updateSection})}}])&&Na(a.prototype,n),s&&Na(a,s),t}();function Ra(e){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ia(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function La(e){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Da(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xa(e,t){return(xa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ua(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Fa(e){var t=e.user,a=f.s.MENTION,n="true",s="never",i="true",r=f.s.MENTION,o=f.Q.UserStatuses.AWAY,c=!1,l=b.ab("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages.");t.notify_props&&(t.notify_props.desktop&&(a=t.notify_props.desktop),t.notify_props.desktop_sound&&(n=t.notify_props.desktop_sound),t.notify_props.comments&&(s=t.notify_props.comments),t.notify_props.email&&(i=t.notify_props.email),t.notify_props.push&&(r=t.notify_props.push),t.notify_props.push_status&&(o=t.notify_props.push_status),t.notify_props.auto_responder_active&&(c="true"===t.notify_props.auto_responder_active),t.notify_props.auto_responder_message&&(l=t.notify_props.auto_responder_message));var u=!1,d="",m=!1,p=!1;if(t.notify_props){if(t.notify_props.mention_keys){var g=t.notify_props.mention_keys.split(",");-1===g.indexOf(t.username)?u=!1:(u=!0,g.splice(g.indexOf(t.username),1),-1!==g.indexOf("@".concat(t.username))&&g.splice(g.indexOf("@".concat(t.username)),1)),d=g.join(",")}t.notify_props.first_name&&(m="true"===t.notify_props.first_name),t.notify_props.channel&&(p="true"===t.notify_props.channel)}return{desktopActivity:a,enableEmail:i,pushActivity:r,pushStatus:o,desktopSound:n,usernameKey:u,customKeys:d,customKeysChecked:d.length>0,firstNameKey:m,channelKey:p,autoResponderActive:c,autoResponderMessage:l,notifyCommentsLevel:s,isSaving:!1}}Pa(ja,"propTypes",{autoResponderActive:r.a.bool.isRequired,autoResponderMessage:r.a.string.isRequired,updateSection:r.a.func.isRequired,setParentState:r.a.func.isRequired,submit:r.a.func.isRequired,saving:r.a.bool.isRequired,error:r.a.string});var za=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=La(t).call(this,e),a=!s||"object"!==Ra(s)&&"function"!=typeof s?Da(n):s,Ua(Da(a),"handleSubmit",function(){var e={};e.email=a.state.enableEmail,e.desktop_sound=a.state.desktopSound,e.desktop=a.state.desktopActivity,e.push=a.state.pushActivity,e.push_status=a.state.pushStatus,e.comments=a.state.notifyCommentsLevel,e.auto_responder_active=a.state.autoResponderActive.toString(),e.auto_responder_message=a.state.autoResponderMessage,e.auto_responder_message&&""!==e.auto_responder_message||(e.auto_responder_message=b.ab("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages."));var t=[];a.state.usernameKey&&t.push(a.props.user.username);var n=t.join(",");a.state.customKeys.length>0&&a.state.customKeysChecked&&(n+=","+a.state.customKeys),e.mention_keys=n,e.first_name=a.state.firstNameKey.toString(),e.channel=a.state.channelKey.toString(),a.setState({isSaving:!0}),a.props.actions.updateMe({notify_props:e}).then(function(e){var t=e.data,n=e.error;t?(a.updateSection(""),a.setState(Fa(a.props))):n&&a.setState({serverError:n.message,isSaving:!1})})}),Ua(Da(a),"handleCancel",function(e){e&&e.preventDefault(),a.setState(Fa(a.props))}),Ua(Da(a),"handleUpdateSection",function(e){e?a.props.updateSection(e):(a.props.updateSection(""),a.handleCancel())}),Ua(Da(a),"setStateValue",function(e,t){var n={};n[e]=t,a.setState(n)}),Ua(Da(a),"updateSection",function(e){a.setState({isSaving:!1}),a.props.updateSection(e)}),Ua(Da(a),"handleEmailRadio",function(e){a.setState({enableEmail:e})}),Ua(Da(a),"updateUsernameKey",function(e){a.setState({usernameKey:e})}),Ua(Da(a),"updateFirstNameKey",function(e){a.setState({firstNameKey:e})}),Ua(Da(a),"updateChannelKey",function(e){a.setState({channelKey:e})}),Ua(Da(a),"updateCustomMentionKeys",function(){if(a.refs.customcheck.checked){var e=a.refs.custommentions.value;a.setState({customKeys:e.replace(/ /g,""),customKeysChecked:!0})}else a.setState({customKeys:"",customKeysChecked:!1})}),Ua(Da(a),"onCustomChange",function(){a.refs.customcheck.checked=!0,a.updateCustomMentionKeys()}),Ua(Da(a),"createPushNotificationSection",function(){if("push"===a.props.activeSection){var e=[],t=null,n=null;if(a.props.sendPushNotifications){var s=[!1,!1,!1];a.state.pushActivity===f.s.ALL?s[0]=!0:a.state.pushActivity===f.s.NONE?s[2]=!0:s[1]=!0;var i,r=[!1,!1,!1];a.state.pushStatus===f.Q.UserStatuses.ONLINE?r[0]=!0:a.state.pushStatus===f.Q.UserStatuses.AWAY?r[1]=!0:r[2]=!0,a.state.pushActivity!==f.s.NONE&&(i=c.a.createElement("fieldset",null,c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.notifications.push_notification.status",defaultMessage:"Trigger push notifications when"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationOnline",type:"radio",name:"pushNotificationStatus",checked:r[0],onChange:a.handlePushStatusRadio.bind(Da(a),f.Q.UserStatuses.ONLINE)}),c.a.createElement(g.c,{id:"user.settings.push_notification.online",defaultMessage:"Online, away or offline"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationAway",type:"radio",name:"pushNotificationStatus",checked:r[1],onChange:a.handlePushStatusRadio.bind(Da(a),f.Q.UserStatuses.AWAY)}),c.a.createElement(g.c,{id:"user.settings.push_notification.away",defaultMessage:"Away or offline"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationOffline",type:"radio",name:"pushNotificationStatus",checked:r[2],onChange:a.handlePushStatusRadio.bind(Da(a),f.Q.UserStatuses.OFFLINE)}),c.a.createElement(g.c,{id:"user.settings.push_notification.offline",defaultMessage:"Offline"})))),t=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.push_notification.status_info",defaultMessage:"Notification alerts are only pushed to your mobile device when your online status matches the selection above."}))),e.push(c.a.createElement("div",null,c.a.createElement("fieldset",{key:"userNotificationLevelOption"},c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.push_notification.send",defaultMessage:"Send mobile push notifications"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationAllActivity",type:"radio",name:"pushNotificationLevel",checked:s[0],onChange:a.handlePushRadio.bind(Da(a),f.s.ALL)}),c.a.createElement(g.c,{id:"user.settings.push_notification.allActivity",defaultMessage:"For all activity"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationMentions",type:"radio",name:"pushNotificationLevel",checked:s[1],onChange:a.handlePushRadio.bind(Da(a),f.s.MENTION)}),c.a.createElement(g.c,{id:"user.settings.push_notification.onlyMentions",defaultMessage:"For mentions and direct messages"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationNever",type:"radio",name:"pushNotificationLevel",checked:s[2],onChange:a.handlePushRadio.bind(Da(a),f.s.NONE)}),c.a.createElement(g.c,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.push_notification.info",defaultMessage:"Notification alerts are pushed to your mobile device when there is activity in Mattermost."}))),c.a.createElement("hr",null),i)),n=a.handleSubmit}else e.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-top"},c.a.createElement(g.c,{id:"user.settings.push_notification.disabled_long",defaultMessage:"Push notifications have not been enabled by your System Administrator."})));return c.a.createElement(v.a,{title:b.ab("user.settings.notifications.push","Mobile push notifications"),extraInfo:t,inputs:e,submit:n,server_error:a.state.serverError,updateSection:a.handleUpdateSection})}var o="";return o=a.state.pushActivity===f.s.ALL?a.state.pushStatus===f.Q.UserStatuses.AWAY?c.a.createElement(g.c,{id:"user.settings.push_notification.allActivityAway",defaultMessage:"For all activity when away or offline"}):a.state.pushStatus===f.Q.UserStatuses.OFFLINE?c.a.createElement(g.c,{id:"user.settings.push_notification.allActivityOffline",defaultMessage:"For all activity when offline"}):c.a.createElement(g.c,{id:"user.settings.push_notification.allActivityOnline",defaultMessage:"For all activity when online, away or offline"}):a.state.pushActivity===f.s.NONE?c.a.createElement(g.c,{id:"user.settings.notifications.never",defaultMessage:"Never"}):a.props.sendPushNotifications?a.state.pushStatus===f.Q.UserStatuses.AWAY?c.a.createElement(g.c,{id:"user.settings.push_notification.onlyMentionsAway",defaultMessage:"For mentions and direct messages when away or offline"}):a.state.pushStatus===f.Q.UserStatuses.OFFLINE?c.a.createElement(g.c,{id:"user.settings.push_notification.onlyMentionsOffline",defaultMessage:"For mentions and direct messages when offline"}):c.a.createElement(g.c,{id:"user.settings.push_notification.onlyMentionsOnline",defaultMessage:"For mentions and direct messages when online, away or offline"}):c.a.createElement(g.c,{id:"user.settings.push_notification.disabled",defaultMessage:"Push notifications are not enabled"}),c.a.createElement(E.a,{title:b.ab("user.settings.notifications.push","Mobile push notifications"),describe:o,section:"push",updateSection:a.handleUpdateSection})}),a.state=Fa(e),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xa(e,t)}(t,c.a.Component),a=t,(n=[{key:"handleNotifyCommentsRadio",value:function(e){this.setState({notifyCommentsLevel:e})}},{key:"handlePushRadio",value:function(e){this.setState({pushActivity:e})}},{key:"handlePushStatusRadio",value:function(e){this.setState({pushStatus:e})}},{key:"render",value:function(){var e,t,a,n=this,s=this.state.serverError,i=this.props.user;if("keys"===this.props.activeSection){var r=[];if(i.first_name){r.push(c.a.createElement("div",{key:"userNotificationFirstNameOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerFirst",type:"checkbox",checked:this.state.firstNameKey,onChange:function(e){n.updateFirstNameKey(e.target.checked)}}),c.a.createElement(g.c,{id:"user.settings.notifications.sensitiveName",defaultMessage:'Your case sensitive first name "{first_name}"',values:{first_name:i.first_name}})))))}r.push(c.a.createElement("div",{key:"userNotificationUsernameOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerUsername",type:"checkbox",checked:this.state.usernameKey,onChange:function(e){n.updateUsernameKey(e.target.checked)}}),c.a.createElement(g.c,{id:"user.settings.notifications.sensitiveUsername",defaultMessage:'Your non-case sensitive username "{username}"',values:{username:i.username}})))));r.push(c.a.createElement("div",{key:"userNotificationChannelOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerShouts",type:"checkbox",checked:this.state.channelKey,onChange:function(e){n.updateChannelKey(e.target.checked)}}),c.a.createElement(g.c,{id:"user.settings.notifications.channelWide",defaultMessage:'Channel-wide mentions "@channel", "@all", "@here"'}))))),r.push(c.a.createElement("div",{key:"userNotificationCustomOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerCustom",ref:"customcheck",type:"checkbox",checked:this.state.customKeysChecked,onChange:this.updateCustomMentionKeys}),c.a.createElement(g.c,{id:"user.settings.notifications.sensitiveWords",defaultMessage:"Other non-case sensitive words, separated by commas:"}))),c.a.createElement("input",{id:"notificationTriggerCustomText",autoFocus:this.state.customKeysChecked,ref:"custommentions",className:"form-control mentions-input",type:"text",defaultValue:this.state.customKeys,onChange:this.onCustomChange,onFocus:b.cb,"aria-labelledby":"notificationTriggerCustom"})));var o=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.notifications.mentionsInfo",defaultMessage:"Mentions trigger when someone sends a message that includes your username (@{username}) or any of the options selected above.",values:{username:i.username}}));e=c.a.createElement(v.a,{title:b.ab("user.settings.notifications.wordsTrigger","Words that trigger mentions"),inputs:r,submit:this.handleSubmit,saving:this.state.isSaving,server_error:s,updateSection:this.handleUpdateSection,extraInfo:o})}else{var l=["@"+i.username];this.state.firstNameKey&&l.push(i.first_name),this.state.usernameKey&&l.push(i.username),this.state.channelKey&&(l.push("@channel"),l.push("@all"),l.push("@here")),this.state.customKeys.length>0&&(l=l.concat(this.state.customKeys.split(",")));for(var u="",d=0;d<l.length;d++)""!==l[d]&&(u+='"'+l[d]+'", ');u=u.length>0?u.substring(0,u.length-2):c.a.createElement(g.c,{id:"user.settings.notifications.noWords",defaultMessage:"No words configured"}),e=c.a.createElement(E.a,{title:b.ab("user.settings.notifications.wordsTrigger","Words that trigger mentions"),describe:u,section:"keys",updateSection:this.handleUpdateSection})}if("comments"===this.props.activeSection){var m=[!1,!1,!1];"never"===this.state.notifyCommentsLevel?m[2]=!0:"root"===this.state.notifyCommentsLevel?m[1]=!0:m[0]=!0;var p=[];p.push(c.a.createElement("fieldset",{key:"userNotificationLevelOption"},c.a.createElement("legend",{className:"form-legend hidden-label"},b.ab("user.settings.notifications.comments","Reply notifications")),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationCommentsAny",type:"radio",name:"commentsNotificationLevel",checked:m[0],onChange:this.handleNotifyCommentsRadio.bind(this,"any")}),c.a.createElement(g.c,{id:"user.settings.notifications.commentsAny",defaultMessage:"Trigger notifications on messages in reply threads that I start or participate in"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationCommentsRoot",type:"radio",name:"commentsNotificationLevel",checked:m[1],onChange:this.handleNotifyCommentsRadio.bind(this,"root")}),c.a.createElement(g.c,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Trigger notifications on messages in threads that I start"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationCommentsNever",type:"radio",name:"commentsNotificationLevel",checked:m[2],onChange:this.handleNotifyCommentsRadio.bind(this,"never")}),c.a.createElement(g.c,{id:"user.settings.notifications.commentsNever",defaultMessage:"Do not trigger notifications on messages in reply threads unless I'm mentioned"})))));var f=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.notifications.commentsInfo",defaultMessage:"In addition to notifications for when you're mentioned, select if you would like to receive notifications on reply threads."}));t=c.a.createElement(v.a,{title:b.ab("user.settings.notifications.comments","Reply notifications"),extraInfo:f,inputs:p,submit:this.handleSubmit,saving:this.state.isSaving,server_error:s,updateSection:this.handleUpdateSection})}else{var h="";h="never"===this.state.notifyCommentsLevel?c.a.createElement(g.c,{id:"user.settings.notifications.commentsNever",defaultMessage:"Do not trigger notifications on messages in reply threads unless I'm mentioned"}):"root"===this.state.notifyCommentsLevel?c.a.createElement(g.c,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Trigger notifications on messages in threads that I start"}):c.a.createElement(g.c,{id:"user.settings.notifications.commentsAny",defaultMessage:"Trigger notifications on messages in reply threads that I start or participate in"}),t=c.a.createElement(E.a,{title:b.ab("user.settings.notifications.comments","Reply notifications"),describe:h,section:"comments",updateSection:this.handleUpdateSection})}if(this.props.enableAutoResponder)if("auto-responder"===this.props.activeSection)a=c.a.createElement("div",null,c.a.createElement(ja,{autoResponderActive:this.state.autoResponderActive,autoResponderMessage:this.state.autoResponderMessage,updateSection:this.updateSection,setParentState:this.setStateValue,submit:this.handleSubmit,error:this.state.serverError,saving:this.state.isSaving}),c.a.createElement("div",{className:"divider-dark"}));else{var y=this.state.autoResponderActive?c.a.createElement(g.c,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}):c.a.createElement(g.c,{id:"user.settings.notifications.autoResponderDisabled",defaultMessage:"Disabled"});a=c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",describe:y,section:"auto-responder",updateSection:this.updateSection})}var S=this.createPushNotificationSection();return c.a.createElement("div",{id:"notificationSettings"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement(g.c,{id:"generic_icons.collapse",defaultMessage:"Collapse Icon"},function(e){return c.a.createElement("i",{className:"fa fa-angle-left",title:e,onClick:n.props.collapseModal})})),c.a.createElement(g.c,{id:"user.settings.notifications.title",defaultMessage:"Notification Settings"}))),c.a.createElement("div",{ref:"wrapper",className:"user-settings"},c.a.createElement("h3",{id:"notificationSettingsTitle",className:"tab-header"},c.a.createElement(g.c,{id:"user.settings.notifications.header",defaultMessage:"Notifications"})),c.a.createElement("div",{className:"divider-dark first"}),c.a.createElement(da,{activity:this.state.desktopActivity,sound:this.state.desktopSound,updateSection:this.handleUpdateSection,setParentState:this.setStateValue,submit:this.handleSubmit,saving:this.state.isSaving,cancel:this.handleCancel,error:this.state.serverError,active:"desktop"===this.props.activeSection}),c.a.createElement("div",{className:"divider-light"}),c.a.createElement(wa,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,enableEmail:"true"===this.state.enableEmail,onSubmit:this.handleSubmit,onCancel:this.handleCancel,onChange:this.handleEmailRadio,saving:this.state.isSaving,serverError:this.state.serverError,siteName:this.props.siteName}),c.a.createElement("div",{className:"divider-light"}),S,c.a.createElement("div",{className:"divider-light"}),e,c.a.createElement("div",{className:"divider-light"}),t,c.a.createElement("div",{className:"divider-light"}),a,c.a.createElement("div",{className:"divider-dark"})))}}])&&Ia(a.prototype,n),s&&Ia(a,s),t}();Ua(za,"propTypes",{user:r.a.object,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,siteName:r.a.string,sendPushNotifications:r.a.bool,enableAutoResponder:r.a.bool,actions:r.a.shape({updateMe:r.a.func.isRequired}).isRequired}),Ua(za,"defaultProps",{user:null,activeSection:"",activeTab:""});var qa=Object(n.connect)(function(e){var t=Object(u.getConfig)(e);return{siteName:t.SiteName,sendPushNotifications:"true"===t.SendPushNotifications,enableAutoResponder:"true"===t.ExperimentalEnableAutomaticReplies}},function(e){return{actions:Object(l.bindActionCreators)({updateMe:p.updateMe},e)}})(za),Ga=a(1512),Ba=a(107),Ha=a(1482),Va=a(433),Ya=a.n(Va),Wa=a(1739),Ka=a(1736),Qa=a(1494);function Ja(e){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Za(e){return(Za=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e,t){return(en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var an=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=Za(t).call(this,e),a=!s||"object"!==Ja(s)&&"function"!=typeof s?$a(n):s,tn($a(a),"onShow",function(){a.props.actions.getUserAudits(a.props.currentUserId,0,200),Object(b.U)()||X()(".modal-body").perfectScrollbar()}),tn($a(a),"onHide",function(){a.setState({show:!1})}),a.state={show:!0},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"componentDidMount",value:function(){this.onShow()}},{key:"render",value:function(){var e;return e=0===this.props.userAudits.length?c.a.createElement(Qa.a,null):c.a.createElement(Ka.a,{audits:this.props.userAudits,showIp:!0,showSession:!0}),c.a.createElement(Wa.a,{dialogClassName:"a11y__modal modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large",role:"dialog","aria-labelledby":"accessHistoryModalLabel"},c.a.createElement(Wa.a.Header,{closeButton:!0},c.a.createElement(Wa.a.Title,{componentClass:"h1",id:"accessHistoryModalLabel"},c.a.createElement(g.c,{id:"access_history.title",defaultMessage:"Access History"}))),c.a.createElement(Wa.a.Body,{ref:"modalBody"},e),c.a.createElement(Wa.a.Footer,{className:"modal-footer--invisible"},c.a.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},c.a.createElement(g.c,{id:"general_button.close",defaultMessage:"Close"}))))}}])&&Xa(a.prototype,n),s&&Xa(a,s),t}();tn(an,"propTypes",{onHide:r.a.func.isRequired,actions:r.a.shape({getUserAudits:r.a.func.isRequired}).isRequired,userAudits:r.a.array.isRequired,currentUserId:r.a.string.isRequired});var nn=Object(n.connect)(function(e){return{currentUserId:Object(s.getCurrentUserId)(e),userAudits:Object(s.getUserAudits)(e)||[]}},function(e){return{actions:Object(l.bindActionCreators)({getUserAudits:p.getUserAudits},e)}})(an),sn=a(310);function rn(e){var t=e.locale,a=e.currentSession,n=e.moreInfo,s=e.handleMoreInfo;if(n){var i=new Date(a.create_at);return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement(g.c,{id:"activity_log.firstTime",defaultMessage:"First time active: {date}, {time}",values:{date:c.a.createElement(g.a,{value:i,day:"2-digit",month:Object(K.a)(t),year:"numeric"}),time:c.a.createElement(g.d,{value:i,hour:"2-digit",minute:"2-digit"})}})),c.a.createElement("div",null,c.a.createElement(g.c,{id:"activity_log.os",defaultMessage:"OS: {os}",values:{os:a.props.os}})),c.a.createElement("div",null,c.a.createElement(g.c,{id:"activity_log.browser",defaultMessage:"Browser: {browser}",values:{browser:a.props.browser}})),c.a.createElement("div",null,c.a.createElement(g.c,{id:"activity_log.sessionId",defaultMessage:"Session ID: {id}",values:{id:a.id}})))}return c.a.createElement("a",{className:"theme",href:"#",onClick:s},c.a.createElement(g.c,{id:"activity_log.moreInfo",defaultMessage:"More info"}))}function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function un(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(e,t){return(dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}rn.propTypes={locale:r.a.string.isRequired,currentSession:r.a.object.isRequired,handleMoreInfo:r.a.func.isRequired,moreInfo:r.a.bool.isRequired};var pn=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=ln(t).call(this,e),a=!s||"object"!==on(s)&&"function"!=typeof s?un(n):s,mn(un(a),"handleMoreInfo",function(){a.setState({moreInfo:!0})}),mn(un(a),"submitRevoke",function(e){a.props.submitRevoke(a.props.currentSession.id,e)}),mn(un(a),"isMobileSession",function(e){return e.device_id&&(e.device_id.includes("apple")||e.device_id.includes("android"))}),mn(un(a),"mobileSessionInfo",function(e){var t,a,n,s;return e.device_id.includes("apple")?(n="fa fa-apple",s=Object(b.ab)("device_icons.apple","Apple Icon"),t=Object(K.b)("activity_log_modal.iphoneNativeClassicApp"),a="iPhone Native Classic App",e.device_id.includes(_.General.PUSH_NOTIFY_APPLE_REACT_NATIVE)&&(t=Object(K.b)("activity_log_modal.iphoneNativeApp"),a="iPhone Native App")):e.device_id.includes("android")&&(n="fa fa-android",s=Object(b.ab)("device_icons.android","Android Icon"),t=Object(K.b)("activity_log_modal.androidNativeClassicApp"),a="Android Native Classic App",e.device_id.includes(_.General.PUSH_NOTIFY_ANDROID_REACT_NATIVE)&&(t=Object(K.b)("activity_log_modal.androidNativeApp"),a="Android Native App")),{devicePicture:n,deviceTitle:s,devicePlatform:c.a.createElement(g.c,{id:t,defaultMessage:a})}}),a.state={moreInfo:!1},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.index,a=e.locale,n=e.currentSession,s=new Date(n.last_activity_at),i=n.props.platform,r="",o="";if("Windows"===n.props.platform)r="fa fa-windows",o=Object(b.ab)("device_icons.windows","Windows Icon");else if(this.isMobileSession(n)){var l=this.mobileSessionInfo(n);r=l.devicePicture,i=l.devicePlatform}else"Macintosh"===n.props.platform||"iPhone"===n.props.platform?(r="fa fa-apple",o=Object(b.ab)("device_icons.apple","Apple Icon")):"Linux"===n.props.platform?n.props.os.indexOf("Android")>=0?(i=c.a.createElement(g.c,{id:"activity_log_modal.android",defaultMessage:"Android"}),r="fa fa-android",o=Object(b.ab)("device_icons.android","Android Icon")):(r="fa fa-linux",o=Object(b.ab)("device_icons.linux","Linux Icon")):-1!==n.props.os.indexOf("Linux")&&(r="fa fa-linux",o=Object(b.ab)("device_icons.linux","Linux Icon"));return-1!==n.props.browser.indexOf("Desktop App")&&(i=c.a.createElement(g.c,{id:"activity_log_modal.desktop",defaultMessage:"Native Desktop App"})),c.a.createElement("div",{key:"activityLogEntryKey"+t,className:"activity-log__table"},c.a.createElement("div",{className:"activity-log__report"},c.a.createElement("div",{className:"report__platform"},c.a.createElement("i",{className:r,title:o}),i),c.a.createElement("div",{className:"report__info"},c.a.createElement("div",null,c.a.createElement(g.c,{id:"activity_log.lastActivity",defaultMessage:"Last activity: {date}, {time}",values:{date:c.a.createElement(g.a,{value:s,day:"2-digit",month:Object(K.a)(a),year:"numeric"}),time:c.a.createElement(g.d,{value:s,hour:"2-digit",minute:"2-digit"})}})),c.a.createElement(rn,{locale:a,currentSession:n,moreInfo:this.state.moreInfo,handleMoreInfo:this.handleMoreInfo}))),c.a.createElement("div",{className:"activity-log__action"},c.a.createElement("button",{onClick:this.submitRevoke,className:"btn btn-primary"},c.a.createElement(g.c,{id:"activity_log.logout",defaultMessage:"Logout"}))))}}])&&cn(a.prototype,n),s&&cn(a,s),t}();function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vn(e,t){return(vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function En(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}mn(pn,"propTypes",{index:r.a.number.isRequired,locale:r.a.string.isRequired,currentSession:r.a.object.isRequired,submitRevoke:r.a.func.isRequired});var yn=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=hn(t).call(this,e),a=!s||"object"!==fn(s)&&"function"!=typeof s?bn(n):s,En(bn(a),"submitRevoke",function(e,t){t.preventDefault();var n=X()(t.target).closest(".modal-content");n.addClass("animation--highlight"),setTimeout(function(){n.removeClass("animation--highlight")},1500),a.props.actions.revokeSession(a.props.currentUserId,e).then(function(){a.props.actions.getSessions(a.props.currentUserId)})}),En(bn(a),"onShow",function(){a.props.actions.getSessions(a.props.currentUserId),Object(b.U)()||X()(".modal-body").perfectScrollbar()}),En(bn(a),"onHide",function(){a.setState({show:!1})}),a.state={show:!0},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vn(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"componentDidMount",value:function(){this.onShow()}},{key:"render",value:function(){var e,t=this;if(this.props.sessions.loading)e=c.a.createElement(Qa.a,null);else{var a=this.props.sessions.reduce(function(e,a,n){return"UserAccessToken"===a.props.type?e:(e.push(c.a.createElement(pn,{key:a.id,index:n,locale:t.props.locale,currentSession:a,submitRevoke:t.submitRevoke})),e)},[]);e=c.a.createElement("form",{role:"form"},a)}return c.a.createElement(Wa.a,{dialogClassName:"a11y__modal modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large",role:"dialog","aria-labelledby":"activityLogModalLabel"},c.a.createElement(Wa.a.Header,{closeButton:!0},c.a.createElement(Wa.a.Title,{componentClass:"h1",id:"activityLogModalLabel"},c.a.createElement(g.c,{id:"activity_log.activeSessions",defaultMessage:"Active Sessions"}))),c.a.createElement(Wa.a.Body,{ref:"modalBody"},c.a.createElement("p",{className:"session-help-text"},c.a.createElement(g.c,{id:"activity_log.sessionsDescription",defaultMessage:"Sessions are created when you log in to a new browser on a device. Sessions let you use Mattermost without having to log in again for a time period specified by the System Admin. If you want to log out sooner, use the 'Logout' button below to end a session."})),e),c.a.createElement(Wa.a.Footer,{className:"modal-footer--invisible"},c.a.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},c.a.createElement(g.c,{id:"general_button.close",defaultMessage:"Close"}))))}}])&&gn(a.prototype,n),s&&gn(a,s),t}();En(yn,"propTypes",{currentUserId:r.a.string.isRequired,sessions:r.a.oneOfType([r.a.array,r.a.object]).isRequired,locale:r.a.string.isRequired,onHide:r.a.func.isRequired,actions:r.a.shape({getSessions:r.a.func.isRequired,revokeSession:r.a.func.isRequired}).isRequired});var Sn=Object(n.connect)(function(e){return{currentUserId:Object(s.getCurrentUserId)(e),sessions:Object(s.getUserSessions)(e),locale:Object(sn.a)(e)}},function(e){return{actions:Object(l.bindActionCreators)({getSessions:p.getSessions,revokeSession:p.revokeSession},e)}})(yn),_n=a(1602),On=a(1719),wn=a(119);function kn(e){return(kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function Nn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cn(e){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function An(e,t){return(An=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var jn=function(e){function t(){var e,a,n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=this,s=(e=Cn(t)).call.apply(e,[this].concat(r)),a=!s||"object"!==kn(s)&&"function"!=typeof s?Tn(n):s,Pn(Tn(a),"state",{serverError:null}),Pn(Tn(a),"setupMfa",function(e){e.preventDefault(),wn.a.push("/mfa/setup")}),Pn(Tn(a),"removeMfa",function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a.props.actions.deactivateMfa();case 3:if(n=e.sent,!(s=n.error)){e.next=8;break}return a.setState({serverError:s.message}),e.abrupt("return");case 8:if(!a.props.mfaEnforced){e.next=11;break}return wn.a.push("/mfa/setup"),e.abrupt("return");case 11:a.props.updateSection(""),a.setState({serverError:null});case 13:case"end":return e.stop()}},e)}),function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){Mn(i,n,s,r,o,"next",e)}function o(e){Mn(i,n,s,r,o,"throw",e)}r(void 0)})});return function(e){return t.apply(this,arguments)}}()),Pn(Tn(a),"renderTitle",function(){return c.a.createElement(g.c,{id:"user.settings.mfa.title",defaultMessage:"Multi-factor Authentication"})}),Pn(Tn(a),"renderDescription",function(){return a.props.mfaActive?c.a.createElement(g.c,{id:"user.settings.security.active",defaultMessage:"Active"}):c.a.createElement(g.c,{id:"user.settings.security.inactive",defaultMessage:"Inactive"})}),Pn(Tn(a),"renderContent",function(){var e,t;a.props.mfaActive?(t=a.props.mfaEnforced?c.a.createElement(g.c,{id:"user.settings.mfa.reset",defaultMessage:"Reset MFA on your account"}):c.a.createElement(g.c,{id:"user.settings.mfa.remove",defaultMessage:"Remove MFA from your account"}),e=c.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:a.removeMfa},t)):e=c.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:a.setupMfa},c.a.createElement(g.c,{id:"user.settings.mfa.add",defaultMessage:"Add MFA to your account"}));return c.a.createElement("div",{className:"padding-top"},e,c.a.createElement("br",null))}),Pn(Tn(a),"renderHelpText",function(){return a.props.mfaActive?a.props.mfaEnforced?c.a.createElement(g.c,{id:"user.settings.mfa.requiredHelp",defaultMessage:"Multi-factor authentication is required on this server. Resetting is only recommended when you need to switch code generation to a new mobile device. You will be required to set it up again immediately."}):c.a.createElement(g.c,{id:"user.settings.mfa.removeHelp",defaultMessage:"Removing multi-factor authentication means you will no longer require a phone-based passcode to sign-in to your account."}):c.a.createElement(g.c,{id:"user.settings.mfa.addHelp",defaultMessage:"Adding multi-factor authentication will make your account more secure by requiring a code from your mobile phone each time you sign in."})}),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&An(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"render",value:function(){var e=this.renderTitle();return this.props.mfaAvailable?this.props.active?c.a.createElement(v.a,{title:e,inputs:this.renderContent(),extraInfo:this.renderHelpText(),serverError:this.state.serverError,updateSection:this.props.updateSection,width:"medium"}):c.a.createElement(E.a,{title:e,describe:this.renderDescription(),section:"mfa",updateSection:this.props.updateSection}):null}}])&&Nn(a.prototype,n),s&&Nn(a,s),t}();Pn(jn,"propTypes",{active:r.a.bool.isRequired,mfaActive:r.a.bool.isRequired,mfaAvailable:r.a.bool.isRequired,mfaEnforced:r.a.bool.isRequired,updateSection:r.a.func.isRequired,actions:r.a.shape({deactivateMfa:r.a.func.isRequired})});var Rn=Object(n.connect)(function(e){var t=Object(u.getLicense)(e),a=Object(u.getConfig)(e),n=t&&"true"===t.IsLicensed&&"true"===t.MFA,i="true"===a.EnableMultifactorAuthentication,r=n&&"true"===a.EnforceMultifactorAuthentication,o=Object(s.getCurrentUser)(e),c=!1,l=!1;return o&&(c=o.mfa_active,l=i&&(""===o.auth_service||o.auth_service===f.Q.LDAP_SERVICE)),{mfaActive:c,mfaAvailable:l,mfaEnforced:r}},function(e){return{actions:Object(l.bindActionCreators)({deactivateMfa:On.b},e)}})(jn),In=(a(945),a(1521)),Ln=a(1542);function Dn(e){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function Un(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){xn(i,n,s,r,o,"next",e)}function o(e){xn(i,n,s,r,o,"throw",e)}r(void 0)})}}function Fn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zn(e){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Hn="creating",Vn="created",Yn="not_creating",Wn=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=zn(t).call(this,e),a=!s||"object"!==Dn(s)&&"function"!=typeof s?qn(n):s,Bn(qn(a),"startCreatingToken",function(){a.setState({tokenCreationState:Hn})}),Bn(qn(a),"stopCreatingToken",function(){a.setState({tokenCreationState:Yn,saving:!1})}),Bn(qn(a),"handleCreateToken",Un(regeneratorRuntime.mark(function e(){var t,n,s,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.handleCancelConfirm(),""!==(t=a.refs.newtokendescription?a.refs.newtokendescription.value:"")){e.next=5;break}return a.setState({tokenError:b.ab("user.settings.tokens.nameRequired","Please enter a description.")}),e.abrupt("return");case 5:return a.setState({tokenError:"",saving:!0}),a.props.setRequireConfirm(!0,a.confirmCopyToken),n=a.props.user?a.props.user.id:"",e.next=10,a.props.actions.createUserAccessToken(n,t);case 10:s=e.sent,i=s.data,r=s.error,i&&a.state.tokenCreationState===Hn?a.setState({tokenCreationState:Vn,newToken:i,saving:!1}):r&&a.setState({serverError:r.message,saving:!1});case 14:case"end":return e.stop()}},e)}))),Bn(qn(a),"confirmCopyToken",function(e){a.setState({showConfirmModal:!0,confirmTitle:c.a.createElement(g.c,{id:"user.settings.tokens.confirmCopyTitle",defaultMessage:"Have you copied your token?"}),confirmMessage:function(e){return c.a.createElement("div",null,c.a.createElement(g.b,{id:"user.settings.tokens.confirmCopyMessage",defaultMessage:"Make sure you have copied and saved the access token below. You won't be able to see it again!"}),c.a.createElement("br",null),c.a.createElement("br",null),e.tokenCreationState===Hn?c.a.createElement("div",null,c.a.createElement("strong",{className:"word-break--all"},c.a.createElement(g.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "})),c.a.createElement(g.c,{id:"user.settings.tokens.tokenLoading",defaultMessage:"Loading..."})):c.a.createElement("strong",{className:"word-break--all"},c.a.createElement(g.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),e.newToken.token))},confirmButton:c.a.createElement(g.c,{id:"user.settings.tokens.confirmCopyButton",defaultMessage:"Yes, I have copied the token"}),confirmComplete:function(){a.handleCancelConfirm(),e()},confirmHideCancel:!0})}),Bn(qn(a),"handleCancelConfirm",function(){a.setState({showConfirmModal:!1,confirmTitle:null,confirmMessage:null,confirmButton:null,confirmComplete:null,confirmHideCancel:!1})}),Bn(qn(a),"confirmCreateToken",function(){Ba.isSystemAdmin(a.props.user.roles)?a.setState({showConfirmModal:!0,confirmTitle:c.a.createElement(g.c,{id:"user.settings.tokens.confirmCreateTitle",defaultMessage:"Create System Admin Personal Access Token"}),confirmMessage:function(){return c.a.createElement("div",{className:"alert alert-danger"},c.a.createElement(g.b,{id:"user.settings.tokens.confirmCreateMessage",defaultMessage:"You are generating a personal access token with System Admin permissions. Are you sure want to create this token?"}))},confirmButton:c.a.createElement(g.c,{id:"user.settings.tokens.confirmCreateButton",defaultMessage:"Yes, Create"}),confirmComplete:function(){a.handleCreateToken(),Object(Ht.d)("settings","system_admin_create_user_access_token")}}):a.handleCreateToken()}),Bn(qn(a),"saveTokenKeyPress",function(e){b.S(e,f.Q.KeyCodes.ENTER)&&a.confirmCreateToken()}),Bn(qn(a),"confirmRevokeToken",function(e){var t=a.props.userAccessTokens[e];a.setState({showConfirmModal:!0,confirmTitle:c.a.createElement(g.c,{id:"user.settings.tokens.confirmDeleteTitle",defaultMessage:"Delete Token?"}),confirmMessage:function(){return c.a.createElement("div",{className:"alert alert-danger"},c.a.createElement(Et.b,{id:"user.settings.tokens.confirmDeleteMessage",defaultMessage:"Any integrations using this token will no longer be able to access the Mattermost API. You cannot undo this action. \\n \\nAre you sure want to delete the **{description}** token?",values:{description:t.description}}))},confirmButton:c.a.createElement(g.c,{id:"user.settings.tokens.confirmDeleteButton",defaultMessage:"Yes, Delete"}),confirmComplete:function(){a.revokeToken(e),Object(Ht.d)("settings","revoke_user_access_token")}})}),Bn(qn(a),"revokeToken",function(){var e=Un(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.revokeUserAccessToken(t);case 2:n=e.sent,(s=n.error)&&a.setState({serverError:s.message}),a.handleCancelConfirm();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Bn(qn(a),"activateToken",function(){var e=Un(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.enableUserAccessToken(t);case 2:n=e.sent,(s=n.error)?a.setState({serverError:s.message}):Object(Ht.d)("settings","activate_user_access_token");case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Bn(qn(a),"deactivateToken",function(){var e=Un(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.disableUserAccessToken(t);case 2:n=e.sent,(s=n.error)?a.setState({serverError:s.message}):Object(Ht.d)("settings","deactivate_user_access_token");case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),a.state={showConfirmModal:!1,newToken:null,tokenCreationState:Yn,tokenError:"",serverError:null,saving:!1},a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(t,c.a.Component),a=t,(n=[{key:"componentDidMount",value:function(){this.props.actions.clearUserAccessTokens();var e=this.props.user?this.props.user.id:"";this.props.actions.getUserAccessTokensForUser(e,0,200)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){!e.active&&this.props.active&&this.setState({showConfirmModal:!1,newToken:null,tokenCreationState:Yn,tokenError:"",serverError:null,saving:!1})}},{key:"render",value:function(){var e=this,t="";if(!this.props.active){var a=b.ab("user.settings.tokens.clickToEdit","Click 'Edit' to manage your personal access tokens");return c.a.createElement(E.a,{title:b.ab("user.settings.tokens.title","Personal Access Tokens"),describe:a,section:"tokens",updateSection:this.props.updateSection})}var n,s,i,r=[];Object.values(this.props.userAccessTokens).forEach(function(t){var a,n;e.state.newToken&&e.state.newToken.id===t.id||(t.is_active?a=c.a.createElement("a",{name:t.id+"_deactivate",href:"#",onClick:function(a){a.preventDefault(),e.deactivateToken(t.id)}},c.a.createElement(g.c,{id:"user.settings.tokens.deactivate",defaultMessage:"Disable"})):(n=c.a.createElement("span",{className:"has-error setting-box__inline-error"},c.a.createElement(g.c,{id:"user.settings.tokens.deactivatedWarning",defaultMessage:"(Disabled)"})),a=c.a.createElement("a",{name:t.id+"_activate",href:"#",onClick:function(a){a.preventDefault(),e.activateToken(t.id)}},c.a.createElement(g.c,{id:"user.settings.tokens.activate",defaultMessage:"Enable"}))),r.push(c.a.createElement("div",{key:t.id,className:"setting-box__item"},c.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},c.a.createElement(g.c,{id:"user.settings.tokens.tokenDesc",defaultMessage:"Token Description: "}),t.description,n),c.a.createElement("div",{className:"setting-box__token-id whitespace--nowrap overflow--ellipsis"},c.a.createElement(g.c,{id:"user.settings.tokens.tokenId",defaultMessage:"Token ID: "}),t.id),c.a.createElement("div",null,a," - ",c.a.createElement("a",{name:t.id+"_delete",href:"#",onClick:function(a){a.preventDefault(),e.confirmRevokeToken(t.id)}},c.a.createElement(g.c,{id:"user.settings.tokens.delete",defaultMessage:"Delete"}))),c.a.createElement("hr",{className:"margin-bottom margin-top x2"}))))}),0===r.length&&(n=c.a.createElement(g.c,{key:"notokens",id:"user.settings.tokens.userAccessTokensNone",defaultMessage:"No personal access tokens."})),s=Object(ne.m)()?c.a.createElement("span",null,c.a.createElement(Et.b,{id:"user.settings.tokens.description_mobile",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication). Create new tokens on your desktop."})):c.a.createElement("span",null,c.a.createElement(Et.b,{id:"user.settings.tokens.description",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication)."})),this.state.tokenCreationState===Hn?i=c.a.createElement("div",{className:"padding-left x2"},c.a.createElement("div",{className:"row"},c.a.createElement("label",{className:"col-sm-auto control-label padding-right x2"},c.a.createElement(g.c,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "})),c.a.createElement("div",{className:"col-sm-5"},c.a.createElement("input",{autoFocus:!0,ref:"newtokendescription",className:"form-control",type:"text",maxLength:64,onKeyPress:this.saveTokenKeyPress}))),c.a.createElement("div",null,c.a.createElement("div",{className:"padding-top x2"},c.a.createElement(g.c,{id:"user.settings.tokens.nameHelp",defaultMessage:"Enter a description for your token to remember what it does."})),c.a.createElement("div",null,c.a.createElement("label",{id:"clientError",className:"has-error margin-top margin-bottom"},this.state.tokenError)),c.a.createElement(In.a,{btnClass:"btn-primary",savingMessage:c.a.createElement(g.c,{id:"user.settings.tokens.save",defaultMessage:"Save"}),saving:this.state.saving,onClick:this.confirmCreateToken}),c.a.createElement("button",{className:"btn btn-link",onClick:this.stopCreatingToken},c.a.createElement(g.c,{id:"user.settings.tokens.cancel",defaultMessage:"Cancel"})))):this.state.tokenCreationState===Vn?(0===r.length&&(t=" hidden"),i=c.a.createElement("div",{className:"alert alert-warning"},c.a.createElement(Ln.a,{additionalClassName:"margin-right"}),c.a.createElement(g.c,{id:"user.settings.tokens.copy",defaultMessage:"Please copy the access token below. You won't be able to see it again!"}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},c.a.createElement(g.c,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "}),this.state.newToken.description),c.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},c.a.createElement(g.c,{id:"user.settings.tokens.id",defaultMessage:"Token ID: "}),this.state.newToken.id),c.a.createElement("strong",{className:"word-break--all"},c.a.createElement(g.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),this.state.newToken.token))):i=c.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:this.startCreatingToken},c.a.createElement(g.c,{id:"user.settings.tokens.create",defaultMessage:"Create New Token"}));var o=[];return o.push(c.a.createElement("div",{key:"tokensSetting",className:"padding-top"},c.a.createElement("div",{key:"tokenList"},c.a.createElement("div",{className:"alert alert-transparent"+t},r,n),i))),c.a.createElement("div",null,c.a.createElement(v.a,{title:b.ab("user.settings.tokens.title","Personal Access Tokens"),inputs:o,extraInfo:s,infoPosition:"top",serverError:this.state.serverError,updateSection:this.props.updateSection,width:"full",saving:this.state.saving,cancelButtonText:c.a.createElement(g.c,{id:"user.settings.security.close",defaultMessage:"Close"})}),c.a.createElement(y.a,{title:this.state.confirmTitle,message:this.state.confirmMessage?this.state.confirmMessage(this.state):null,confirmButtonText:this.state.confirmButton,show:this.state.showConfirmModal,onConfirm:this.state.confirmComplete||function(){},onCancel:this.handleCancelConfirm,hideCancel:this.state.confirmHideCancel}))}}])&&Fn(a.prototype,n),s&&Fn(a,s),t}();Bn(Wn,"propTypes",{user:r.a.object,active:r.a.bool,updateSection:r.a.func,userAccessTokens:r.a.object,setRequireConfirm:r.a.func.isRequired,actions:r.a.shape({getUserAccessTokensForUser:r.a.func.isRequired,createUserAccessToken:r.a.func.isRequired,revokeUserAccessToken:r.a.func.isRequired,enableUserAccessToken:r.a.func.isRequired,disableUserAccessToken:r.a.func.isRequired,clearUserAccessTokens:r.a.func.isRequired}).isRequired}),Bn(Wn,"defaultProps",{user:{},active:!1});var Kn=Object(n.connect)(function(e){return{userAccessTokens:e.entities.users.myUserAccessTokens}},function(e){return{actions:Object(l.bindActionCreators)({getUserAccessTokensForUser:p.getUserAccessTokensForUser,createUserAccessToken:p.createUserAccessToken,revokeUserAccessToken:p.revokeUserAccessToken,enableUserAccessToken:p.enableUserAccessToken,disableUserAccessToken:p.disableUserAccessToken,clearUserAccessTokens:p.clearUserAccessTokens},e)}})(Wn);function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jn(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function Xn(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){Jn(i,n,s,r,o,"next",e)}function o(e){Jn(i,n,s,r,o,"throw",e)}r(void 0)})}}function Zn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function es(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ts(e,t){return(ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function as(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ns="mfa",ss="password",is="signin",rs="apps",os="tokens",cs=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=$n(t).call(this,e),a=!s||"object"!==Qn(s)&&"function"!=typeof s?es(n):s,as(es(a),"loadAuthorizedOAuthApps",Xn(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.getAuthorizedOAuthApps();case 2:t=e.sent,n=t.data,s=t.error,n?a.setState({authorizedApps:n,serverError:null}):s&&a.setState({serverError:s.message});case 6:case"end":return e.stop()}},e)}))),as(es(a),"submitPassword",Xn(regeneratorRuntime.mark(function e(){var t,n,s,i,r,o,c,l,u,d,m,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.user,n=a.state.currentPassword,s=a.state.newPassword,i=a.state.confirmPassword,""!==n){e.next=7;break}return a.setState({passwordError:b.ab("user.settings.security.currentPasswordError","Please enter your current password."),serverError:""}),e.abrupt("return");case 7:if(r=b.X(s,a.props.passwordConfig),o=r.valid,c=r.error,o||!c){e.next=11;break}return a.setState({passwordError:c,serverError:""}),e.abrupt("return");case 11:if(s===i){e.next=15;break}return l=Object.assign(a.getDefaultState(),{passwordError:b.ab("user.settings.security.passwordMatchError","The new passwords you entered do not match."),serverError:""}),a.setState(l),e.abrupt("return");case 15:return a.setState({savingPassword:!0}),e.next=18,a.props.actions.updateUserPassword(t.id,n,s);case 18:u=e.sent,d=u.data,m=u.error,d?(a.props.updateSection(""),a.props.actions.getMe(),a.setState(a.getDefaultState())):m&&(p=a.getDefaultState(),m.message?p.serverError=m.message:p.serverError=m,p.passwordError="",a.setState(p));case 22:case"end":return e.stop()}},e)}))),as(es(a),"updateCurrentPassword",function(e){a.setState({currentPassword:e.target.value})}),as(es(a),"updateNewPassword",function(e){a.setState({newPassword:e.target.value})}),as(es(a),"updateConfirmPassword",function(e){a.setState({confirmPassword:e.target.value})}),as(es(a),"deauthorizeApp",function(){var e=Xn(regeneratorRuntime.mark(function e(t){var n,s,i,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.currentTarget.getAttribute("data-app"),e.next=4,a.props.actions.deauthorizeOAuthApp(n);case 4:s=e.sent,i=s.data,r=s.error,i?(o=a.state.authorizedApps.filter(function(e){return e.id!==n}),a.setState({authorizedApps:o,serverError:null})):r&&a.setState({serverError:r.message});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),as(es(a),"handleUpdateSection",function(e){if(e)a.props.updateSection(e);else{switch(a.props.activeSection){case ns:case is:case os:case rs:a.setState({serverError:null});break;case ss:a.setState({currentPassword:"",newPassword:"",confirmPassword:"",serverError:null,passwordError:null})}a.props.updateSection("")}}),as(es(a),"createPasswordSection",function(){if(a.props.activeSection===ss){var e,t=[];return""===a.props.user.auth_service?(e=a.submitPassword,t.push(c.a.createElement("div",{key:"currentPasswordUpdateForm",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.security.currentPassword",defaultMessage:"Current Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"currentPassword",autoFocus:!0,className:"form-control",type:"password",onChange:a.updateCurrentPassword,value:a.state.currentPassword,"aria-label":b.ab("user.settings.security.currentPassword","Current Password")})))),t.push(c.a.createElement("div",{key:"newPasswordUpdateForm",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.security.newPassword",defaultMessage:"New Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"newPassword",className:"form-control",type:"password",onChange:a.updateNewPassword,value:a.state.newPassword,"aria-label":b.ab("user.settings.security.newPassword","New Password")})))),t.push(c.a.createElement("div",{key:"retypeNewPasswordUpdateForm",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(g.c,{id:"user.settings.security.retypePassword",defaultMessage:"Retype New Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"confirmPassword",className:"form-control",type:"password",onChange:a.updateConfirmPassword,value:a.state.confirmPassword,"aria-label":b.ab("user.settings.security.retypePassword","Retype New Password")}))))):a.props.user.auth_service===f.Q.GITLAB_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.security.passwordGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Password cannot be updated."})))):a.props.user.auth_service===f.Q.LDAP_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.security.passwordLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Password cannot be updated."})))):a.props.user.auth_service===f.Q.SAML_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.security.passwordSamlCantUpdate",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."})))):a.props.user.auth_service===f.Q.GOOGLE_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.security.passwordGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Password cannot be updated."})))):a.props.user.auth_service===f.Q.OFFICE365_SERVICE&&t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(g.c,{id:"user.settings.security.passwordOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Password cannot be updated."})))),c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.security.password",defaultMessage:"Password"}),inputs:t,submit:e,saving:a.state.savingPassword,serverError:a.state.serverError,clientError:a.state.passwordError,updateSection:a.handleUpdateSection})}var n;if(""===a.props.user.auth_service){var s=new Date(a.props.user.last_password_update);n=c.a.createElement(g.c,{id:"user.settings.security.lastUpdated",defaultMessage:"Last updated {date} at {time}",values:{date:c.a.createElement(g.a,{value:s,day:"2-digit",month:"short",year:"numeric"}),time:c.a.createElement(g.d,{value:s,hour12:!a.props.militaryTime,hour:"2-digit",minute:"2-digit"})}})}else a.props.user.auth_service===f.Q.GITLAB_SERVICE?n=c.a.createElement(g.c,{id:"user.settings.security.loginGitlab",defaultMessage:"Login done through GitLab"}):a.props.user.auth_service===f.Q.LDAP_SERVICE?n=c.a.createElement(g.c,{id:"user.settings.security.loginLdap",defaultMessage:"Login done through AD/LDAP"}):a.props.user.auth_service===f.Q.SAML_SERVICE?n=c.a.createElement(g.c,{id:"user.settings.security.loginSaml",defaultMessage:"Login done through SAML"}):a.props.user.auth_service===f.Q.GOOGLE_SERVICE?n=c.a.createElement(g.c,{id:"user.settings.security.loginGoogle",defaultMessage:"Login done through Google Apps"}):a.props.user.auth_service===f.Q.OFFICE365_SERVICE&&(n=c.a.createElement(g.c,{id:"user.settings.security.loginOffice365",defaultMessage:"Login done through Office 365"}));return c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.security.password",defaultMessage:"Password"}),describe:n,section:ss,updateSection:a.handleUpdateSection,focused:!0})}),as(es(a),"createSignInSection",function(){var e=a.props.user;if(a.props.activeSection===is){var t,n,s,i,r,o;if(""===e.auth_service)a.props.enableSignUpWithGitLab&&(n=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(Ha.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+f.Q.GITLAB_SERVICE},c.a.createElement(g.c,{id:"user.settings.security.switchGitlab",defaultMessage:"Switch to using GitLab SSO"})),c.a.createElement("br",null))),a.props.enableSignUpWithGoogle&&(s=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(Ha.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+f.Q.GOOGLE_SERVICE},c.a.createElement(g.c,{id:"user.settings.security.switchGoogle",defaultMessage:"Switch to using Google SSO"})),c.a.createElement("br",null))),a.props.enableSignUpWithOffice365&&(i=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(Ha.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+f.Q.OFFICE365_SERVICE},c.a.createElement(g.c,{id:"user.settings.security.switchOffice365",defaultMessage:"Switch to using Office 365 SSO"})),c.a.createElement("br",null))),a.props.enableLdap&&(r=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(Ha.a,{className:"btn btn-primary",to:"/claim/email_to_ldap?email="+encodeURIComponent(e.email)},c.a.createElement(g.c,{id:"user.settings.security.switchLdap",defaultMessage:"Switch to using AD/LDAP"})),c.a.createElement("br",null))),a.props.enableSaml&&(o=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(Ha.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+f.Q.SAML_SERVICE},c.a.createElement(g.c,{id:"user.settings.security.switchSaml",defaultMessage:"Switch to using SAML SSO"})),c.a.createElement("br",null)));else if(a.props.enableSignUpWithEmail){var l;l=e.auth_service===f.Q.LDAP_SERVICE?"/claim/ldap_to_email?email="+encodeURIComponent(e.email):"/claim/oauth_to_email?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service,t=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(Ha.a,{className:"btn btn-primary",to:l},c.a.createElement(g.c,{id:"user.settings.security.switchEmail",defaultMessage:"Switch to using email and password"})),c.a.createElement("br",null))}var u=[];u.push(c.a.createElement("div",{key:"userSignInOption"},t,n,s,i,r,o));var d=c.a.createElement("span",null,c.a.createElement(g.c,{id:"user.settings.security.oneSignin",defaultMessage:"You may only have one sign-in method at a time. Switching sign-in method will send an email notifying you if the change was successful."}));return c.a.createElement(v.a,{title:b.ab("user.settings.security.method","Sign-in Method"),extraInfo:d,inputs:u,serverError:a.state.serverError,updateSection:a.handleUpdateSection})}var m=c.a.createElement(g.c,{id:"user.settings.security.emailPwd",defaultMessage:"Email and Password"});return a.props.user.auth_service===f.Q.GITLAB_SERVICE?m=c.a.createElement(g.c,{id:"user.settings.security.gitlab",defaultMessage:"GitLab"}):a.props.user.auth_service===f.Q.GOOGLE_SERVICE?m=c.a.createElement(g.c,{id:"user.settings.security.google",defaultMessage:"Google"}):a.props.user.auth_service===f.Q.OFFICE365_SERVICE?m=c.a.createElement(g.c,{id:"user.settings.security.office365",defaultMessage:"Office 365"}):a.props.user.auth_service===f.Q.LDAP_SERVICE?m=c.a.createElement(g.c,{id:"user.settings.security.ldap",defaultMessage:"AD/LDAP"}):a.props.user.auth_service===f.Q.SAML_SERVICE&&(m=c.a.createElement(g.c,{id:"user.settings.security.saml",defaultMessage:"SAML"})),c.a.createElement(E.a,{title:b.ab("user.settings.security.method","Sign-in Method"),describe:m,section:is,updateSection:a.handleUpdateSection})}),as(es(a),"createOAuthAppsSection",function(){if(a.props.activeSection===rs){var e;e=a.state.authorizedApps&&a.state.authorizedApps.length>0?a.state.authorizedApps.map(function(e){var t=c.a.createElement("a",{href:e.homepage,target:"_blank",rel:"noopener noreferrer"},e.homepage);return c.a.createElement("div",{key:e.id,className:"padding-bottom x2 authorized-app"},c.a.createElement("div",{className:"col-sm-10"},c.a.createElement("div",{className:"authorized-app__name"},e.name,c.a.createElement("span",{className:"authorized-app__url"}," -"," ",t)),c.a.createElement("div",{className:"authorized-app__description"},e.description),c.a.createElement("div",{className:"authorized-app__deauthorize"},c.a.createElement("a",{href:"#","data-app":e.id,onClick:a.deauthorizeApp},c.a.createElement(g.c,{id:"user.settings.security.deauthorize",defaultMessage:"Deauthorize"})))),c.a.createElement("div",{className:"col-sm-2 pull-right"},c.a.createElement("img",{alt:e.name,src:e.icon_url||Ya.a})),c.a.createElement("br",null))}):c.a.createElement("div",{className:"padding-bottom x2 authorized-app"},c.a.createElement("div",{className:"setting-list__hint"},c.a.createElement(g.c,{id:"user.settings.security.noApps",defaultMessage:"No OAuth 2.0 Applications are authorized."})));var t,n,s=[];Array.isArray(e)&&(t="authorized-apps__wrapper",n=c.a.createElement("div",{className:"authorized-apps__help"},c.a.createElement(g.c,{id:"user.settings.security.oauthAppsHelp",defaultMessage:"Applications act on your behalf to access your data based on the permissions you grant them."}))),s.push(c.a.createElement("div",{className:t,key:"authorizedApps"},e));var i=c.a.createElement("div",null,c.a.createElement(g.c,{id:"user.settings.security.oauthApps",defaultMessage:"OAuth 2.0 Applications"}),n);return c.a.createElement(v.a,{title:i,inputs:s,serverError:a.state.serverError,updateSection:a.handleUpdateSection,width:"full",cancelButtonText:c.a.createElement(g.c,{id:"user.settings.security.close",defaultMessage:"Close"})})}return c.a.createElement(E.a,{title:b.ab("user.settings.security.oauthApps","OAuth 2.0 Applications"),describe:c.a.createElement(g.c,{id:"user.settings.security.oauthAppsDescription",defaultMessage:"Click 'Edit' to manage your OAuth 2.0 Applications"}),section:rs,updateSection:a.handleUpdateSection})}),a.state=a.getDefaultState(),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ts(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"getDefaultState",value:function(){return{currentPassword:"",newPassword:"",confirmPassword:"",passwordError:"",serverError:"",tokenError:"",authService:this.props.user.auth_service,savingPassword:!1}}},{key:"componentDidMount",value:function(){this.props.enableOAuthServiceProvider&&this.loadAuthorizedOAuthApps()}},{key:"render",value:function(){var e,t,a,n=this,s=this.props.user,i=this.createPasswordSection(),r=0;return r=this.props.enableSignUpWithGitLab?r+1:r,r=this.props.enableSignUpWithGoogle?r+1:r,r=this.props.enableSignUpWithOffice365?r+1:r,r=this.props.enableLdap?r+1:r,r=this.props.enableSaml?r+1:r,(this.props.enableSignUpWithEmail||""===s.auth_service)&&r>0&&this.props.experimentalEnableAuthenticationTransfer&&(e=this.createSignInSection()),this.props.enableOAuthServiceProvider&&(t=this.createOAuthAppsSection()),this.props.canUseAccessTokens&&(a=c.a.createElement(Kn,{user:this.props.user,active:this.props.activeSection===os,updateSection:this.handleUpdateSection,setRequireConfirm:this.props.setRequireConfirm})),c.a.createElement("div",null,c.a.createElement("div",{className:"modal-header"},c.a.createElement(g.c,{id:"user.settings.security.close",defaultMessage:"Close"},function(e){return c.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":e,onClick:n.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×"))}),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement(g.c,{id:"generic_icons.collapse",defaultMessage:"Collapse Icon"},function(e){return c.a.createElement("i",{className:"fa fa-angle-left",title:e,onClick:n.props.collapseModal})})),c.a.createElement(g.c,{id:"user.settings.security.title",defaultMessage:"Security Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{className:"tab-header"},c.a.createElement(g.c,{id:"user.settings.security.title",defaultMessage:"Security Settings"})),c.a.createElement("div",{className:"divider-dark first"}),i,c.a.createElement("div",{className:"divider-light"}),c.a.createElement(Rn,{active:this.props.activeSection===ns,updateSection:this.handleUpdateSection}),c.a.createElement("div",{className:"divider-light"}),t,c.a.createElement("div",{className:"divider-light"}),a,c.a.createElement("div",{className:"divider-light"}),e,c.a.createElement("div",{className:"divider-dark"}),c.a.createElement("br",null),c.a.createElement(_n.a,{className:"security-links color--link",dialogType:nn},c.a.createElement(g.c,{id:"user.settings.security.viewHistory.icon",defaultMessage:"Access History Icon"},function(e){return c.a.createElement("i",{className:"fa fa-clock-o",title:e})}),c.a.createElement(g.c,{id:"user.settings.security.viewHistory",defaultMessage:"View Access History"})),c.a.createElement(_n.a,{className:"security-links color--link margin-top",dialogType:Sn},c.a.createElement(g.c,{id:"user.settings.security.logoutActiveSessions.icon",defaultMessage:"Active Sessions Icon"},function(e){return c.a.createElement("i",{className:"fa fa-clock-o",title:e})}),c.a.createElement(g.c,{id:"user.settings.security.logoutActiveSessions",defaultMessage:"View and Logout of Active Sessions"}))))}}])&&Zn(a.prototype,n),s&&Zn(a,s),t}();as(cs,"propTypes",{user:r.a.object,activeSection:r.a.string,updateSection:r.a.func,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,canUseAccessTokens:r.a.bool,enableOAuthServiceProvider:r.a.bool,enableSignUpWithEmail:r.a.bool,enableSignUpWithGitLab:r.a.bool,enableSignUpWithGoogle:r.a.bool,enableLdap:r.a.bool,enableSaml:r.a.bool,enableSignUpWithOffice365:r.a.bool,experimentalEnableAuthenticationTransfer:r.a.bool,passwordConfig:r.a.object,militaryTime:r.a.bool,actions:r.a.shape({getMe:r.a.func.isRequired,updateUserPassword:r.a.func.isRequired,getAuthorizedOAuthApps:r.a.func.isRequired,deauthorizeOAuthApp:r.a.func.isRequired}).isRequired}),as(cs,"defaultProps",{user:{},activeSection:""});var ls=Object(n.connect)(function(e,t){var a=Object(u.getConfig)(e),n="true"===a.EnableUserAccessTokens,s=Ba.hasUserAccessTokenRole(t.user.roles)||Ba.isSystemAdmin(t.user.roles);return{canUseAccessTokens:n&&s,enableOAuthServiceProvider:"true"===a.EnableOAuthServiceProvider,enableSignUpWithEmail:"true"===a.EnableSignUpWithEmail,enableSignUpWithGitLab:"true"===a.EnableSignUpWithGitLab,enableSignUpWithGoogle:"true"===a.EnableSignUpWithGoogle,enableLdap:"true"===a.EnableLdap,enableSaml:"true"===a.EnableSaml,enableSignUpWithOffice365:"true"===a.EnableSignUpWithOffice365,experimentalEnableAuthenticationTransfer:"true"===a.ExperimentalEnableAuthenticationTransfer,passwordConfig:Object(b.B)(a),militaryTime:Object(d.getBool)(e,f.z.CATEGORY_DISPLAY_SETTINGS,f.z.USE_MILITARY_TIME,!1)}},function(e){return{actions:Object(l.bindActionCreators)({getMe:p.getMe,updateUserPassword:p.updateUserPassword,getAuthorizedOAuthApps:Ga.getAuthorizedOAuthApps,deauthorizeOAuthApp:Ga.deauthorizeOAuthApp},e)}})(cs);function us(e){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ds(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ms(e){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ps(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fs(e,t){return(fs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gs(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var hs=function(e){function t(e){var a,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,s=ms(t).call(this,e),a=!s||"object"!==us(s)&&"function"!=typeof s?ps(n):s,gs(ps(a),"getStateFromProps",function(){var e=a.props,t=e.closeUnusedDirectMessages,n=e.channelSwitcherOption,s=e.sidebarPreference,i=s.grouping,r=s.sorting;return{settings:{close_unused_direct_messages:t,channel_switcher_section:n,grouping:i,unreadsAtTop:e.unreadsAtTop,favoriteAtTop:e.favoriteAtTop,sorting:r},isSaving:!1}}),gs(ps(a),"trackSettingChangeIfNecessary",function(e){a.state.settings[e]!==a.props.sidebarPreference[e]&&Object(Ht.d)("settings","user_settings_update",{field:"sidebar."+e,value:a.state.settings[e]})}),gs(ps(a),"updateSetting",function(e,t){var n=a.state.settings;n[e]=t,a.setState(n)}),gs(ps(a),"handleSubmit",function(e){var t=a.props,n=t.actions,s=t.user,i=[];if("channel_grouping"===e||"channel_sorting"===e){var r={grouping:a.state.settings.grouping,unreads_at_top:a.state.settings.unreadsAtTop,favorite_at_top:a.state.settings.favoriteAtTop,sorting:a.state.settings.sorting};i.push({user_id:s.id,category:f.Q.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:"",value:JSON.stringify(r)}),a.trackSettingChangeIfNecessary("grouping"),a.trackSettingChangeIfNecessary("sorting"),a.trackSettingChangeIfNecessary("unreadsAtTop"),a.trackSettingChangeIfNecessary("favoriteAtTop")}else i.push({user_id:s.id,category:f.Q.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:e,value:a.state.settings[e]}),Object(Ht.d)("settings","user_settings_update",{field:"sidebar."+e,value:a.state.settings[e]});a.setState({isSaving:!0}),n.savePreferences(s.id,i).then(function(){a.updateSection("")})}),gs(ps(a),"getPreviousSection",function(e){var t=a.props.showChannelOrganization;switch(e){case"autoCloseDM":return"channelSwitcher";case"groupChannels":return"dummySectionName";case"channelSwitcher":return t?"groupChannels":"dummySectionName";default:return null}}),gs(ps(a),"updateSection",function(e){e||a.setState(a.getStateFromProps()),a.setState({isSaving:!1}),a.props.updateSection(e)}),gs(ps(a),"renderAutoCloseDMLabel",function(e){return"after_seven_days"===e?c.a.createElement(g.c,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"}):c.a.createElement(g.c,{id:"user.settings.sidebar.never",defaultMessage:"Never"})}),gs(ps(a),"renderAutoCloseDMSection",function(){var e;return e="autoCloseDM"===a.props.activeSection?c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),inputs:[c.a.createElement("fieldset",{key:"autoCloseDMSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"autoCloseDMAfterSevenDays",type:"radio",name:"autoCloseDM",checked:"after_seven_days"===a.state.settings.close_unused_direct_messages,onChange:a.updateSetting.bind(ps(a),"close_unused_direct_messages","after_seven_days")}),c.a.createElement(g.c,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"autoCloseDMNever",type:"radio",name:"autoCloseDM",checked:"never"===a.state.settings.close_unused_direct_messages,onChange:a.updateSetting.bind(ps(a),"close_unused_direct_messages","never")}),c.a.createElement(g.c,{id:"user.settings.sidebar.never",defaultMessage:"Never"}))),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.sidebar.autoCloseDMDesc",defaultMessage:"Direct Message conversations can be reopened with the “+” button in the sidebar or using the Channel Switcher (CTRL+K)."})))],setting:"close_unused_direct_messages",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),describe:a.renderAutoCloseDMLabel(a.state.settings.close_unused_direct_messages),section:"autoCloseDM",updateSection:a.updateSection}),c.a.createElement(c.a.Fragment,null,e,c.a.createElement("div",{className:"divider-dark"}))}),gs(ps(a),"renderOrganizationLabel",function(){var e,t,n=a.props,s=n.sidebarPreference,i=s.sorting,r=s.grouping,o=n.unreadsAtTop,l=n.favoriteAtTop,u=[];"by_type"===r?u.push(c.a.createElement(g.c,{key:"by_type",id:"user.settings.sidebar.groupByTypeShort",defaultMessage:"Group by channel type"})):u.push(c.a.createElement(g.c,{key:"none",id:"user.settings.sidebar.groupByNoneShort",defaultMessage:"No grouping"})),"alpha"===i?(e=Object(K.b)("user.settings.sidebar.sortAlphaShort"),t="sorted alphabetically"):(e=Object(K.b)("user.settings.sidebar.sortRecentShort"),t="sorted by recency"),u.push(c.a.createElement("span",{key:"comma"},", ")),u.push(c.a.createElement(g.c,{key:"sorting",id:e,defaultMessage:t}));var d=null,m=null;return"true"===o&&"false"===l?(d=Object(K.b)("user.settings.sidebar.unreadsShort"),m="Unreads grouped separately"):"false"===o&&"true"===l?(d=Object(K.b)("user.settings.sidebar.favoritesShort"),m="Favorites grouped separately"):"true"===o&&"true"===l&&(d=Object(K.b)("user.settings.sidebar.unreadsFavoritesShort"),m="Unreads and favorites grouped separately"),d&&(u.push(c.a.createElement("br",{key:"break"})),u.push(c.a.createElement(g.c,{key:"atTop",id:d,defaultMessage:m}))),u}),gs(ps(a),"renderChannelSwitcherLabel",function(e){return"true"===e?c.a.createElement(g.c,{id:"user.settings.sidebar.on",defaultMessage:"On"}):c.a.createElement(g.c,{id:"user.settings.sidebar.off",defaultMessage:"Off"})}),gs(ps(a),"renderChannelOrganizationSection",function(){var e,t=a.state.settings,n=t.grouping,s=t.sorting;if("groupChannels"===a.props.activeSection){var i=[];i.push(c.a.createElement("fieldset",{key:"groupingSectionSetting"},c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.sidebar.groupChannelsTitle",defaultMessage:"Channel grouping"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"byTypeOption",type:"radio",name:"groupChannels",checked:"by_type"===n,onChange:a.updateSetting.bind(ps(a),"grouping","by_type")}),c.a.createElement(g.c,{id:"user.settings.sidebar.groupByType",defaultMessage:"Channels grouped by type"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"noneOption",type:"radio",name:"groupChannels",checked:"none"===n,onChange:a.updateSetting.bind(ps(a),"grouping","none")}),c.a.createElement(g.c,{id:"user.settings.sidebar.groupByNone",defaultMessage:"Combine all channel types"}))),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.sidebar.groupDesc",defaultMessage:"Group channels by type, or combine all types into a list."})))),i.push(c.a.createElement("hr",{key:"sortingDivider"})),i.push(c.a.createElement("fieldset",{key:"sortingOptions"},c.a.createElement("legend",{className:"form-legend"},c.a.createElement(g.c,{id:"user.settings.sidebar.sortChannelsTitle",defaultMessage:"Channel sorting"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"recentSectionEnabled",type:"radio",name:"sortChannels",checked:"recent"===s,onChange:a.updateSetting.bind(ps(a),"sorting","recent")}),c.a.createElement(g.c,{id:"user.settings.sidebar.sortRecent",defaultMessage:"Recency"}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"alphaSectionEnabled",type:"radio",name:"sortChannels",checked:"alpha"===s,onChange:a.updateSetting.bind(ps(a),"sorting","alpha")}),c.a.createElement(g.c,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}))),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.sidebar.sortDesc",defaultMessage:"Sort channels alphabetically, or by most recent post."})))),i.push(c.a.createElement("hr",{key:"divider"})),i.push(c.a.createElement("fieldset",{key:"unreadOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"unreadAtTopOption",type:"checkbox",checked:"true"===a.state.settings.unreadsAtTop,onChange:function(e){return a.updateSetting("unreadsAtTop",e.target.checked.toString())}}),c.a.createElement(g.c,{id:"user.settings.sidebar.unreads",defaultMessage:"Unreads grouped separately"}))),c.a.createElement("div",{className:"margin-top x3"},c.a.createElement(g.c,{id:"user.settings.sidebar.unreadsDesc",defaultMessage:"Group unread channels separately until read."})))),i.push(c.a.createElement("hr",{key:"groupingDivider"})),i.push(c.a.createElement("fieldset",{key:"favoriteOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"favoriteAtTopOption",type:"checkbox",checked:"true"===a.state.settings.favoriteAtTop,onChange:function(e){return a.updateSetting("favoriteAtTop",e.target.checked.toString())}}),c.a.createElement(g.c,{id:"user.settings.sidebar.favorites",defaultMessage:"Favorites grouped separately"}))),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(g.c,{id:"user.settings.sidebar.favoritesDesc",defaultMessage:"Channels marked as favorites will be grouped separately."})))),e=c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.sidebar.groupAndSortChannelsTitle",defaultMessage:"Channel grouping and sorting"}),inputs:i,setting:"channel_grouping",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection})}else e=c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.sidebar.groupAndSortChannelsTitle",defaultMessage:"Channel grouping and sorting"}),describe:a.renderOrganizationLabel(),section:"groupChannels",updateSection:a.updateSection});return c.a.createElement(c.a.Fragment,null,e,c.a.createElement("div",{className:"divider-light"}))}),gs(ps(a),"renderChannelSwitcherSection",function(){var e=Object(K.b)("user.settings.sidebar.channelSwitcherSectionDesc.windows"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CTRL + K.";Object(b.T)()&&(e=Object(K.b)("user.settings.sidebar.channelSwitcherSectionDesc.mac"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CMD + K.");var n=c.a.createElement(g.c,{id:e,defaultMessage:t});return"channelSwitcher"===a.props.activeSection?c.a.createElement(v.a,{title:c.a.createElement(g.c,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),inputs:[c.a.createElement("div",{key:"channelSwitcherSectionSetting"},c.a.createElement("div",{id:"channelSwitcherRadioOn",className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"channelSwitcherSectionEnabled",type:"radio",name:"channelSwitcher",checked:"true"===a.state.settings.channel_switcher_section,onChange:a.updateSetting.bind(ps(a),"channel_switcher_section","true")}),c.a.createElement(g.c,{id:"user.settings.sidebar.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{id:"channelSwitcherRadioOff",className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"channelSwitcherSectionOff",type:"radio",name:"channelSwitcher",checked:"false"===a.state.settings.channel_switcher_section,onChange:a.updateSetting.bind(ps(a),"channel_switcher_section","false")}),c.a.createElement(g.c,{id:"user.settings.sidebar.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",{id:"channelSwitcherHelpText"},c.a.createElement("br",null),n))],setting:"channel_switcher_section",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):c.a.createElement(E.a,{title:c.a.createElement(g.c,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),describe:a.renderChannelSwitcherLabel(a.props.channelSwitcherOption),section:"channelSwitcher",updateSection:a.updateSection})}),a.state=a.getStateFromProps(),a}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fs(e,t)}(t,c.a.Component),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.showUnusedOption,a=e.showChannelOrganization,n=this.context.intl.formatMessage,s=a?this.renderChannelOrganizationSection():null,i=t?this.renderAutoCloseDMSection():null,r=this.renderChannelSwitcherSection();return c.a.createElement("div",null,c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:n({id:"generic_icons.collapse",defaultMessage:"Collapse Icon"}),onClick:this.props.collapseModal})),c.a.createElement(g.c,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"}))),c.a.createElement("div",{id:"sidebarTitle",className:"user-settings"},c.a.createElement("h3",{className:"tab-header"},c.a.createElement(g.c,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"})),c.a.createElement("div",{className:"divider-dark first"}),s,r,t?c.a.createElement("div",{className:"divider-light"}):c.a.createElement("div",{className:"divider-dark"}),i))}}])&&ds(a.prototype,n),s&&ds(a,s),t}();gs(hs,"propTypes",{actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired,user:r.a.object,closeUnusedDirectMessages:r.a.string.isRequired,showUnusedOption:r.a.bool.isRequired,showChannelOrganization:r.a.bool.isRequired,channelSwitcherOption:r.a.string.isRequired,sidebarPreference:r.a.shape({grouping:r.a.string.isRequired,sorting:r.a.string.isRequired}).isRequired,unreadsAtTop:r.a.string.isRequired,favoriteAtTop:r.a.string.isRequired,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired}),gs(hs,"contextTypes",{intl:g.i.isRequired});var bs=Object(n.connect)(function(e){var t=Object(u.getConfig)(e),a=Object(d.get)(e,_.Preferences.CATEGORY_SIDEBAR_SETTINGS,"close_unused_direct_messages","after_seven_days"),n=Object(d.get)(e,_.Preferences.CATEGORY_SIDEBAR_SETTINGS,"channel_switcher_section","true"),i=Object(d.getSidebarPreferences)(e);return{closeUnusedDirectMessages:a,sidebarPreference:i,unreadsAtTop:i.unreads_at_top,favoriteAtTop:i.favorite_at_top,channelSwitcherOption:n,showChannelOrganization:"true"===t.ExperimentalChannelOrganization,showUnusedOption:"true"===t.CloseUnusedDirectMessages,user:Object(s.getCurrentUser)(e)}},function(e){return{actions:Object(l.bindActionCreators)({savePreferences:m.savePreferences},e)}})(hs);function vs(e){return(vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Es(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ys(e,t){return!t||"object"!==vs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ss(e){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _s(e,t){return(_s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Os,ws,ks,Ms=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ys(this,Ss(t).apply(this,arguments))}var a,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_s(e,t)}(t,c.a.PureComponent),a=t,(n=[{key:"render",value:function(){return"general"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(sa,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,updateTab:this.props.updateTab,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"security"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(ls,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setRequireConfirm:this.props.setRequireConfirm})):"notifications"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(qa,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"display"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(qt,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setEnforceFocus:this.props.setEnforceFocus,setRequireConfirm:this.props.setRequireConfirm})):"sidebar"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(bs,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"advanced"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(q,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):c.a.createElement("div",null)}}])&&Es(a.prototype,n),s&&Es(a,s),t}();Os=Ms,ws="propTypes",ks={user:r.a.object.isRequired,activeTab:r.a.string,activeSection:r.a.string,updateSection:r.a.func,updateTab:r.a.func,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired},ws in Os?Object.defineProperty(Os,ws,{value:ks,enumerable:!0,configurable:!0,writable:!0}):Os[ws]=ks;t.default=Object(n.connect)(function(e){return{user:Object(s.getCurrentUser)(e)}})(Ms)}}]);
//# sourceMappingURL=16.0395c8dafd43b67aca0f.js.map