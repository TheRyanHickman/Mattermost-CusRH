(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{1701:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoUpdateTimezone=function(e){return t=regeneratorRuntime.mark(function t(o,i){var c,u,p,d,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=(0,r.getCurrentUser)(i()),u=(0,n.getUserTimezone)(i(),c.id),p=u.automaticTimezone!==e,u.useAutomaticTimezone&&p&&(d={useAutomaticTimezone:"true",automaticTimezone:e,manualTimezone:u.manualTimezone},l=s({},c,{timezone:d}),(0,a.updateMe)(l)(o,i));case 4:case"end":return t.stop()}},t)}),o=function(){var e=this,o=arguments;return new Promise(function(r,n){var a=t.apply(e,o);function i(e){u(a,r,n,i,s,"next",e)}function s(e){u(a,r,n,i,s,"throw",e)}i(void 0)})},function(e,t){return o.apply(this,arguments)};var t,o},o(21),o(10),o(11),o(15),o(89),o(90);var r=o(12),n=o(316),a=o(40);function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(o,!0).forEach(function(t){c(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(o).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function u(e,t,o,r,n,a,i){try{var s=e[a](i),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}},2374:function(e,t,o){"use strict";o.r(t);o(247);var r=o(418),n=o(20),a=o(1701),i=o(16),s=o(24),c=o(12),u=o(1777),p=(o(88),o(43),o(422),o(183)),d=o.n(p),l=o(30),f=o.n(l),m=o(7),h=o.n(m),v=o(435),b=o(75),y=o(1493),w=o(1591),O=o(38),g=o(1494),j=o(321),_=o(13),C=o(1734);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var E=_.a.dispatch,L=_.a.getState,R=function(e){function t(e){var o,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=P(t).call(this,e),o=!n||"object"!==T(n)&&"function"!=typeof n?U(r):n,z(U(o),"onDesktopMessageListener",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.origin,r=e.data,n=(r=void 0===r?{}:r).type,a=r.message,i=(a=void 0===a?{}:a).userIsActive,s=a.manual;if(o.props.currentUser&&t===window.location.origin)switch(n){case"user-activity-update":!0!==i&&!1!==i||C.a.userUpdateActiveStatus(i,s)}});var a=document.getElementById("root");return a&&(a.className+=" channel-view"),o}var o,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,h.a.PureComponent),o=t,(r=[{key:"isValidState",value:function(){return null!=this.props.currentUser}},{key:"componentDidMount",value:function(){var e=this;w.b(),this.props.enableTimezone&&this.props.actions.autoUpdateTimezone(Object(j.a)()),d()(window).on("beforeunload",function(){d()(window).off("beforeunload"),document.cookie.indexOf("MMUSERID=")>-1&&Object(b.viewChannel)("",e.props.currentChannelId||"")(E,L),w.a()}),window.addEventListener("focus",this.onFocusListener),window.addEventListener("blur",this.onBlurListener),window.addEventListener("message",this.onDesktopMessageListener),O.g()?d()("body").addClass("ios"):O.a()&&d()("body").addClass("android"),this.props.currentUser||(d()("#root").attr("class",""),y.e("/login?redirect_to="+encodeURIComponent(this.props.location.pathname),!0,!1)),d()("body").on("mouseenter mouseleave",":not(.post-list__dynamic) .post",function(e){"mouseenter"===e.type?(d()(this).prev(".date-separator, .new-separator").addClass("hovered--after"),d()(this).next(".date-separator, .new-separator").addClass("hovered--before")):(d()(this).prev(".date-separator, .new-separator").removeClass("hovered--after"),d()(this).next(".date-separator, .new-separator").removeClass("hovered--before"))}),d()("body").on("mouseenter mouseleave",".search-item__container .post",function(e){"mouseenter"===e.type?(d()(this).closest(".search-item__container").find(".date-separator").addClass("hovered--after"),d()(this).closest(".search-item__container").next("div").find(".date-separator").addClass("hovered--before")):(d()(this).closest(".search-item__container").find(".date-separator").removeClass("hovered--after"),d()(this).closest(".search-item__container").next("div").find(".date-separator").removeClass("hovered--before"))}),d()("body").on("mouseenter mouseleave",":not(.post-list__dynamic) .post.post--comment.same--root",function(e){"mouseenter"===e.type?(d()(this).prev(".date-separator, .new-separator").addClass("hovered--comment"),d()(this).next(".date-separator, .new-separator").addClass("hovered--comment")):(d()(this).prev(".date-separator, .new-separator").removeClass("hovered--comment"),d()(this).next(".date-separator, .new-separator").removeClass("hovered--comment"))}),d()(window).on("keydown.preventBackspace",function(e){8!==e.which||d()(e.target).is("input, textarea")||e.preventDefault()})}},{key:"componentWillUnmount",value:function(){w.a(),d()("body").off("click.userpopover"),d()("body").off("mouseenter mouseleave",".post"),d()("body").off("mouseenter mouseleave",".post.post--comment.same--root"),d()(".modal").off("show.bs.modal"),d()(window).off("keydown.preventBackspace"),window.removeEventListener("focus",this.onFocusListener),window.removeEventListener("blur",this.onBlurListener),window.removeEventListener("message",this.onDesktopMessageListener)}},{key:"render",value:function(){if(!this.isValidState())return h.a.createElement(g.a,null);if(this.props.mfaRequired){if("/mfa/setup"!==this.props.location.pathname)return h.a.createElement(v.a,{to:"/mfa/setup"})}else if("/mfa/confirm"===this.props.location.pathname);else if(this.props.showTermsOfService&&"/terms_of_service"!==this.props.location.pathname)return h.a.createElement(v.a,{to:"/terms_of_service?redirect_to="+encodeURIComponent(this.props.location.pathname)});return this.props.children}},{key:"onFocusListener",value:function(){y.a(!0)}},{key:"onBlurListener",value:function(){y.a(!1)}}])&&k(o.prototype,r),n&&k(o,n),t}();z(R,"propTypes",{currentUser:f.a.object,currentChannelId:f.a.string,children:f.a.object,mfaRequired:f.a.bool.isRequired,enableTimezone:f.a.bool.isRequired,actions:f.a.shape({autoUpdateTimezone:f.a.func.isRequired}).isRequired,showTermsOfService:f.a.bool.isRequired});t.default=Object(r.connect)(function(e,t){var o=Object(s.getLicense)(e),r=Object(s.getConfig)(e),n=Object(c.shouldShowTermsOfService)(e);return{currentUser:Object(c.getCurrentUser)(e),currentChannelId:Object(i.getCurrentChannelId)(e),mfaRequired:Object(u.a)(Object(c.getCurrentUser)(e),o,r,t.match.url),enableTimezone:"true"===r.ExperimentalTimezone,showTermsOfService:n}},function(e){return{actions:Object(n.bindActionCreators)({autoUpdateTimezone:a.autoUpdateTimezone},e)}})(R)}}]);
//# sourceMappingURL=26.404f53cb4da1116e6536.js.map