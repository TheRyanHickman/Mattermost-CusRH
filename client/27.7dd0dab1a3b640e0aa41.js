(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{2378:function(e,t,a){"use strict";a.r(t);var n=a(418),r=a(20),o=a(1496),i=(a(88),a(43),a(74),a(120),a(185),a(304),a(30)),c=a.n(i),l=a(7),s=a.n(l),u=a(56),p=a(433),m=a.n(p),d=a(1501),h=a(119),f=a(1491);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,a){return t&&v(e.prototype,t),a&&v(e,a),e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(a=!(r=b(t).call(this,e))||"object"!==y(r)&&"function"!=typeof r?w(n):r).handleAllow=a.handleAllow.bind(w(a)),a.handleDeny=a.handleDeny.bind(w(a)),a.state={},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,s.a.Component),g(t,null,[{key:"propTypes",get:function(){return{location:c.a.object.isRequired,actions:c.a.shape({getOAuthAppInfo:c.a.func.isRequired,allowOAuth2:c.a.func.isRequired}).isRequired}}}]),g(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this,t=new URLSearchParams(this.props.location.search).get("client_id");/^[a-z0-9]+$/.test(t)&&this.props.actions.getOAuthAppInfo(t).then(function(t){var a=t.data;a&&e.setState({app:a})})}},{key:"componentDidMount",value:function(){var e=document.getElementById("antiClickjack");e&&e.parentNode.removeChild(e)}},{key:"handleAllow",value:function(){var e=this,t=new URLSearchParams(this.props.location.search),a={responseType:t.get("response_type"),clientId:t.get("client_id"),redirectUri:t.get("redirect_uri"),state:t.get("state"),scope:t.get("store")};this.props.actions.allowOAuth2(a).then(function(t){var a=t.data,n=t.error;a&&a.redirect?window.location.href=a.redirect:n&&e.setState({error:n.message})})}},{key:"handleDeny",value:function(){var e=new URLSearchParams(this.props.location.search).get("redirect_uri");e.startsWith("https://")||e.startsWith("http://")?window.location.href=e+"?error=access_denied":h.a.replace("/error")}},{key:"render",value:function(){var e,t,a=this.state.app;return a?(e=a.icon_url?a.icon_url:m.a,this.state.error&&(t=s.a.createElement("div",{className:"prompt__error form-group"},s.a.createElement(d.a,{error:this.state.error}))),s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"prompt"},s.a.createElement("div",{className:"prompt__heading"},s.a.createElement("div",{className:"prompt__app-icon"},s.a.createElement("img",{alt:"prompt icon",src:e,width:"50",height:"50"})),s.a.createElement("div",{className:"text"},s.a.createElement(f.b,{id:"authorize.title",defaultMessage:"**{appName}** would like to connect to your **Mattermost** user account",values:{appName:a.name}}))),s.a.createElement("p",null,s.a.createElement(f.b,{id:"authorize.app",defaultMessage:"The app **{appName}** would like the ability to access and modify your basic information.",values:{appName:a.name}})),s.a.createElement("h2",{className:"prompt__allow"},s.a.createElement(f.b,{id:"authorize.access",defaultMessage:"Allow **{appName}** access?",values:{appName:a.name}})),s.a.createElement("div",{className:"prompt__buttons"},s.a.createElement("button",{type:"submit",className:"btn btn-link authorize-btn",onClick:this.handleDeny},s.a.createElement(u.c,{id:"authorize.deny",defaultMessage:"Deny"})),s.a.createElement("button",{type:"submit",className:"btn btn-primary authorize-btn",onClick:this.handleAllow},s.a.createElement(u.c,{id:"authorize.allow",defaultMessage:"Allow"}))),t))):null}}]),t}();t.default=Object(n.connect)(null,function(e){return{actions:Object(r.bindActionCreators)({getOAuthAppInfo:o.o,allowOAuth2:o.d},e)}})(E)}}]);
//# sourceMappingURL=27.7dd0dab1a3b640e0aa41.js.map